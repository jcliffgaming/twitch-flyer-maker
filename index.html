<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Twitch Flyer Maker</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            grid-column: 1 / -1;
            text-align: center;
            color: #9146ff;
            font-size: 2.5em;
            margin-bottom: 20px;
            font-weight: 800;
        }

        .editor-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .section {
            background: #f7f7f7;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
        }

        .section h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
        }

        .section h2::before {
            content: '‚óè';
            color: #9146ff;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-weight: 600;
            font-size: 0.9em;
        }

        input[type="text"],
        input[type="date"],
        input[type="time"],
        input[type="url"],
        select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
            color: #333;
            background: white;
        }

        .image-url-input {
            font-size: 0.9em;
            padding: 8px;
        }

        input:focus,
        select:focus {
            outline: none;
            border-color: #9146ff;
        }

        .streamer-entry {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
        }

        .streamer-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        button {
            background: #9146ff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
            font-family: 'Poppins', sans-serif;
        }

        button:hover:not(:disabled) {
            background: #7c3aed;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(145, 70, 255, 0.4);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        button.remove-btn {
            background: #ef4444;
        }

        button.remove-btn:hover {
            background: #dc2626;
        }

        .ai-generate-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-size: 1em;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
        }

        .ai-generate-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #5568d3 0%, #65398b 100%);
        }

        .preview-panel {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        #flyer {
            width: 600px;
            height: 800px;
            background: linear-gradient(135deg, #1e1e2e 0%, #2a2a3e 100%);
            border-radius: 16px;
            padding: 0;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            position: relative;
            overflow: hidden;
            transition: background 0.5s ease;
        }

        .flyer-content {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            z-index: 1;
            pointer-events: none;
        }

        .flyer-header {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            z-index: 3;
            pointer-events: none;
            padding: 0;
        }

        /* Background image layer */
        .bg-overlay {
            position: absolute;
            top: 0; left: 0;
            z-index: 1;
            cursor: grab;
            user-select: none;
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            border: 2px solid transparent;
            box-sizing: border-box;
        }
        .bg-overlay:hover { border-color: rgba(255,150,50,0.5); }
        .bg-overlay.selected-bg { border-color: #ff9500 !important; box-shadow: 0 0 15px rgba(255,149,0,0.5); }
        .bg-overlay.dragging-bg { cursor: grabbing; opacity: 0.8; }

        .custom-image-overlay {
            position: absolute;
            z-index: 2;
            cursor: grab;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            border: 2px solid transparent;
            box-sizing: border-box;
            user-select: none;
            -webkit-user-select: none;
        }
        .custom-image-overlay:hover { border-color: rgba(145,70,255,0.5); }
        .custom-image-overlay.selected { border-color: #9146ff; box-shadow: 0 0 15px rgba(145,70,255,0.5); }
        .custom-image-overlay.dragging { cursor: grabbing; opacity: 0.8 !important; }

        /* Text overlay styles */
        .text-overlay {
            position: absolute;
            z-index: 10;
            cursor: grab;
            user-select: none;
            white-space: pre;
            line-height: 1.2;
            padding: 4px 6px;
            border-radius: 4px;
            border: 2px solid transparent;
            transition: border-color 0.15s;
        }
        .text-overlay:hover { border-color: rgba(145,70,255,0.4); }
        .text-overlay.selected-text { border-color: #9146ff; box-shadow: 0 0 12px rgba(145,70,255,0.5); cursor: grab; }
        .text-overlay.dragging-text { cursor: grabbing; opacity: 0.8; }
        .text-overlay .text-delete-btn {
            display: none;
            position: absolute;
            top: -10px; right: -10px;
            width: 20px; height: 20px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            font-size: 12px;
            line-height: 20px;
            text-align: center;
            cursor: pointer;
            z-index: 11;
        }
        .text-overlay.selected-text .text-delete-btn { display: block; }

        /* Alignment guides */
        .align-guide {
            position: absolute;
            pointer-events: none;
            z-index: 9999;
            opacity: 0;
            transition: opacity 0.08s;
        }
        .align-guide.show { opacity: 1; }
        .align-guide.h { /* horizontal line */
            left: 0; right: 0; height: 0;
            border-top: 1.5px dashed rgba(0,220,255,0.85);
            box-shadow: 0 0 4px rgba(0,220,255,0.4);
        }
        .align-guide.v { /* vertical line */
            top: 0; bottom: 0; width: 0;
            border-left: 1.5px dashed rgba(0,220,255,0.85);
            box-shadow: 0 0 4px rgba(0,220,255,0.4);
        }
        .align-guide.center-h { border-color: rgba(255,80,200,0.9); box-shadow: 0 0 5px rgba(255,80,200,0.5); }
        .align-guide.center-v { border-color: rgba(255,80,200,0.9); box-shadow: 0 0 5px rgba(255,80,200,0.5); }
        .align-guide.edge     { border-color: rgba(0,255,150,0.8);  box-shadow: 0 0 4px rgba(0,255,150,0.4); }
        .align-guide-label {
            position: absolute;
            pointer-events: none;
            z-index: 10000;
            font-size: 10px;
            font-family: monospace;
            color: rgba(0,220,255,0.95);
            background: rgba(0,0,0,0.65);
            padding: 1px 4px;
            border-radius: 3px;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.08s;
        }
        .align-guide-label.show { opacity: 1; }

        /* ‚îÄ‚îÄ GRID OVERLAY ‚îÄ‚îÄ */
        .grid-line-h, .grid-line-v { position:absolute; pointer-events:none; }
        .grid-line-h { left:0;right:0;height:0;border-top:1px dashed rgba(255,255,255,0.15); }
        .grid-line-v { top:0;bottom:0;width:0;border-left:1px dashed rgba(255,255,255,0.15); }
        .grid-line-h.major { border-top:1px solid rgba(255,255,255,0.30); }
        .grid-line-v.major { border-left:1px solid rgba(255,255,255,0.30); }
        .grid-ruler-h {
            position:absolute; left:0; right:0; height:20px; top:0;
            background:rgba(0,0,0,0.55); border-bottom:1px solid rgba(255,255,255,0.2);
            pointer-events:none; z-index:10000;
        }
        .grid-ruler-v {
            position:absolute; top:0; bottom:0; width:20px; left:0;
            background:rgba(0,0,0,0.55); border-right:1px solid rgba(255,255,255,0.2);
            pointer-events:none; z-index:10000;
        }
        .grid-ruler-tick {
            position:absolute; pointer-events:none;
            font-size:8px; font-family:'Courier New',monospace; color:rgba(255,255,255,0.7);
            white-space:nowrap;
        }
        .grid-elem-box {
            position:absolute; pointer-events:none; border:2px dashed rgba(0,220,255,0.7);
            border-radius:3px; box-shadow:0 0 0 1px rgba(0,0,0,0.4);
        }
        .grid-elem-label {
            position:absolute; pointer-events:none;
            font-size:9px; font-family:'Courier New',monospace; font-weight:700;
            color:#fff; background:rgba(0,150,200,0.9); padding:1px 5px;
            border-radius:3px; white-space:nowrap; z-index:10001;
        }
        .gap-badge {
            position:absolute; font-size:10px; font-family:'Courier New',monospace;
            font-weight:700; background:rgba(255,80,80,0.92); color:#fff;
            padding:2px 7px; border-radius:10px; pointer-events:none;
            white-space:nowrap; z-index:10001; transform:translate(-50%,-50%);
            border:1px solid rgba(255,150,150,0.6);
        }
        .gap-line { position:absolute; pointer-events:none; z-index:10000; background:rgba(255,80,80,0.6); }
        .gap-tick { position:absolute; pointer-events:none; z-index:10001; background:rgba(255,80,80,0.9); }

        .streamer-card {
            position: absolute;
            background: transparent;
            border: 2px solid transparent;
            border-radius: 8px;
            padding: 8px 12px;
            display: flex;
            align-items: center;
            gap: 10px;
            box-sizing: border-box;
            cursor: grab;
            user-select: none;
            -webkit-user-select: none;
            z-index: 4;
            pointer-events: auto;
        }
        .streamer-card:hover { border-color: rgba(145,70,255,0.4); }
        .streamer-card.selected-card { border-color: #9146ff; box-shadow: 0 0 12px rgba(145,70,255,0.5); }
        .streamer-card.dragging-card { cursor: grabbing; opacity: 0.85; }
        .streamer-card.featured-card {
            border-radius: 12px;
            padding: 12px 16px;
        }

        .streamer-avatar {
            border-radius: 50%;
            border: 3px solid #9146ff;  /* default, overridden by JS */
            object-fit: cover;
            background: #4a4a5e;
            flex-shrink: 0;
        }
        .streamer-info { overflow: hidden; }
        .streamer-name {
            color: white;
            font-weight: bold;
            margin-bottom: 2px;
            white-space: nowrap;
        }
        .streamer-time {
            color: #c4b5fd;
            font-weight: 600;
            white-space: nowrap;
        }

        .flyer-title {
            position: absolute;
            top: 30px;
            left: 30px;
            right: 30px;
            font-size: 3em;
            font-weight: 800;
            color: white;
            text-align: center;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.5);
            line-height: 1.1;
            cursor: grab;
            user-select: none;
            border: 2px solid transparent;
            border-radius: 6px;
            padding: 4px 8px;
            box-sizing: border-box;
            pointer-events: auto;
            z-index: 5;
            transition: border-color 0.15s;
        }
        .flyer-title:hover { border-color: rgba(145,70,255,0.4); }
        .flyer-title.selected-element { border-color: #9146ff !important; box-shadow: 0 0 12px rgba(145,70,255,0.5); }
        .flyer-title.dragging-element { cursor: grabbing; opacity: 0.85; }

        .flyer-datetime {
            position: absolute;
            top: 130px;
            left: 30px;
            right: 30px;
            background: rgba(145, 70, 255, 0.3);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid rgba(145, 70, 255, 0.5);
            cursor: grab;
            user-select: none;
            box-sizing: border-box;
            pointer-events: auto;
            z-index: 5;
        }
        .flyer-datetime:hover { outline: 2px solid rgba(145,70,255,0.4); outline-offset: 2px; }
        .flyer-datetime.selected-element { outline: 2px solid #9146ff !important; outline-offset: 2px; box-shadow: 0 0 12px rgba(145,70,255,0.5); }
        .flyer-datetime.dragging-element { cursor: grabbing; opacity: 0.85; }

        .flyer-date {
            font-size: 1.5em;
            color: white;
            font-weight: bold;
        }

        .download-btn {
            background: #10b981;
            font-size: 1.1em;
            padding: 12px 30px;
        }

        .download-btn:hover {
            background: #059669;
        }

        @media (max-width: 1200px) {
            .container {
                grid-template-columns: 1fr;
            }

            #flyer {
                width: 100% !important;
                max-width: 800px;
            }
        }

        .image-upload-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .image-preview {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid #9146ff;
            object-fit: cover;
            background: #f0f0f0;
            display: none;
        }

        .image-preview.show {
            display: block;
        }

        .loading-spinner {
            display: inline-block;
            width: 14px;
            height: 14px;
            border: 2px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.6s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .status-message {
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 0.9em;
        }

        .status-message.success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #10b981;
        }

        .status-message.error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #ef4444;
        }

        .status-message.info {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #3b82f6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ AI Twitch Flyer Maker</h1>
        
        <div class="editor-panel">
            <div class="section">
                <h2>Event Details</h2>
                <div class="form-group">
                    <label for="title">Title (AI Generated - or edit manually)</label>
                    <input type="text" id="title" placeholder="Click 'Generate AI Design' to create title" value="">
                </div>
                <div class="form-group">
                    <label for="theme">Theme</label>
                    <select id="theme-preset" onchange="applyThemePreset(this.value)" style="margin-bottom: 10px;">
                        <option value="">Choose a preset theme...</option>
                        <optgroup label="üéÆ Gaming & Tech">
                            <option value="cyberpunk">Cyberpunk Neon</option>
                            <option value="vaporwave">Vaporwave Retro</option>
                            <option value="matrix">Matrix Digital</option>
                            <option value="steampunk">Steampunk Brass</option>
                            <option value="glitch">Glitch Art</option>
                            <option value="retroArcade">Retro Arcade</option>
                            <option value="holographic">Holographic</option>
                            <option value="terminal">Terminal Hacker</option>
                            <option value="neonCity">Neon City</option>
                            <option value="cyberpunkRed">Cyberpunk Red</option>
                            <option value="digitalRain">Digital Rain</option>
                            <option value="synthwave">Synthwave</option>
                            <option value="quantumRealm">Quantum Realm</option>
                            <option value="hackerGreen">Hacker Green</option>
                            <option value="futureNoir">Future Noir</option>
                            <option value="circuitBoard">Circuit Board</option>
                            <option value="laserGrid">Laser Grid</option>
                            <option value="pixelPerfect">8-Bit Pixel</option>
                            <option value="techNeon">Tech Neon</option>
                            <option value="dataStream">Data Stream</option>
                        </optgroup>
                        <optgroup label="üè∞ Fantasy & Magic">
                            <option value="fantasy">Medieval Fantasy</option>
                            <option value="dragonLore">Dragon's Lair</option>
                            <option value="crystalCave">Crystal Caverns</option>
                            <option value="elvishWoods">Elvish Forest</option>
                            <option value="ancientRunes">Ancient Runes</option>
                            <option value="wizardTower">Wizard Tower</option>
                            <option value="darkSorcery">Dark Sorcery</option>
                            <option value="celestialMagic">Celestial Magic</option>
                            <option value="enchantedForest">Enchanted Woods</option>
                            <option value="mythicalBeasts">Mythical Beasts</option>
                            <option value="holyKnight">Holy Knight</option>
                            <option value="shadowRealm">Shadow Realm</option>
                            <option value="fairyTale">Fairy Tale</option>
                            <option value="necromancer">Necromancer</option>
                            <option value="arcaneLibrary">Arcane Library</option>
                            <option value="phoenixRising">Phoenix Rising</option>
                            <option value="iceKingdom">Ice Kingdom</option>
                            <option value="mysticPortal">Mystic Portal</option>
                            <option value="dwarvenForge">Dwarven Forge</option>
                            <option value="witchcraft">Witchcraft</option>
                        </optgroup>
                        <optgroup label="üöÄ Space & Sci-Fi">
                            <option value="space">Space Odyssey</option>
                            <option value="nebula">Nebula Zone</option>
                            <option value="galaxy">Galactic Stream</option>
                            <option value="alienWorld">Alien World</option>
                            <option value="starship">Starship Command</option>
                            <option value="blackHole">Black Hole</option>
                            <option value="supernova">Supernova</option>
                            <option value="cosmicDust">Cosmic Dust</option>
                            <option value="wormhole">Wormhole</option>
                            <option value="moonBase">Moon Base</option>
                            <option value="marsColony">Mars Colony</option>
                            <option value="asteroidBelt">Asteroid Belt</option>
                            <option value="quantumField">Quantum Field</option>
                            <option value="solarFlare">Solar Flare</option>
                            <option value="deepSpace">Deep Space</option>
                            <option value="stellarNursery">Stellar Nursery</option>
                            <option value="cosmicRift">Cosmic Rift</option>
                            <option value="interstellar">Interstellar</option>
                            <option value="voidWalker">Void Walker</option>
                            <option value="timeWarp">Time Warp</option>
                        </optgroup>
                        <optgroup label="üåä Nature & Elements">
                            <option value="ocean">Deep Ocean</option>
                            <option value="forest">Mystical Forest</option>
                            <option value="volcano">Volcanic Eruption</option>
                            <option value="thunderstorm">Thunderstorm</option>
                            <option value="aurora">Aurora Borealis</option>
                            <option value="desert">Desert Mirage</option>
                            <option value="tundra">Frozen Tundra</option>
                            <option value="rainforest">Rainforest</option>
                            <option value="cave">Crystal Cave</option>
                            <option value="savanna">Savanna Sunset</option>
                            <option value="waterfall">Waterfall</option>
                            <option value="mountain">Mountain Peak</option>
                            <option value="coral">Coral Reef</option>
                            <option value="jungle">Jungle Trek</option>
                            <option value="glacier">Glacier</option>
                            <option value="earthquake">Earthquake</option>
                            <option value="typhoon">Typhoon</option>
                            <option value="sandstorm">Sandstorm</option>
                            <option value="blossom">Cherry Blossom</option>
                            <option value="meadow">Summer Meadow</option>
                        </optgroup>
                        <optgroup label="üëª Horror & Dark">
                            <option value="halloween">Halloween</option>
                            <option value="vampire">Vampire Night</option>
                            <option value="zombie">Zombie Apocalypse</option>
                            <option value="demon">Demon's Domain</option>
                            <option value="ghost">Ghost Town</option>
                            <option value="werewolf">Werewolf Hunt</option>
                            <option value="crypt">Crypt Keeper</option>
                            <option value="plague">Plague Doctor</option>
                            <option value="asylum">Asylum Escape</option>
                            <option value="occult">Occult Rituals</option>
                            <option value="cursed">Cursed Gaming</option>
                            <option value="haunted">Haunted House</option>
                            <option value="ritual">Dark Ritual</option>
                            <option value="nightmare">Nightmare Realm</option>
                            <option value="bloodMoon">Blood Moon</option>
                            <option value="possessed">Possessed</option>
                            <option value="darkForest">Dark Forest</option>
                            <option value="reaper">Grim Reaper</option>
                            <option value="wicked">Wicked Witchery</option>
                            <option value="sinister">Sinister Shadows</option>
                        </optgroup>
                        <optgroup label="üåà Vibrant & Colorful">
                            <option value="tropicalParty">Tropical Party</option>
                            <option value="candyPop">Candy Pop</option>
                            <option value="festivalNeon">Festival Neon</option>
                            <option value="prismBurst">Prism Burst</option>
                            <option value="sunsetVibes">Sunset Vibes</option>
                            <option value="cottonCandy">Cotton Candy</option>
                            <option value="fireworks">Fireworks</option>
                            <option value="discoFloor">Disco Floor</option>
                            <option value="graffiti">Graffiti Street</option>
                            <option value="rainbowRave">Rainbow Rave</option>
                        </optgroup>
                        <optgroup label="üèÜ Sports & Action">
                            <option value="championship">Championship</option>
                            <option value="raceTrack">Race Track</option>
                            <option value="ironArena">Iron Arena</option>
                            <option value="strikezone">Strike Zone</option>
                            <option value="cyberSports">Cyber Sports</option>
                            <option value="battleRoyale">Battle Royale</option>
                            <option value="speedrunner">Speedrunner</option>
                            <option value="warZone">War Zone</option>
                            <option value="nightRider">Night Rider</option>
                            <option value="epicClash">Epic Clash</option>
                        </optgroup>
                        <optgroup label="‚ú® Elegant & Luxury">
                            <option value="goldGala">Gold Gala</option>
                            <option value="royalPurple">Royal Purple</option>
                            <option value="midnightSilk">Midnight Silk</option>
                            <option value="diamondDust">Diamond Dust</option>
                            <option value="roseGold">Rose Gold</option>
                            <option value="velvetNight">Velvet Night</option>
                            <option value="opulence">Opulence</option>
                            <option value="platinumEdge">Platinum Edge</option>
                            <option value="obsidianGlow">Obsidian Glow</option>
                            <option value="etherealGrace">Ethereal Grace</option>
                        </optgroup>
                        <optgroup label="üéÑ Holidays & Seasons">
                            <option value="christmasClassic">Christmas Classic</option>
                            <option value="christmasNeon">Christmas Neon</option>
                            <option value="winterWonderland">Winter Wonderland</option>
                            <option value="snowStorm">Snow Storm</option>
                            <option value="newYearEve">New Year's Eve</option>
                            <option value="newYearGold">New Year Gold</option>
                            <option value="valentinesDay">Valentine's Day</option>
                            <option value="valentinesDark">Dark Valentine</option>
                            <option value="stPatricks">St. Patrick's Day</option>
                            <option value="easter">Easter Bloom</option>
                            <option value="independenceDay">Independence Day</option>
                            <option value="thanksgiving">Thanksgiving Harvest</option>
                            <option value="hanukkah">Hanukkah</option>
                            <option value="kwanzaa">Kwanzaa</option>
                            <option value="diaDeMuertos">D√≠a de Muertos</option>
                            <option value="lunarNewYear">Lunar New Year</option>
                            <option value="diwali">Diwali Festival</option>
                            <option value="autumnFall">Autumn Fall</option>
                            <option value="summerSolstice">Summer Solstice</option>
                            <option value="springBloom">Spring Bloom</option>
                        </optgroup>
                    </select>
                    <input type="text" id="theme" placeholder="Or enter custom theme for AI (works on localhost only)" value="cyberpunk neon city">
                </div>
                <div class="form-group">
                    <label for="date">Date</label>
                    <input type="date" id="date">
                </div>
                <button class="ai-generate-btn" id="generateBtn" onclick="generateAIBackground()">
                    <span id="generateBtnText">‚ú® Generate AI Design (Localhost Only)</span>
                </button>
                <small style="color: #666; font-size: 0.85em; display: block; margin-top: 8px;">
                    üí° Use preset themes above, or run on localhost for AI generation
                </small>
                <div id="aiStatus"></div>
            </div>

            <div class="section">
                <h2>üî§ Title &amp; Date</h2>

                <!-- Tab switcher -->
                <div style="display:flex;gap:0;margin-bottom:14px;border-radius:8px;overflow:hidden;border:1px solid rgba(145,70,255,0.3);">
                    <button id="tab-title-btn" onclick="switchTitleDateTab('title')"
                        style="flex:1;padding:8px;font-size:13px;font-weight:700;background:#9146ff;color:#fff;border:none;cursor:pointer;">
                        Event Title
                    </button>
                    <button id="tab-date-btn" onclick="switchTitleDateTab('date')"
                        style="flex:1;padding:8px;font-size:13px;font-weight:700;background:rgba(145,70,255,0.15);color:#9146ff;border:none;cursor:pointer;">
                        Date Box
                    </button>
                </div>

                <!-- TITLE PANEL -->
                <div id="tab-title-panel">
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:8px;">
                        <div class="form-group" style="margin:0">
                            <label>Color</label>
                            <input type="color" id="titleColor" value="#ffffff"
                                oninput="applyTitleStyle()"
                                style="width:100%;height:36px;border-radius:6px;border:none;cursor:pointer;">
                        </div>
                        <div class="form-group" style="margin:0">
                            <label>Gradient <input type="checkbox" id="titleGradient" onchange="toggleTitleGradient()" style="width:14px;height:14px;vertical-align:middle;"></label>
                            <input type="color" id="titleColor2" value="#ff00ff" disabled
                                oninput="applyTitleStyle()"
                                style="width:100%;height:36px;border-radius:6px;border:none;cursor:pointer;opacity:0.5;">
                        </div>
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:8px;">
                        <div class="form-group" style="margin:0">
                            <label>Size <span id="titleSizeVal">48px</span></label>
                            <input type="range" id="titleSize" min="12" max="120" value="48" oninput="updateTitleSize(this.value)">
                        </div>
                    </div>

                    <div class="form-group" style="margin-bottom:8px;">
                        <label>Font Family</label>
                        <select id="titleFontSelect" onchange="applyTitleStyle()" style="width:100%;">
                            <option value="">‚Äî Theme Default ‚Äî</option>
                            <optgroup label="Display & Decorative">
                                <option value="Bebas Neue">Bebas Neue</option>
                                <option value="Black Han Sans">Black Han Sans</option>
                                <option value="Bungee">Bungee</option>
                                <option value="Bungee Shade">Bungee Shade</option>
                                <option value="Cinzel">Cinzel</option>
                                <option value="Faster One">Faster One</option>
                                <option value="Fredoka One">Fredoka One</option>
                                <option value="Lilita One">Lilita One</option>
                                <option value="Lobster">Lobster</option>
                                <option value="Monoton">Monoton</option>
                                <option value="Orbitron">Orbitron</option>
                                <option value="Pacifico">Pacifico</option>
                                <option value="Press Start 2P">Press Start 2P</option>
                                <option value="Righteous">Righteous</option>
                                <option value="Russo One">Russo One</option>
                                <option value="Titan One">Titan One</option>
                            </optgroup>
                            <optgroup label="Bold & Strong">
                                <option value="Anton">Anton</option>
                                <option value="Archivo Black">Archivo Black</option>
                                <option value="Barlow Condensed">Barlow Condensed</option>
                                <option value="Black Ops One">Black Ops One</option>
                                <option value="Exo 2">Exo 2</option>
                                <option value="Fjalla One">Fjalla One</option>
                                <option value="Oswald">Oswald</option>
                                <option value="Teko">Teko</option>
                                <option value="Rajdhani">Rajdhani</option>
                            </optgroup>
                            <optgroup label="Elegant & Serif">
                                <option value="Cormorant Garamond">Cormorant Garamond</option>
                                <option value="Playfair Display">Playfair Display</option>
                                <option value="Spectral">Spectral</option>
                                <option value="Lora">Lora</option>
                                <option value="IM Fell English">IM Fell English</option>
                            </optgroup>
                            <optgroup label="Monospace & Tech">
                                <option value="IBM Plex Mono">IBM Plex Mono</option>
                                <option value="Share Tech Mono">Share Tech Mono</option>
                                <option value="VT323">VT323</option>
                                <option value="Courier Prime">Courier Prime</option>
                            </optgroup>
                        </select>
                    </div>

                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:8px;">
                        <div class="form-group" style="margin:0">
                            <label>Weight</label>
                            <select id="titleWeight" onchange="applyTitleStyle()" style="width:100%;">
                                <option value="400">Regular</option>
                                <option value="700" selected>Bold</option>
                                <option value="800">Extra Bold</option>
                                <option value="900">Black</option>
                            </select>
                        </div>
                        <div class="form-group" style="margin:0">
                            <label>Style</label>
                            <select id="titleStyleSel" onchange="applyTitleStyle()" style="width:100%;">
                                <option value="normal">Normal</option>
                                <option value="italic">Italic</option>
                            </select>
                        </div>
                    </div>

                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:8px;">
                        <div class="form-group" style="margin:0">
                            <label>Alignment</label>
                            <select id="titleAlign" onchange="applyTitleStyle()" style="width:100%;">
                                <option value="center" selected>Center</option>
                                <option value="left">Left</option>
                                <option value="right">Right</option>
                            </select>
                        </div>
                        <div class="form-group" style="margin:0">
                            <label>Shadow Color</label>
                            <input type="color" id="titleShadowColor" value="#000000"
                                oninput="applyTitleStyle()"
                                style="width:100%;height:36px;border-radius:6px;border:none;cursor:pointer;">
                        </div>
                    </div>

                    <div class="form-group" style="margin-bottom:8px;">
                        <label>Shadow Blur <span id="titleShadowVal">8px</span></label>
                        <input type="range" id="titleShadow" min="0" max="40" value="8" oninput="document.getElementById('titleShadowVal').textContent=this.value+'px';applyTitleStyle();">
                    </div>

                    <div class="form-group" style="margin-bottom:10px;">
                        <label>Stroke / Outline</label>
                        <div style="display:flex;gap:6px;align-items:center;">
                            <input type="color" id="titleStrokeColor" value="#000000"
                                oninput="applyTitleStyle()"
                                style="width:48px;height:32px;border-radius:6px;border:none;cursor:pointer;flex-shrink:0;">
                            <input type="range" id="titleStrokeWidth" min="0" max="8" value="0"
                                oninput="applyTitleStyle()" style="flex:1;">
                            <span id="titleStrokeVal" style="font-size:12px;min-width:24px;">0px</span>
                        </div>
                    </div>

                    <button onclick="selectElement('title')" style="width:100%;font-size:12px;padding:7px;background:#6366f1;margin-bottom:4px;">üìå Select &amp; Drag on Flyer</button>
                </div>

                <!-- DATE PANEL -->
                <div id="tab-date-panel" style="display:none;">
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:8px;">
                        <div class="form-group" style="margin:0">
                            <label>Text Color</label>
                            <input type="color" id="dateTextColor" value="#ffffff"
                                oninput="applyDateStyle()"
                                style="width:100%;height:36px;border-radius:6px;border:none;cursor:pointer;">
                        </div>
                        <div class="form-group" style="margin:0">
                            <label>Gradient <input type="checkbox" id="dateGradient" onchange="toggleDateGradient()" style="width:14px;height:14px;vertical-align:middle;"></label>
                            <input type="color" id="dateColor2" value="#00ffff" disabled
                                oninput="applyDateStyle()"
                                style="width:100%;height:36px;border-radius:6px;border:none;cursor:pointer;opacity:0.5;">
                        </div>
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:8px;">
                        <div class="form-group" style="margin:0">
                            <label>Size <span id="dateSizeVal">24px</span></label>
                            <input type="range" id="dateSize" min="10" max="80" value="24" oninput="updateDateSize(this.value)">
                        </div>
                    </div>

                    <div class="form-group" style="margin-bottom:8px;">
                        <label>Font Family</label>
                        <select id="dateFontSelect" onchange="applyDateStyle()" style="width:100%;">
                            <option value="">‚Äî Theme Default ‚Äî</option>
                            <optgroup label="Display & Decorative">
                                <option value="Bebas Neue">Bebas Neue</option>
                                <option value="Bungee">Bungee</option>
                                <option value="Cinzel">Cinzel</option>
                                <option value="Orbitron">Orbitron</option>
                                <option value="Press Start 2P">Press Start 2P</option>
                                <option value="Righteous">Righteous</option>
                                <option value="Russo One">Russo One</option>
                            </optgroup>
                            <optgroup label="Bold & Strong">
                                <option value="Anton">Anton</option>
                                <option value="Barlow Condensed">Barlow Condensed</option>
                                <option value="Exo 2">Exo 2</option>
                                <option value="Oswald">Oswald</option>
                                <option value="Rajdhani">Rajdhani</option>
                                <option value="Teko">Teko</option>
                            </optgroup>
                            <optgroup label="Elegant & Serif">
                                <option value="Cormorant Garamond">Cormorant Garamond</option>
                                <option value="Lora">Lora</option>
                                <option value="Playfair Display">Playfair Display</option>
                            </optgroup>
                            <optgroup label="Monospace & Tech">
                                <option value="IBM Plex Mono">IBM Plex Mono</option>
                                <option value="Share Tech Mono">Share Tech Mono</option>
                                <option value="VT323">VT323</option>
                            </optgroup>
                        </select>
                    </div>

                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:8px;">
                        <div class="form-group" style="margin:0">
                            <label>Box BG Color</label>
                            <input type="color" id="dateBgColor" value="#9146ff"
                                oninput="applyDateStyle()"
                                style="width:100%;height:36px;border-radius:6px;border:none;cursor:pointer;">
                        </div>
                        <div class="form-group" style="margin:0">
                            <label>BG Opacity <span id="dateBgOpVal">30%</span></label>
                            <input type="range" id="dateBgOpacity" min="0" max="100" value="30"
                                oninput="document.getElementById('dateBgOpVal').textContent=this.value+'%';applyDateStyle();">
                        </div>
                    </div>

                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:8px;">
                        <div class="form-group" style="margin:0">
                            <label>Border Color</label>
                            <input type="color" id="dateBorderColor" value="#9146ff"
                                oninput="applyDateStyle()"
                                style="width:100%;height:36px;border-radius:6px;border:none;cursor:pointer;">
                        </div>
                        <div class="form-group" style="margin:0">
                            <label>Border Width</label>
                            <select id="dateBorderWidth" onchange="applyDateStyle()" style="width:100%;">
                                <option value="0">None</option>
                                <option value="1">1px</option>
                                <option value="2" selected>2px</option>
                                <option value="3">3px</option>
                                <option value="4">4px</option>
                            </select>
                        </div>
                    </div>

                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:8px;">
                        <div class="form-group" style="margin:0">
                            <label>Corner Radius</label>
                            <select id="dateBorderRadius" onchange="applyDateStyle()" style="width:100%;">
                                <option value="0">Square</option>
                                <option value="6">Small</option>
                                <option value="12" selected>Medium</option>
                                <option value="20">Large</option>
                                <option value="999">Pill</option>
                            </select>
                        </div>
                        <div class="form-group" style="margin:0">
                            <label>Alignment</label>
                            <select id="dateAlign" onchange="applyDateStyle()" style="width:100%;">
                                <option value="center" selected>Center</option>
                                <option value="left">Left</option>
                                <option value="right">Right</option>
                            </select>
                        </div>
                    </div>

                    <button onclick="selectElement('date')" style="width:100%;font-size:12px;padding:7px;background:#6366f1;margin-bottom:4px;">üìå Select &amp; Drag on Flyer</button>
                </div>

                <button onclick="resetTitleDatePositions()" style="width:100%;margin-top:8px;background:#6b7280;font-size:12px;">‚Ü∫ Reset Positions</button>
                <small style="color:#666;font-size:0.8em;display:block;margin-top:6px;">üí° Click title or date directly on the flyer to drag them anywhere.</small>
            </div>

            <div class="section">
                <h2>üåÑ Background Image</h2>
                <div class="form-group">
                    <label for="bgUpload">Upload Background</label>
                    <input type="file" id="bgUpload" accept="image/*" onchange="handleBgUpload(event)" style="margin-bottom:10px;">
                    <small style="color:#666;display:block;margin-top:4px;">üí° Click the background on the flyer to select it, then drag to reposition.</small>
                </div>
                <div id="bgControls" style="display:none;margin-top:12px;padding:14px;background:rgba(255,149,0,0.08);border:1px solid rgba(255,149,0,0.3);border-radius:8px;">
                    <div style="font-weight:700;color:#ff9500;margin-bottom:10px;font-size:13px;">üñº Background Controls</div>
                    <div class="form-group" style="margin-bottom:10px;">
                        <label>Size <span id="bgSizeVal">100%</span></label>
                        <input type="range" id="bgSize" min="50" max="300" value="100" oninput="updateBg()">
                    </div>
                    <div class="form-group" style="margin-bottom:10px;">
                        <label>Opacity <span id="bgOpacityVal">100%</span></label>
                        <input type="range" id="bgOpacity" min="0" max="100" value="100" oninput="updateBg()">
                    </div>
                    <div class="form-group" style="margin-bottom:10px;">
                        <label>Fit</label>
                        <select id="bgFit" onchange="updateBg()" style="width:100%;">
                            <option value="cover">Cover (fill)</option>
                            <option value="contain">Contain (fit)</option>
                            <option value="100% 100%">Stretch</option>
                            <option value="auto">Original size</option>
                        </select>
                    </div>
                    <button onclick="removeBg()" style="background:#ef4444;width:100%;font-size:13px;">Remove Background</button>
                </div>
            </div>

            <div class="section">
                <h2>üñºÔ∏è Custom Images</h2>
                <div class="form-group">
                    <label for="customImage">Upload Image/Logo</label>
                    <input type="file" id="customImage" accept="image/*" onchange="handleImageUpload(event)" style="margin-bottom: 10px;">
                    <small style="color: #666; display: block; margin-top: 5px;">
                        üí° Upload multiple images! Click and drag to move them.
                    </small>
                </div>
                
                <div id="selectedImageControls" style="display: none; margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                    <div style="margin-bottom: 10px; font-weight: bold; color: #9146ff;">Selected Image Controls:</div>
                    <div class="form-group">
                        <label for="imageSize">Size</label>
                        <input type="range" id="imageSize" min="50" max="400" value="200" oninput="updateSelectedImageSize(this.value)">
                        <span id="imageSizeValue">200px</span>
                    </div>
                    <div class="form-group">
                        <label for="imageOpacity">Opacity</label>
                        <input type="range" id="imageOpacity" min="0" max="100" value="50" oninput="updateSelectedImageOpacity(this.value)">
                        <span id="imageOpacityValue">50%</span>
                    </div>
                    <button onclick="deleteSelectedImage()" style="background: #ef4444; width: 100%;">Delete Selected Image</button>
                </div>
                
                <div id="imagesList" style="margin-top: 15px; max-height: 150px; overflow-y: auto;"></div>
                <button onclick="removeAllImages()" style="background: #ef4444; width: 100%; margin-top: 10px;">Remove All Images</button>
            </div>

            <div class="section">
                <h2>‚úèÔ∏è Text Overlays</h2>
                <div class="form-group">
                    <label for="newTextInput">Text to add</label>
                    <input type="text" id="newTextInput" placeholder="e.g. LIVE TONIGHT!" style="width:100%;box-sizing:border-box;" onkeydown="if(event.key==='Enter')addTextOverlay()">
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:8px;">
                    <div class="form-group" style="margin:0">
                        <label>Font Size</label>
                        <input type="range" id="newTextSize" min="10" max="120" value="32" oninput="document.getElementById('newTextSizeVal').textContent=this.value+'px'">
                        <span id="newTextSizeVal">32px</span>
                    </div>
                    <div class="form-group" style="margin:0">
                        <label>Color</label>
                        <input type="color" id="newTextColor" value="#ffffff" style="width:100%;height:36px;border-radius:6px;border:none;cursor:pointer;">
                    </div>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:10px;">
                    <div class="form-group" style="margin:0">
                        <label>Font</label>
                        <select id="newTextFont" style="width:100%">
                            <option value="inherit">Theme Font</option>
                            <option value="Arial, sans-serif">Arial</option>
                            <option value="'Georgia', serif">Georgia</option>
                            <option value="'Impact', sans-serif">Impact</option>
                            <option value="'Courier New', monospace">Courier</option>
                            <option value="'Trebuchet MS', sans-serif">Trebuchet</option>
                            <option value="'Verdana', sans-serif">Verdana</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin:0">
                        <label>Style</label>
                        <select id="newTextStyle" style="width:100%">
                            <option value="normal">Normal</option>
                            <option value="bold">Bold</option>
                            <option value="italic">Italic</option>
                            <option value="bold italic">Bold Italic</option>
                        </select>
                    </div>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;">
                    <button onclick="addTextOverlay()" style="background:#9146ff;">+ Add Text</button>
                    <button onclick="updateSelectedText()" style="background:#6366f1;">‚Ü∫ Update Selected</button>
                </div>

                <div id="textOverlaysList" style="margin-top:12px;display:none;">
                    <div style="font-weight:600;color:#9146ff;margin-bottom:6px;font-size:13px;">Added Text (click to select &amp; edit)</div>
                    <div id="textOverlaysItems"></div>
                    <button onclick="removeAllTextOverlays()" style="background:#ef4444;width:100%;margin-top:8px;font-size:12px;">Remove All Text</button>
                </div>
                <small style="color:#666;font-size:0.82em;display:block;margin-top:8px;">üí° Drag any text directly on the flyer to reposition it. Click text to select &amp; edit.</small>
            </div>

            <div class="section">
                <h2>Streamers Schedule</h2>
                <div id="streamers-list"></div>
                <button onclick="addStreamer()">
                    <span id="add-streamer-text">+ Add Streamer</span>
                    <span id="streamer-count-badge" style="opacity:0.7;font-size:0.85em;"></span>
                </button>
                <button onclick="resetCardPositions()" style="background:#6366f1; margin-top:8px; width:100%;">‚Ü∫ Reset Card Positions</button>
                
                <div style="margin-top:12px;padding:12px;background:rgba(16,185,129,0.08);border:1px solid rgba(16,185,129,0.2);border-radius:8px;">
                    <div style="font-weight:700;color:#10b981;font-size:13px;margin-bottom:8px;">üìã Bulk Import Streamers</div>
                    <textarea id="bulkImportText" placeholder="Paste usernames (one per line)&#10;ninja&#10;pokimane&#10;shroud" 
                        style="width:100%;box-sizing:border-box;min-height:80px;padding:8px;border-radius:6px;border:1px solid rgba(16,185,129,0.3);background:rgba(0,0,0,0.2);color:#fff;font-size:12px;font-family:monospace;resize:vertical;"></textarea>
                    <button onclick="bulkImportStreamers()" style="width:100%;margin-top:8px;background:linear-gradient(135deg,#10b981,#059669);padding:8px;">
                        Import All
                    </button>
                </div>

                <div style="margin-top:12px;padding:12px;background:rgba(99,102,241,0.08);border:1px solid rgba(99,102,241,0.2);border-radius:8px;">
                    <div style="font-weight:700;color:#6366f1;font-size:13px;margin-bottom:8px;">üåç Time Zone Display</div>
                    <select id="timezoneSelect" onchange="updatePreview()" style="width:100%;">
                        <option value="">Local Time (no conversion)</option>
                        <option value="UTC">UTC</option>
                        <option value="America/New_York">Eastern (ET)</option>
                        <option value="America/Chicago">Central (CT)</option>
                        <option value="America/Denver">Mountain (MT)</option>
                        <option value="America/Los_Angeles">Pacific (PT)</option>
                        <option value="Europe/London">London (GMT/BST)</option>
                        <option value="Europe/Paris">Paris (CET/CEST)</option>
                        <option value="Asia/Tokyo">Tokyo (JST)</option>
                        <option value="Australia/Sydney">Sydney (AEST)</option>
                    </select>
                    <small style="color:#888;font-size:0.8em;display:block;margin-top:4px;">Convert all times to a different timezone for display</small>
                </div>
                
                <div style="margin-top:12px;padding:12px;background:rgba(145,70,255,0.08);border:1px solid rgba(145,70,255,0.2);border-radius:8px;">
                    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;">
                        <div style="font-weight:700;color:#9146ff;font-size:13px;">üñº Avatar Borders</div>
                        <label style="display:flex;align-items:center;gap:6px;cursor:pointer;">
                            <input type="checkbox" id="avatarBorderEnabled" checked onchange="updateAvatarBorders()" 
                                style="width:16px;height:16px;cursor:pointer;">
                            <span style="font-size:12px;color:#666;">Enabled</span>
                        </label>
                    </div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;">
                        <div class="form-group" style="margin:0">
                            <label>Border Color</label>
                            <input type="color" id="avatarBorderColor" value="#9146ff" 
                                oninput="updateAvatarBorders()"
                                style="width:100%;height:36px;border-radius:6px;border:none;cursor:pointer;">
                        </div>
                        <div class="form-group" style="margin:0">
                            <label>Border Width</label>
                            <select id="avatarBorderWidth" onchange="updateAvatarBorders()" style="width:100%;">
                                <option value="1">1px</option>
                                <option value="2">2px</option>
                                <option value="3" selected>3px</option>
                                <option value="4">4px</option>
                                <option value="5">5px</option>
                                <option value="6">6px</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <small style="color:#666; font-size:0.82em; display:block; margin-top:6px;">üí° Drag any streamer card directly on the flyer to reposition it.</small>

                <!-- FEATURED STREAMER -->
                <div style="margin-top:14px;padding:14px;background:rgba(255,180,0,0.08);border:2px solid rgba(255,180,0,0.35);border-radius:10px;">
                    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;">
                        <div style="font-weight:700;color:#d97706;font-size:13px;">‚≠ê Featured Streamers</div>
                        <label style="display:flex;align-items:center;gap:5px;cursor:pointer;">
                            <input type="checkbox" id="featuredEnabled" onchange="applyFeaturedStreamer()"
                                style="width:15px;height:15px;cursor:pointer;">
                            <span style="font-size:12px;color:#666;">On</span>
                        </label>
                    </div>

                    <!-- Global defaults (apply to all featured unless overridden) -->
                    <div style="background:rgba(0,0,0,0.12);border-radius:8px;padding:10px;margin-bottom:10px;">
                        <div style="font-size:11px;font-weight:700;color:#d97706;margin-bottom:8px;text-transform:uppercase;letter-spacing:0.5px;">Default Style (all featured)</div>
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-bottom:6px;">
                            <div><label style="font-size:11px;">Name Color</label>
                                <input type="color" id="featuredNameColor" value="#ffd700" oninput="applyFeaturedStreamer()" style="width:100%;height:28px;border-radius:4px;border:none;cursor:pointer;"></div>
                            <div><label style="font-size:11px;">Time Color</label>
                                <input type="color" id="featuredTimeColor" value="#ffffff" oninput="applyFeaturedStreamer()" style="width:100%;height:28px;border-radius:4px;border:none;cursor:pointer;"></div>
                        </div>
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-bottom:6px;">
                            <div><label style="font-size:11px;">Name Scale <span id="featuredNameSizeVal" style="color:#d97706;">1.4√ó</span></label>
                                <input type="range" id="featuredNameScale" min="1.0" max="3.0" step="0.1" value="1.4" oninput="document.getElementById('featuredNameSizeVal').textContent=parseFloat(this.value).toFixed(1)+'√ó';applyFeaturedStreamer();" style="width:100%;"></div>
                            <div><label style="font-size:11px;">Avatar Scale <span id="featuredAvatarSizeVal" style="color:#d97706;">1.4√ó</span></label>
                                <input type="range" id="featuredAvatarScale" min="1.0" max="3.0" step="0.1" value="1.4" oninput="document.getElementById('featuredAvatarSizeVal').textContent=parseFloat(this.value).toFixed(1)+'√ó';applyFeaturedStreamer();" style="width:100%;"></div>
                        </div>
                        <div style="margin-bottom:6px;"><label style="font-size:11px;">Card Background</label>
                            <select id="featuredBgStyle" onchange="applyFeaturedStreamer()" style="width:100%;">
                                <option value="gold-gradient">‚ú® Gold Gradient</option>
                                <option value="purple-glow">üíú Purple Glow</option>
                                <option value="fire">üî• Fire Orange</option>
                                <option value="ice">‚ùÑÔ∏è Ice Blue</option>
                                <option value="neon-green">üíö Neon Green</option>
                                <option value="rose">üå∏ Rose Pink</option>
                                <option value="custom">üé® Custom Color</option>
                                <option value="none">None</option>
                            </select>
                        </div>
                        <div id="featuredCustomBgRow" style="display:none;margin-bottom:6px;">
                            <div style="display:grid;grid-template-columns:1fr 1fr;gap:6px;">
                                <div><label style="font-size:11px;">BG Color</label>
                                    <input type="color" id="featuredBgColor" value="#7c3aed" oninput="applyFeaturedStreamer()" style="width:100%;height:28px;border-radius:4px;border:none;cursor:pointer;"></div>
                                <div><label style="font-size:11px;">Opacity <span id="featuredBgOpVal">70%</span></label>
                                    <input type="range" id="featuredBgOpacity" min="10" max="100" value="70" oninput="document.getElementById('featuredBgOpVal').textContent=this.value+'%';applyFeaturedStreamer();" style="width:100%;"></div>
                            </div>
                        </div>
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:6px;">
                            <div><label style="font-size:11px;">Border Color</label>
                                <input type="color" id="featuredBorderColor" value="#ffd700" oninput="applyFeaturedStreamer()" style="width:100%;height:28px;border-radius:4px;border:none;cursor:pointer;"></div>
                            <div><label style="font-size:11px;">Default Label</label>
                                <input type="text" id="featuredLabel" value="‚≠ê FEATURED" oninput="applyFeaturedStreamer()" style="width:100%;box-sizing:border-box;padding:4px 6px;font-size:12px;"></div>
                        </div>
                    </div>

                    <!-- Per-streamer checklist -->
                    <div style="font-size:11px;font-weight:700;color:#d97706;margin-bottom:6px;text-transform:uppercase;letter-spacing:0.5px;">Select & Customize Each</div>
                    <div id="featuredCheckList" style="overflow-y:auto;background:rgba(0,0,0,0.15);border-radius:6px;padding:4px;border:1px solid rgba(255,180,0,0.2);">
                        <div style="color:#888;font-size:12px;padding:4px;">Add streamers above first</div>
                    </div>
                </div>
                </div>
        </div>

        <div class="preview-panel">
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;">
                <span style="font-size:13px;color:#666;font-weight:600;">Orientation:</span>
                <button id="btn-portrait" onclick="setOrientation('portrait')"
                    style="display:flex;align-items:center;gap:6px;padding:7px 14px;border-radius:8px;border:2px solid #9146ff;background:#9146ff;color:#fff;font-size:13px;font-weight:600;cursor:pointer;">
                    <svg width="12" height="16" viewBox="0 0 12 16"><rect x="1" y="1" width="10" height="14" rx="2" fill="none" stroke="currentColor" stroke-width="1.8"/></svg>
                    Portrait
                </button>
                <button id="btn-landscape" onclick="setOrientation('landscape')"
                    style="display:flex;align-items:center;gap:6px;padding:7px 14px;border-radius:8px;border:2px solid #9146ff;background:transparent;color:#9146ff;font-size:13px;font-weight:600;cursor:pointer;">
                    <svg width="16" height="12" viewBox="0 0 16 12"><rect x="1" y="1" width="14" height="10" rx="2" fill="none" stroke="currentColor" stroke-width="1.8"/></svg>
                    Landscape
                </button>
                <div style="width:1px;height:24px;background:rgba(145,70,255,0.3);margin:0 2px;"></div>
                <button id="btn-grid" onclick="toggleGridOverlay()"
                    style="display:flex;align-items:center;gap:6px;padding:7px 14px;border-radius:8px;border:2px solid rgba(145,70,255,0.4);background:transparent;color:#9146ff;font-size:13px;font-weight:600;cursor:pointer;"
                    title="Show/hide spacing grid">
                    <svg width="14" height="14" viewBox="0 0 14 14"><line x1="0" y1="4.67" x2="14" y2="4.67" stroke="currentColor" stroke-width="1.2"/><line x1="0" y1="9.33" x2="14" y2="9.33" stroke="currentColor" stroke-width="1.2"/><line x1="4.67" y1="0" x2="4.67" y2="14" stroke="currentColor" stroke-width="1.2"/><line x1="9.33" y1="0" x2="9.33" y2="14" stroke="currentColor" stroke-width="1.2"/><rect x="0.6" y="0.6" width="12.8" height="12.8" rx="1" fill="none" stroke="currentColor" stroke-width="1.2"/></svg>
                    Grid
                </button>
                <button id="btn-snap" onclick="toggleSnapToGrid()"
                    style="display:flex;align-items:center;gap:6px;padding:7px 14px;border-radius:8px;border:2px solid rgba(145,70,255,0.4);background:transparent;color:#9146ff;font-size:13px;font-weight:600;cursor:pointer;"
                    title="Snap elements to 10px grid">
                    <svg width="14" height="14" viewBox="0 0 14 14"><rect x="1" y="1" width="3" height="3" fill="currentColor"/><rect x="10" y="1" width="3" height="3" fill="currentColor"/><rect x="1" y="10" width="3" height="3" fill="currentColor"/><rect x="10" y="10" width="3" height="3" fill="currentColor"/><circle cx="7" cy="7" r="1.5" fill="currentColor"/></svg>
                    Snap
                </button>
                <div style="width:1px;height:24px;background:rgba(145,70,255,0.3);margin:0 2px;"></div>
                <button onclick="showAutoLayoutMenu()"
                    style="display:flex;align-items:center;gap:6px;padding:7px 14px;border-radius:8px;border:2px solid #10b981;background:transparent;color:#10b981;font-size:13px;font-weight:600;cursor:pointer;"
                    title="Auto-arrange streamers">
                    <svg width="14" height="14" viewBox="0 0 14 14"><rect x="1" y="1" width="5" height="5" rx="1" fill="none" stroke="currentColor" stroke-width="1.5"/><rect x="8" y="1" width="5" height="5" rx="1" fill="none" stroke="currentColor" stroke-width="1.5"/><rect x="1" y="8" width="5" height="5" rx="1" fill="none" stroke="currentColor" stroke-width="1.5"/><rect x="8" y="8" width="5" height="5" rx="1" fill="none" stroke="currentColor" stroke-width="1.5"/></svg>
                    Auto-Layout
                </button>
            </div>

            <div id="flyer">
                <div id="flyer-decoration" style="position:absolute;top:0;left:0;width:100%;height:100%;z-index:0;pointer-events:none;"></div>
                <div id="flyer-backgrounds" style="position:absolute;top:0;left:0;width:100%;height:100%;z-index:1;pointer-events:none;"></div>
                <div id="flyer-guides" style="position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:9998;"></div>
                <div id="flyer-grid" style="position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:9997;display:none;"></div>
                <div class="flyer-content">
                    <div class="flyer-header">
                        <div class="flyer-title" id="preview-title">Generate Your Event Title</div>
                        <div class="flyer-datetime" id="preview-datetime">
                            <span id="preview-date"></span>
                        </div>
                    </div>
                </div>
            </div>

            <div style="display:flex;flex-direction:column;align-items:center;gap:10px;width:100%;max-width:600px;">
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:8px;width:100%;">
                    <button onclick="saveProject()" style="background:linear-gradient(135deg,#10b981,#059669);font-size:13px;padding:10px;display:flex;align-items:center;justify-content:center;gap:6px;">
                        üíæ Save Project
                    </button>
                    <label style="background:linear-gradient(135deg,#6366f1,#4f46e5);font-size:13px;padding:10px;border-radius:8px;cursor:pointer;color:white;font-weight:700;display:flex;align-items:center;justify-content:center;gap:6px;text-align:center;">
                        üìÇ Load Project
                        <input type="file" id="loadProjectInput" accept=".flyer,.json" style="display:none;" onchange="loadProject(event)">
                    </label>
                </div>
                <small style="color:#666;font-size:0.78em;display:block;margin-bottom:10px;text-align:center;">Save keeps all layers &amp; positions ‚Äî reload to keep editing</small>
                <button class="download-btn" onclick="downloadFlyer()">üì• Download Flyer PNG</button>
                <div style="background:rgba(145,70,255,0.12);border:2px solid rgba(145,70,255,0.3);border-radius:12px;padding:16px;width:100%;box-sizing:border-box;text-align:center;">
                    <div style="font-weight:700;font-size:15px;color:#9146ff;margin-bottom:8px;">üåê Share With Others</div>
                    <p style="font-size:13px;color:#555;margin:0 0 12px 0;">Let anyone use this flyer maker ‚Äî no download needed!</p>
                    <div style="display:flex;flex-direction:column;gap:8px;">
                        <a href="https://app.netlify.com/drop" target="_blank" rel="noopener"
                            style="display:block;padding:10px 16px;background:linear-gradient(135deg,#00ad9f,#00c7b7);color:white;border-radius:8px;text-decoration:none;font-weight:700;font-size:13px;">
                            üöÄ Deploy FREE on Netlify Drop
                        </a>
                        <a href="https://pages.github.com/" target="_blank" rel="noopener"
                            style="display:block;padding:10px 16px;background:linear-gradient(135deg,#24292e,#444d56);color:white;border-radius:8px;text-decoration:none;font-weight:700;font-size:13px;">
                            üêô Host FREE on GitHub Pages
                        </a>
                    </div>
                    <p style="font-size:11px;color:#888;margin:10px 0 0 0;">Download the HTML file ‚Üí drag it onto Netlify Drop ‚Üí share the link instantly.</p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        let streamerCount = 0;
        const streamers = [];
        let currentBackground = null;
        let currentOrientation = 'portrait'; // 'portrait' | 'landscape'

        function setOrientation(mode) {
            currentOrientation = mode;
            const flyer = document.getElementById('flyer');
            const btnP = document.getElementById('btn-portrait');
            const btnL = document.getElementById('btn-landscape');

            if (mode === 'landscape') {
                flyer.style.width  = '800px';
                flyer.style.height = '600px';
                btnL.style.background = '#9146ff';
                btnL.style.color = '#fff';
                btnP.style.background = 'transparent';
                btnP.style.color = '#9146ff';
            } else {
                flyer.style.width  = '600px';
                flyer.style.height = '800px';
                btnP.style.background = '#9146ff';
                btnP.style.color = '#fff';
                btnL.style.background = 'transparent';
                btnL.style.color = '#9146ff';
            }

            // Re-apply current decoration so SVG viewBox matches new size
            const activeBtn = document.querySelector('.theme-btn.active');
            if (activeBtn) applyDecoration(activeBtn.dataset.preset);
            // Re-layout streamers
            updatePreview();
        }

        // Set today's date as default
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('date').value = today;
        updatePreview();

        // Event listeners
        document.getElementById('title').addEventListener('input', updatePreview);
        document.getElementById('theme').addEventListener('input', updatePreview);
        document.getElementById('date').addEventListener('change', updatePreview);

        function applyThemePreset(preset) {
            if (!preset) return;
            
            const themes = {
                // Gaming & Tech (20)
                cyberpunk: { title: "Neon Nights Stream", titleFont: "https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap", titleColor: "#00ffff", dateFont: "https://fonts.googleapis.com/css2?family=Rajdhani:wght@700&display=swap", dateColor: "#ff00ff", dateBackground: "linear-gradient(135deg, rgba(255,0,255,0.3), rgba(0,255,255,0.3))", dateBorder: "2px solid rgba(0,255,255,0.5)", textColor: "#ffffff", flyerBackground: "linear-gradient(135deg, #1a1a2e 0%, #16213e 100%), radial-gradient(circle at 20% 50%, rgba(255,0,255,0.2) 0%, transparent 50%)" },
                vaporwave: { title: "Retro Wave Gaming", titleFont: "https://fonts.googleapis.com/css2?family=Monoton&display=swap", titleColor: "#ff6ec7", dateFont: "https://fonts.googleapis.com/css2?family=Righteous&display=swap", dateColor: "#00d9ff", dateBackground: "linear-gradient(135deg, rgba(255,110,199,0.4), rgba(0,217,255,0.4))", dateBorder: "3px solid #ff6ec7", textColor: "#ffd6f3", flyerBackground: "linear-gradient(180deg, #ff6ec7 0%, #7b2cbf 50%, #00d9ff 100%)" },
                matrix: { title: "Digital Reality", titleFont: "https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap", titleColor: "#00ff00", dateFont: "https://fonts.googleapis.com/css2?family=Courier+Prime:wght@700&display=swap", dateColor: "#00ff00", dateBackground: "rgba(0,0,0,0.8)", dateBorder: "1px solid #00ff00", textColor: "#00ff00", flyerBackground: "linear-gradient(135deg, #000000 0%, #001a00 100%)" },
                steampunk: { title: "Brass & Steam", titleFont: "https://fonts.googleapis.com/css2?family=Rye&display=swap", titleColor: "#cd7f32", dateFont: "https://fonts.googleapis.com/css2?family=Amarante&display=swap", dateColor: "#f4a460", dateBackground: "linear-gradient(135deg, rgba(139,69,19,0.5), rgba(101,67,33,0.5))", dateBorder: "3px double #cd7f32", textColor: "#daa520", flyerBackground: "linear-gradient(135deg, #2c1810 0%, #1a0f0a 100%)" },
                glitch: { title: "System Error", titleFont: "https://fonts.googleapis.com/css2?family=Rubik+Glitch&display=swap", titleColor: "#ff0066", dateFont: "https://fonts.googleapis.com/css2?family=VT323&display=swap", dateColor: "#00ffff", dateBackground: "linear-gradient(90deg, rgba(255,0,102,0.3), rgba(0,255,255,0.3))", dateBorder: "2px solid #ff0066", textColor: "#ffffff", flyerBackground: "linear-gradient(135deg, #0a0a0a 0%, #1a0033 100%)" },
                retroArcade: { title: "Pixel Perfect", titleFont: "https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap", titleColor: "#ffff00", dateFont: "https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap", dateColor: "#ff00ff", dateBackground: "rgba(0,0,0,0.8)", dateBorder: "4px solid #ffff00", textColor: "#00ffff", flyerBackground: "linear-gradient(135deg, #1a0033 0%, #330066 100%)" },
                holographic: { title: "Hologram Live", titleFont: "https://fonts.googleapis.com/css2?family=Audiowide&display=swap", titleColor: "#00ffff", dateFont: "https://fonts.googleapis.com/css2?family=Exo+2:wght@800&display=swap", dateColor: "#ff00ff", dateBackground: "linear-gradient(135deg, rgba(0,255,255,0.2), rgba(255,0,255,0.2))", dateBorder: "2px solid rgba(0,255,255,0.6)", textColor: "#e0ffff", flyerBackground: "linear-gradient(135deg, #0a0a1a 0%, #1a0a2e 100%)" },
                terminal: { title: "Command Line", titleFont: "https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@700&display=swap", titleColor: "#00ff00", dateFont: "https://fonts.googleapis.com/css2?family=Ubuntu+Mono:wght@700&display=swap", dateColor: "#00ff00", dateBackground: "rgba(0,20,0,0.9)", dateBorder: "1px solid #00ff00", textColor: "#33ff33", flyerBackground: "linear-gradient(135deg, #000000 0%, #001a00 100%)" },
                neonCity: { title: "Neon City Nights", titleFont: "https://fonts.googleapis.com/css2?family=Righteous&display=swap", titleColor: "#ff1493", dateFont: "https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap", dateColor: "#00ffff", dateBackground: "linear-gradient(135deg, rgba(255,20,147,0.3), rgba(0,255,255,0.3))", dateBorder: "2px solid #ff1493", textColor: "#ffffff", flyerBackground: "linear-gradient(135deg, #1a0033 0%, #330066 50%, #1a0033 100%)" },
                cyberpunkRed: { title: "Red Night Protocol", titleFont: "https://fonts.googleapis.com/css2?family=Turret+Road:wght@800&display=swap", titleColor: "#ff0000", dateFont: "https://fonts.googleapis.com/css2?family=Saira:wght@700&display=swap", dateColor: "#ffff00", dateBackground: "linear-gradient(135deg, rgba(255,0,0,0.3), rgba(0,0,0,0.8))", dateBorder: "2px solid #ff0000", textColor: "#ffcccc", flyerBackground: "linear-gradient(135deg, #1a0000 0%, #330000 100%)" },
                digitalRain: { title: "Data Stream", titleFont: "https://fonts.googleapis.com/css2?family=Iceland&display=swap", titleColor: "#39ff14", dateFont: "https://fonts.googleapis.com/css2?family=Nova+Mono&display=swap", dateColor: "#39ff14", dateBackground: "rgba(0,0,0,0.9)", dateBorder: "1px solid #39ff14", textColor: "#39ff14", flyerBackground: "linear-gradient(135deg, #000000 0%, #001a00 100%)" },
                synthwave: { title: "Synthwave Nights", titleFont: "https://fonts.googleapis.com/css2?family=Bungee+Shade&display=swap", titleColor: "#ff10f0", dateFont: "https://fonts.googleapis.com/css2?family=Bungee&display=swap", dateColor: "#f0ff10", dateBackground: "linear-gradient(135deg, rgba(240,16,255,0.3), rgba(16,255,240,0.3))", dateBorder: "3px solid #ff10f0", textColor: "#ffffff", flyerBackground: "linear-gradient(180deg, #2d1b69 0%, #ff10f0 50%, #f0ff10 100%)" },
                quantumRealm: { title: "Quantum Zone", titleFont: "https://fonts.googleapis.com/css2?family=Exo:wght@900&display=swap", titleColor: "#9d00ff", dateFont: "https://fonts.googleapis.com/css2?family=Electrolize&display=swap", dateColor: "#00ffff", dateBackground: "linear-gradient(135deg, rgba(157,0,255,0.3), rgba(0,255,255,0.3))", dateBorder: "2px solid #9d00ff", textColor: "#e6ccff", flyerBackground: "linear-gradient(135deg, #0a0015 0%, #1a0033 100%)" },
                hackerGreen: { title: "Hack The Planet", titleFont: "https://fonts.googleapis.com/css2?family=Major+Mono+Display&display=swap", titleColor: "#00ff41", dateFont: "https://fonts.googleapis.com/css2?family=Inconsolata:wght@900&display=swap", dateColor: "#00ff41", dateBackground: "rgba(0,10,0,0.9)", dateBorder: "1px solid #00ff41", textColor: "#00ff41", flyerBackground: "linear-gradient(135deg, #000000 0%, #002200 100%)" },
                futureNoir: { title: "Future Noir", titleFont: "https://fonts.googleapis.com/css2?family=Black+Ops+One&display=swap", titleColor: "#ffffff", dateFont: "https://fonts.googleapis.com/css2?family=Teko:wght@700&display=swap", dateColor: "#ff00ff", dateBackground: "linear-gradient(135deg, rgba(0,0,0,0.8), rgba(255,0,255,0.2))", dateBorder: "2px solid #ffffff", textColor: "#cccccc", flyerBackground: "linear-gradient(135deg, #000000 0%, #1a001a 100%)" },
                circuitBoard: { title: "Circuit Online", titleFont: "https://fonts.googleapis.com/css2?family=Russo+One&display=swap", titleColor: "#00ff00", dateFont: "https://fonts.googleapis.com/css2?family=Saira+Condensed:wght@700&display=swap", dateColor: "#ffff00", dateBackground: "rgba(0,50,0,0.7)", dateBorder: "2px solid #00ff00", textColor: "#ccffcc", flyerBackground: "linear-gradient(135deg, #001a00 0%, #003300 100%)" },
                laserGrid: { title: "Laser Grid", titleFont: "https://fonts.googleapis.com/css2?family=Faster+One&display=swap", titleColor: "#ff0080", dateFont: "https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap", dateColor: "#00ffff", dateBackground: "linear-gradient(135deg, rgba(255,0,128,0.3), rgba(0,255,255,0.3))", dateBorder: "2px solid #ff0080", textColor: "#ffffff", flyerBackground: "linear-gradient(135deg, #000033 0%, #330066 100%)" },
                pixelPerfect: { title: "8-Bit Legends", titleFont: "https://fonts.googleapis.com/css2?family=Pixelify+Sans:wght@700&display=swap", titleColor: "#ff6600", dateFont: "https://fonts.googleapis.com/css2?family=Silkscreen:wght@700&display=swap", dateColor: "#00ff00", dateBackground: "rgba(0,0,0,0.8)", dateBorder: "4px solid #ff6600", textColor: "#ffff00", flyerBackground: "linear-gradient(135deg, #1a1a00 0%, #003300 100%)" },
                techNeon: { title: "Tech Neon", titleFont: "https://fonts.googleapis.com/css2?family=Megrim&display=swap", titleColor: "#00ffff", dateFont: "https://fonts.googleapis.com/css2?family=Quantico:wght@700&display=swap", dateColor: "#ff00ff", dateBackground: "linear-gradient(135deg, rgba(0,255,255,0.2), rgba(255,0,255,0.2))", dateBorder: "2px solid #00ffff", textColor: "#ffffff", flyerBackground: "linear-gradient(135deg, #0a0a1a 0%, #1a0a2e 100%)" },
                dataStream: { title: "Data Stream", titleFont: "https://fonts.googleapis.com/css2?family=Syne+Mono&display=swap", titleColor: "#00ff99", dateFont: "https://fonts.googleapis.com/css2?family=Space+Mono:wght@700&display=swap", dateColor: "#00ff99", dateBackground: "rgba(0,20,10,0.9)", dateBorder: "1px solid #00ff99", textColor: "#00ff99", flyerBackground: "linear-gradient(135deg, #000000 0%, #001a0d 100%)" },
    
                // Fantasy & Magic (20)
                fantasy: { title: "Realm of Legends", titleFont: "https://fonts.googleapis.com/css2?family=Cinzel:wght@900&display=swap", titleColor: "#ffd700", dateFont: "https://fonts.googleapis.com/css2?family=Cinzel:wght@600&display=swap", dateColor: "#fff5e1", dateBackground: "linear-gradient(135deg, rgba(139,69,19,0.4), rgba(101,67,33,0.4))", dateBorder: "2px solid rgba(255,215,0,0.5)", textColor: "#f0e6d2", flyerBackground: "linear-gradient(135deg, #2c1810 0%, #1a0f0a 100%)" },
                dragonLore: { title: "Dragon's Lair", titleFont: "https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap", titleColor: "#ff4500", dateFont: "https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&display=swap", dateColor: "#ffa500", dateBackground: "linear-gradient(135deg, rgba(139,0,0,0.5), rgba(0,0,0,0.7))", dateBorder: "3px solid #ff4500", textColor: "#ffccaa", flyerBackground: "linear-gradient(135deg, #1a0000 0%, #330000 100%)" },
                crystalCave: { title: "Crystal Caverns", titleFont: "https://fonts.googleapis.com/css2?family=Philosopher:wght@700&display=swap", titleColor: "#00ffff", dateFont: "https://fonts.googleapis.com/css2?family=Alike&display=swap", dateColor: "#9370db", dateBackground: "linear-gradient(135deg, rgba(0,255,255,0.2), rgba(147,112,219,0.2))", dateBorder: "2px solid #00ffff", textColor: "#e6f7ff", flyerBackground: "linear-gradient(135deg, #0d0d26 0%, #1a1a3e 100%)" },
                elvishWoods: { title: "Elvish Forest", titleFont: "https://fonts.googleapis.com/css2?family=Babylonica&display=swap", titleColor: "#90ee90", dateFont: "https://fonts.googleapis.com/css2?family=Cormorant:wght@700&display=swap", dateColor: "#f0fff0", dateBackground: "linear-gradient(135deg, rgba(0,100,0,0.4), rgba(34,139,34,0.3))", dateBorder: "2px solid #90ee90", textColor: "#e8f5e9", flyerBackground: "linear-gradient(135deg, #0a2e0a 0%, #051f05 100%)" },
                ancientRunes: { title: "Ancient Runes", titleFont: "https://fonts.googleapis.com/css2?family=Uncial+Antiqua&display=swap", titleColor: "#daa520", dateFont: "https://fonts.googleapis.com/css2?family=IM+Fell+English:wght@400&display=swap", dateColor: "#f4a460", dateBackground: "linear-gradient(135deg, rgba(139,69,19,0.5), rgba(101,67,33,0.5))", dateBorder: "3px double #daa520", textColor: "#f5deb3", flyerBackground: "linear-gradient(135deg, #2b1810 0%, #1a0f0a 100%)" },
                wizardTower: { title: "Wizard's Tower", titleFont: "https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap", titleColor: "#9370db", dateFont: "https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&display=swap", dateColor: "#dda0dd", dateBackground: "linear-gradient(135deg, rgba(75,0,130,0.4), rgba(138,43,226,0.3))", dateBorder: "2px solid #9370db", textColor: "#e6d5f5", flyerBackground: "linear-gradient(135deg, #1a0033 0%, #2d1b4e 100%)" },
                darkSorcery: { title: "Dark Sorcery", titleFont: "https://fonts.googleapis.com/css2?family=Grenze+Gotisch:wght@900&display=swap", titleColor: "#8b008b", dateFont: "https://fonts.googleapis.com/css2?family=Caesar+Dressing&display=swap", dateColor: "#ff00ff", dateBackground: "linear-gradient(135deg, rgba(0,0,0,0.8), rgba(139,0,139,0.3))", dateBorder: "2px solid #8b008b", textColor: "#e6b3e6", flyerBackground: "linear-gradient(135deg, #000000 0%, #1a001a 100%)" },
                celestialMagic: { title: "Celestial Magic", titleFont: "https://fonts.googleapis.com/css2?family=Spectral:wght@800&display=swap", titleColor: "#ffd700", dateFont: "https://fonts.googleapis.com/css2?family=Lora:wght@700&display=swap", dateColor: "#fff8dc", dateBackground: "linear-gradient(135deg, rgba(25,25,112,0.5), rgba(72,61,139,0.4))", dateBorder: "2px solid #ffd700", textColor: "#fffacd", flyerBackground: "linear-gradient(135deg, #191970 0%, #483d8b 100%)" },
                enchantedForest: { title: "Enchanted Woods", titleFont: "https://fonts.googleapis.com/css2?family=Fredericka+the+Great&display=swap", titleColor: "#32cd32", dateFont: "https://fonts.googleapis.com/css2?family=Crimson+Text:wght@700&display=swap", dateColor: "#98fb98", dateBackground: "linear-gradient(135deg, rgba(0,100,0,0.5), rgba(34,139,34,0.4))", dateBorder: "2px solid #32cd32", textColor: "#f0fff0", flyerBackground: "linear-gradient(135deg, #0a2e0a 0%, #06180a 100%)" },
                mythicalBeasts: { title: "Mythical Beasts", titleFont: "https://fonts.googleapis.com/css2?family=Emblema+One&display=swap", titleColor: "#ff6347", dateFont: "https://fonts.googleapis.com/css2?family=Artifika&display=swap", dateColor: "#ffa07a", dateBackground: "linear-gradient(135deg, rgba(139,69,19,0.5), rgba(160,82,45,0.4))", dateBorder: "3px solid #ff6347", textColor: "#ffe4b5", flyerBackground: "linear-gradient(135deg, #2c1810 0%, #1a0f0a 100%)" },
                holyKnight: { title: "Holy Knight", titleFont: "https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@900&display=swap", titleColor: "#ffffff", dateFont: "https://fonts.googleapis.com/css2?family=Cinzel:wght@700&display=swap", dateColor: "#f0e68c", dateBackground: "linear-gradient(135deg, rgba(255,215,0,0.3), rgba(255,255,255,0.2))", dateBorder: "3px solid #ffffff", textColor: "#fffacd", flyerBackground: "linear-gradient(135deg, #2f4f4f 0%, #1c1c1c 100%)" },
                shadowRealm: { title: "Shadow Realm", titleFont: "https://fonts.googleapis.com/css2?family=Creepster&display=swap", titleColor: "#8b0000", dateFont: "https://fonts.googleapis.com/css2?family=Nosifer&display=swap", dateColor: "#9400d3", dateBackground: "linear-gradient(135deg, rgba(0,0,0,0.9), rgba(75,0,130,0.4))", dateBorder: "2px solid #8b0000", textColor: "#dda0dd", flyerBackground: "linear-gradient(135deg, #000000 0%, #1a0033 100%)" },
                fairyTale: { title: "Fairy Tale", titleFont: "https://fonts.googleapis.com/css2?family=Pacifico&display=swap", titleColor: "#ff69b4", dateFont: "https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap", dateColor: "#ffb6c1", dateBackground: "linear-gradient(135deg, rgba(255,105,180,0.3), rgba(255,182,193,0.3))", dateBorder: "2px solid #ff69b4", textColor: "#fff0f5", flyerBackground: "linear-gradient(135deg, #4b0033 0%, #330033 100%)" },
                necromancer: { title: "Necromancer", titleFont: "https://fonts.googleapis.com/css2?family=Grenze+Gotisch:wght@900&display=swap", titleColor: "#00ff00", dateFont: "https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&display=swap", dateColor: "#7fff00", dateBackground: "linear-gradient(135deg, rgba(0,0,0,0.9), rgba(0,100,0,0.3))", dateBorder: "2px solid #00ff00", textColor: "#98fb98", flyerBackground: "linear-gradient(135deg, #000000 0%, #001a00 100%)" },
                arcaneLibrary: { title: "Arcane Library", titleFont: "https://fonts.googleapis.com/css2?family=IM+Fell+English+SC&display=swap", titleColor: "#4169e1", dateFont: "https://fonts.googleapis.com/css2?family=Caudex:wght@700&display=swap", dateColor: "#87ceeb", dateBackground: "linear-gradient(135deg, rgba(25,25,112,0.5), rgba(65,105,225,0.3))", dateBorder: "2px solid #4169e1", textColor: "#e0ffff", flyerBackground: "linear-gradient(135deg, #191970 0%, #000033 100%)" },
                phoenixRising: { title: "Phoenix Rising", titleFont: "https://fonts.googleapis.com/css2?family=Righteous&display=swap", titleColor: "#ff4500", dateFont: "https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap", dateColor: "#ffa500", dateBackground: "linear-gradient(135deg, rgba(255,69,0,0.4), rgba(255,140,0,0.3))", dateBorder: "3px solid #ff4500", textColor: "#ffe4b5", flyerBackground: "linear-gradient(135deg, #1a0000 0%, #330000 100%)" },
                iceKingdom: { title: "Ice Kingdom", titleFont: "https://fonts.googleapis.com/css2?family=Monoton&display=swap", titleColor: "#00ffff", dateFont: "https://fonts.googleapis.com/css2?family=Raleway:wght@800&display=swap", dateColor: "#e0ffff", dateBackground: "linear-gradient(135deg, rgba(0,191,255,0.3), rgba(176,224,230,0.3))", dateBorder: "2px solid #00ffff", textColor: "#f0ffff", flyerBackground: "linear-gradient(135deg, #001a33 0%, #003d5c 100%)" },
                mysticPortal: { title: "Mystic Portal", titleFont: "https://fonts.googleapis.com/css2?family=Nova+Round&display=swap", titleColor: "#9370db", dateFont: "https://fonts.googleapis.com/css2?family=Quicksand:wght@700&display=swap", dateColor: "#dda0dd", dateBackground: "linear-gradient(135deg, rgba(138,43,226,0.4), rgba(147,112,219,0.3))", dateBorder: "2px solid #9370db", textColor: "#e6d5f5", flyerBackground: "linear-gradient(135deg, #1a0033 0%, #2d1b4e 100%)" },
                dwarvenForge: { title: "Dwarven Forge", titleFont: "https://fonts.googleapis.com/css2?family=Rye&display=swap", titleColor: "#ff8c00", dateFont: "https://fonts.googleapis.com/css2?family=Alfa+Slab+One&display=swap", dateColor: "#ffa500", dateBackground: "linear-gradient(135deg, rgba(139,69,19,0.6), rgba(160,82,45,0.5))", dateBorder: "3px solid #ff8c00", textColor: "#ffe4b5", flyerBackground: "linear-gradient(135deg, #2c1810 0%, #1a0000 100%)" },
                witchcraft: { title: "Witchcraft", titleFont: "https://fonts.googleapis.com/css2?family=Nosifer&display=swap", titleColor: "#9400d3", dateFont: "https://fonts.googleapis.com/css2?family=Eater&display=swap", dateColor: "#da70d6", dateBackground: "linear-gradient(135deg, rgba(75,0,130,0.5), rgba(138,43,226,0.4))", dateBorder: "2px solid #9400d3", textColor: "#e6d5f5", flyerBackground: "linear-gradient(135deg, #1a0033 0%, #0d0617 100%)" },
    
                // Space & Sci-Fi (20)
                space: { title: "Cosmic Marathon", titleFont: "https://fonts.googleapis.com/css2?family=Audiowide&display=swap", titleColor: "#ffffff", dateFont: "https://fonts.googleapis.com/css2?family=Exo+2:wght@700&display=swap", dateColor: "#00d4ff", dateBackground: "linear-gradient(135deg, rgba(0,20,40,0.6), rgba(0,40,80,0.6))", dateBorder: "2px solid rgba(0,212,255,0.4)", textColor: "#e0e0e0", flyerBackground: "linear-gradient(135deg, #0a0a1a 0%, #000000 100%)" },
                nebula: { title: "Nebula Zone", titleFont: "https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap", titleColor: "#ff00ff", dateFont: "https://fonts.googleapis.com/css2?family=Michroma&display=swap", dateColor: "#00ffff", dateBackground: "linear-gradient(135deg, rgba(255,0,255,0.3), rgba(0,255,255,0.3))", dateBorder: "2px solid #ff00ff", textColor: "#ffffff", flyerBackground: "linear-gradient(135deg, #1a0033 0%, #330066 100%)" },
                galaxy: { title: "Galactic Stream", titleFont: "https://fonts.googleapis.com/css2?family=Faster+One&display=swap", titleColor: "#9370db", dateFont: "https://fonts.googleapis.com/css2?family=Gruppo&display=swap", dateColor: "#ba55d3", dateBackground: "linear-gradient(135deg, rgba(75,0,130,0.4), rgba(138,43,226,0.3))", dateBorder: "2px solid #9370db", textColor: "#e6d5f5", flyerBackground: "linear-gradient(135deg, #000033 0%, #1a0033 100%)" },
                alienWorld: { title: "Alien World", titleFont: "https://fonts.googleapis.com/css2?family=Bungee+Spice&display=swap", titleColor: "#00ff00", dateFont: "https://fonts.googleapis.com/css2?family=Black+Ops+One&display=swap", dateColor: "#7fff00", dateBackground: "linear-gradient(135deg, rgba(0,100,0,0.5), rgba(0,255,0,0.3))", dateBorder: "2px solid #00ff00", textColor: "#98fb98", flyerBackground: "linear-gradient(135deg, #001a00 0%, #003300 100%)" },
                starship: { title: "Starship Command", titleFont: "https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap", titleColor: "#00bfff", dateFont: "https://fonts.googleapis.com/css2?family=Rajdhani:wght@700&display=swap", dateColor: "#87ceeb", dateBackground: "linear-gradient(135deg, rgba(0,0,139,0.5), rgba(0,191,255,0.3))", dateBorder: "2px solid #00bfff", textColor: "#e0ffff", flyerBackground: "linear-gradient(135deg, #000033 0%, #001a4d 100%)" },
                blackHole: { title: "Black Hole", titleFont: "https://fonts.googleapis.com/css2?family=Gravitas+One&display=swap", titleColor: "#9370db", dateFont: "https://fonts.googleapis.com/css2?family=Nova+Mono&display=swap", dateColor: "#da70d6", dateBackground: "linear-gradient(135deg, rgba(0,0,0,0.9), rgba(75,0,130,0.4))", dateBorder: "2px solid #9370db", textColor: "#e6d5f5", flyerBackground: "radial-gradient(circle at 50% 50%, #000000 30%, #1a0033 60%, #000000 100%)" },
                supernova: { title: "Supernova", titleFont: "https://fonts.googleapis.com/css2?family=Monoton&display=swap", titleColor: "#ff4500", dateFont: "https://fonts.googleapis.com/css2?family=Righteous&display=swap", dateColor: "#ffa500", dateBackground: "linear-gradient(135deg, rgba(255,69,0,0.4), rgba(255,140,0,0.3))", dateBorder: "2px solid #ff4500", textColor: "#ffe4b5", flyerBackground: "linear-gradient(135deg, #1a0000 0%, #330000 100%)" },
                cosmicDust: { title: "Cosmic Dust", titleFont: "https://fonts.googleapis.com/css2?family=Audiowide&display=swap", titleColor: "#dda0dd", dateFont: "https://fonts.googleapis.com/css2?family=Electrolize&display=swap", dateColor: "#ee82ee", dateBackground: "linear-gradient(135deg, rgba(138,43,226,0.3), rgba(221,160,221,0.3))", dateBorder: "2px solid #dda0dd", textColor: "#f5e6f5", flyerBackground: "linear-gradient(135deg, #0d0617 0%, #1a0033 100%)" },
                wormhole: { title: "Wormhole", titleFont: "https://fonts.googleapis.com/css2?family=Bungee+Shade&display=swap", titleColor: "#00ffff", dateFont: "https://fonts.googleapis.com/css2?family=Saira:wght@800&display=swap", dateColor: "#7fffd4", dateBackground: "linear-gradient(135deg, rgba(0,255,255,0.3), rgba(127,255,212,0.3))", dateBorder: "2px solid #00ffff", textColor: "#e0ffff", flyerBackground: "conic-gradient(from 45deg at 50% 50%, #000033, #003d5c, #00ffff, #003d5c, #000000)" },
                moonBase: { title: "Moon Base Alpha", titleFont: "https://fonts.googleapis.com/css2?family=Russo+One&display=swap", titleColor: "#c0c0c0", dateFont: "https://fonts.googleapis.com/css2?family=Teko:wght@700&display=swap", dateColor: "#dcdcdc", dateBackground: "linear-gradient(135deg, rgba(105,105,105,0.4), rgba(169,169,169,0.3))", dateBorder: "2px solid #c0c0c0", textColor: "#f5f5f5", flyerBackground: "linear-gradient(135deg, #1a1a1a 0%, #333333 100%)" },
                marsColony: { title: "Mars Colony", titleFont: "https://fonts.googleapis.com/css2?family=Audiowide&display=swap", titleColor: "#ff6347", dateFont: "https://fonts.googleapis.com/css2?family=Saira+Condensed:wght@700&display=swap", dateColor: "#ff7f50", dateBackground: "linear-gradient(135deg, rgba(139,0,0,0.5), rgba(255,99,71,0.3))", dateBorder: "2px solid #ff6347", textColor: "#ffe4b5", flyerBackground: "linear-gradient(135deg, #2d0a0a 0%, #4d1a1a 100%)" },
                asteroidBelt: { title: "Asteroid Belt", titleFont: "https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap", titleColor: "#808080", dateFont: "https://fonts.googleapis.com/css2?family=Quantico:wght@700&display=swap", dateColor: "#a9a9a9", dateBackground: "linear-gradient(135deg, rgba(47,79,79,0.5), rgba(105,105,105,0.4))", dateBorder: "2px solid #808080", textColor: "#d3d3d3", flyerBackground: "linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%)" },
                quantumField: { title: "Quantum Field", titleFont: "https://fonts.googleapis.com/css2?family=Exo:wght@900&display=swap", titleColor: "#00ffff", dateFont: "https://fonts.googleapis.com/css2?family=Michroma&display=swap", dateColor: "#7fffd4", dateBackground: "linear-gradient(135deg, rgba(0,255,255,0.3), rgba(127,255,212,0.3))", dateBorder: "2px solid #00ffff", textColor: "#e0ffff", flyerBackground: "linear-gradient(135deg, #001a33 0%, #003d5c 100%)" },
                solarFlare: { title: "Solar Flare", titleFont: "https://fonts.googleapis.com/css2?family=Monoton&display=swap", titleColor: "#ffff00", dateFont: "https://fonts.googleapis.com/css2?family=Righteous&display=swap", dateColor: "#ffd700", dateBackground: "linear-gradient(135deg, rgba(255,215,0,0.4), rgba(255,255,0,0.3))", dateBorder: "2px solid #ffff00", textColor: "#fffacd", flyerBackground: "linear-gradient(135deg, #1a1a00 0%, #333300 100%)" },
                deepSpace: { title: "Deep Space", titleFont: "https://fonts.googleapis.com/css2?family=Audiowide&display=swap", titleColor: "#4169e1", dateFont: "https://fonts.googleapis.com/css2?family=Rajdhani:wght@700&display=swap", dateColor: "#6495ed", dateBackground: "linear-gradient(135deg, rgba(0,0,139,0.5), rgba(65,105,225,0.3))", dateBorder: "2px solid #4169e1", textColor: "#b0c4de", flyerBackground: "linear-gradient(135deg, #000000 0%, #000033 100%)" },
                stellarNursery: { title: "Stellar Nursery", titleFont: "https://fonts.googleapis.com/css2?family=Bungee+Spice&display=swap", titleColor: "#ff1493", dateFont: "https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap", dateColor: "#ff69b4", dateBackground: "linear-gradient(135deg, rgba(255,20,147,0.4), rgba(255,105,180,0.3))", dateBorder: "2px solid #ff1493", textColor: "#ffc0cb", flyerBackground: "linear-gradient(135deg, #1a0033 0%, #330066 100%)" },
                cosmicRift: { title: "Cosmic Rift", titleFont: "https://fonts.googleapis.com/css2?family=Faster+One&display=swap", titleColor: "#8b00ff", dateFont: "https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap", dateColor: "#9932cc", dateBackground: "linear-gradient(135deg, rgba(75,0,130,0.5), rgba(139,0,255,0.3))", dateBorder: "2px solid #8b00ff", textColor: "#e6d5f5", flyerBackground: "linear-gradient(135deg, #0d0617 0%, #1a0033 100%)" },
                interstellar: { title: "Interstellar", titleFont: "https://fonts.googleapis.com/css2?family=Gravitas+One&display=swap", titleColor: "#ffffff", dateFont: "https://fonts.googleapis.com/css2?family=Exo+2:wght@800&display=swap", dateColor: "#f0f8ff", dateBackground: "linear-gradient(135deg, rgba(25,25,112,0.5), rgba(0,0,139,0.4))", dateBorder: "2px solid #ffffff", textColor: "#f0f8ff", flyerBackground: "linear-gradient(135deg, #000000 0%, #191970 50%, #000033 100%)" },
                voidWalker: { title: "Void Walker", titleFont: "https://fonts.googleapis.com/css2?family=Creepster&display=swap", titleColor: "#9400d3", dateFont: "https://fonts.googleapis.com/css2?family=Eater&display=swap", dateColor: "#ba55d3", dateBackground: "linear-gradient(135deg, rgba(0,0,0,0.9), rgba(75,0,130,0.4))", dateBorder: "2px solid #9400d3", textColor: "#e6d5f5", flyerBackground: "radial-gradient(circle at 50% 50%, #1a0033 0%, #000000 70%)" },
                timeWarp: { title: "Time Warp", titleFont: "https://fonts.googleapis.com/css2?family=Bungee+Shade&display=swap", titleColor: "#00ced1", dateFont: "https://fonts.googleapis.com/css2?family=Saira:wght@800&display=swap", dateColor: "#48d1cc", dateBackground: "linear-gradient(135deg, rgba(0,206,209,0.3), rgba(72,209,204,0.3))", dateBorder: "2px solid #00ced1", textColor: "#afeeee", flyerBackground: "linear-gradient(135deg, #001a1a 0%, #003333 100%)" },
    
                // Nature & Elements (20)
                ocean: { title: "Deep Sea", titleFont: "https://fonts.googleapis.com/css2?family=Righteous&display=swap", titleColor: "#00ffff", dateFont: "https://fonts.googleapis.com/css2?family=Quicksand:wght@700&display=swap", dateColor: "#b3e5fc", dateBackground: "linear-gradient(135deg, rgba(0,77,115,0.6), rgba(0,48,73,0.6))", dateBorder: "2px solid rgba(0,255,255,0.4)", textColor: "#e1f5fe", flyerBackground: "linear-gradient(180deg, #001f3f 0%, #003d5c 50%, #001f3f 100%)" },
                forest: { title: "Enchanted Woods", titleFont: "https://fonts.googleapis.com/css2?family=Fredericka+the+Great&display=swap", titleColor: "#90ee90", dateFont: "https://fonts.googleapis.com/css2?family=Lora:wght@700&display=swap", dateColor: "#f0fff0", dateBackground: "linear-gradient(135deg, rgba(34,139,34,0.4), rgba(0,100,0,0.4))", dateBorder: "2px solid rgba(144,238,144,0.5)", textColor: "#e8f5e9", flyerBackground: "linear-gradient(135deg, #0a2e0a 0%, #051f05 100%)" },
                volcano: { title: "Volcanic Eruption", titleFont: "https://fonts.googleapis.com/css2?family=Rubik+Mono+One&display=swap", titleColor: "#ff4500", dateFont: "https://fonts.googleapis.com/css2?family=Teko:wght@700&display=swap", dateColor: "#ff6347", dateBackground: "linear-gradient(135deg, rgba(139,0,0,0.6), rgba(255,69,0,0.4))", dateBorder: "2px solid rgba(255,69,0,0.6)", textColor: "#fff5e6", flyerBackground: "linear-gradient(135deg, #1a0000 0%, #330000 100%)" },
                thunderstorm: { title: "Thunderstorm", titleFont: "https://fonts.googleapis.com/css2?family=Faster+One&display=swap", titleColor: "#ffff00", dateFont: "https://fonts.googleapis.com/css2?family=Anton&display=swap", dateColor: "#ffd700", dateBackground: "linear-gradient(135deg, rgba(25,25,112,0.6), rgba(72,61,139,0.5))", dateBorder: "2px solid #ffff00", textColor: "#fffacd", flyerBackground: "linear-gradient(135deg, #191970 0%, #000033 100%)" },
                aurora: { title: "Aurora Borealis", titleFont: "https://fonts.googleapis.com/css2?family=Pacifico&display=swap", titleColor: "#00ff7f", dateFont: "https://fonts.googleapis.com/css2?family=Quicksand:wght@700&display=swap", dateColor: "#7fffd4", dateBackground: "linear-gradient(135deg, rgba(0,255,127,0.3), rgba(127,255,212,0.3))", dateBorder: "2px solid #00ff7f", textColor: "#f0fff0", flyerBackground: "linear-gradient(135deg, #001a33 0%, #003d5c 100%)" },
                desert: { title: "Desert Mirage", titleFont: "https://fonts.googleapis.com/css2?family=Rye&display=swap", titleColor: "#ffa500", dateFont: "https://fonts.googleapis.com/css2?family=Alfa+Slab+One&display=swap", dateColor: "#ffd700", dateBackground: "linear-gradient(135deg, rgba(139,69,19,0.5), rgba(210,180,140,0.4))", dateBorder: "2px solid #ffa500", textColor: "#fff8dc", flyerBackground: "linear-gradient(135deg, #2c1810 0%, #4d2600 100%)" },
                tundra: { title: "Frozen Tundra", titleFont: "https://fonts.googleapis.com/css2?family=Monoton&display=swap", titleColor: "#e0ffff", dateFont: "https://fonts.googleapis.com/css2?family=Raleway:wght@800&display=swap", dateColor: "#f0ffff", dateBackground: "linear-gradient(135deg, rgba(176,224,230,0.4), rgba(240,255,255,0.3))", dateBorder: "2px solid #e0ffff", textColor: "#ffffff", flyerBackground: "linear-gradient(135deg, #002b36 0%, #004d5c 100%)" },
                rainforest: { title: "Rainforest", titleFont: "https://fonts.googleapis.com/css2?family=Fredericka+the+Great&display=swap", titleColor: "#32cd32", dateFont: "https://fonts.googleapis.com/css2?family=Crimson+Text:wght@700&display=swap", dateColor: "#98fb98", dateBackground: "linear-gradient(135deg, rgba(0,100,0,0.6), rgba(34,139,34,0.5))", dateBorder: "2px solid #32cd32", textColor: "#f0fff0", flyerBackground: "linear-gradient(135deg, #0a2e0a 0%, #06180a 100%)" },
                cave: { title: "Crystal Cave", titleFont: "https://fonts.googleapis.com/css2?family=Cinzel:wght@900&display=swap", titleColor: "#4169e1", dateFont: "https://fonts.googleapis.com/css2?family=Philosopher:wght@700&display=swap", dateColor: "#87ceeb", dateBackground: "linear-gradient(135deg, rgba(25,25,112,0.6), rgba(65,105,225,0.4))", dateBorder: "2px solid #4169e1", textColor: "#b0c4de", flyerBackground: "linear-gradient(135deg, #0a0a1a 0%, #191970 100%)" },
                savanna: { title: "Savanna Sunset", titleFont: "https://fonts.googleapis.com/css2?family=Righteous&display=swap", titleColor: "#ff8c00", dateFont: "https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap", dateColor: "#ffa500", dateBackground: "linear-gradient(135deg, rgba(255,140,0,0.4), rgba(255,165,0,0.3))", dateBorder: "2px solid #ff8c00", textColor: "#ffe4b5", flyerBackground: "linear-gradient(135deg, #2c1810 0%, #4d2600 100%)" },
                waterfall: { title: "Waterfall", titleFont: "https://fonts.googleapis.com/css2?family=Righteous&display=swap", titleColor: "#00bfff", dateFont: "https://fonts.googleapis.com/css2?family=Quicksand:wght@700&display=swap", dateColor: "#87ceeb", dateBackground: "linear-gradient(135deg, rgba(0,191,255,0.4), rgba(135,206,235,0.3))", dateBorder: "2px solid #00bfff", textColor: "#e0ffff", flyerBackground: "linear-gradient(180deg, #001a33 0%, #003d5c 50%, #005c7a 80%, #001a33 100%)" },
                mountain: { title: "Mountain Peak", titleFont: "https://fonts.googleapis.com/css2?family=Cinzel:wght@900&display=swap", titleColor: "#ffffff", dateFont: "https://fonts.googleapis.com/css2?family=Raleway:wght@800&display=swap", dateColor: "#f0f8ff", dateBackground: "linear-gradient(135deg, rgba(105,105,105,0.5), rgba(169,169,169,0.4))", dateBorder: "2px solid #ffffff", textColor: "#f5f5f5", flyerBackground: "linear-gradient(180deg, #1a1a2e 0%, #2f4f4f 50%, #4a5a6a 80%, #1a1a2e 100%)" },
                coral: { title: "Coral Reef", titleFont: "https://fonts.googleapis.com/css2?family=Pacifico&display=swap", titleColor: "#ff7f50", dateFont: "https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap", dateColor: "#ffa07a", dateBackground: "linear-gradient(135deg, rgba(255,127,80,0.4), rgba(255,160,122,0.3))", dateBorder: "2px solid #ff7f50", textColor: "#ffe4b5", flyerBackground: "linear-gradient(135deg, #001f3f 0%, #003d5c 100%)" },
                jungle: { title: "Jungle Trek", titleFont: "https://fonts.googleapis.com/css2?family=Fredericka+the+Great&display=swap", titleColor: "#228b22", dateFont: "https://fonts.googleapis.com/css2?family=Lora:wght@700&display=swap", dateColor: "#90ee90", dateBackground: "linear-gradient(135deg, rgba(0,100,0,0.6), rgba(34,139,34,0.5))", dateBorder: "2px solid #228b22", textColor: "#e8f5e9", flyerBackground: "linear-gradient(135deg, #0a2e0a 0%, #051f05 100%)" },
                glacier: { title: "Glacier", titleFont: "https://fonts.googleapis.com/css2?family=Monoton&display=swap", titleColor: "#afeeee", dateFont: "https://fonts.googleapis.com/css2?family=Raleway:wght@800&display=swap", dateColor: "#e0ffff", dateBackground: "linear-gradient(135deg, rgba(175,238,238,0.3), rgba(224,255,255,0.3))", dateBorder: "2px solid #afeeee", textColor: "#f0ffff", flyerBackground: "linear-gradient(135deg, #001a33 0%, #003d5c 100%)" },
                earthquake: { title: "Earthquake", titleFont: "https://fonts.googleapis.com/css2?family=Rubik+Mono+One&display=swap", titleColor: "#8b4513", dateFont: "https://fonts.googleapis.com/css2?family=Teko:wght@700&display=swap", dateColor: "#a0522d", dateBackground: "linear-gradient(135deg, rgba(139,69,19,0.6), rgba(160,82,45,0.5))", dateBorder: "2px solid #8b4513", textColor: "#deb887", flyerBackground: "linear-gradient(135deg, #1a0f0a 0%, #2c1810 100%)" },
                typhoon: { title: "Typhoon", titleFont: "https://fonts.googleapis.com/css2?family=Faster+One&display=swap", titleColor: "#4682b4", dateFont: "https://fonts.googleapis.com/css2?family=Anton&display=swap", dateColor: "#87ceeb", dateBackground: "linear-gradient(135deg, rgba(70,130,180,0.5), rgba(135,206,235,0.4))", dateBorder: "2px solid #4682b4", textColor: "#b0e0e6", flyerBackground: "conic-gradient(from 45deg at 50% 50%, #001a33, #003d5c, #4682b4, #003d5c, #001a33)" },
                sandstorm: { title: "Sandstorm", titleFont: "https://fonts.googleapis.com/css2?family=Rye&display=swap", titleColor: "#daa520", dateFont: "https://fonts.googleapis.com/css2?family=Alfa+Slab+One&display=swap", dateColor: "#f4a460", dateBackground: "linear-gradient(135deg, rgba(218,165,32,0.4), rgba(244,164,96,0.3))", dateBorder: "2px solid #daa520", textColor: "#fff8dc", flyerBackground: "linear-gradient(135deg, #2c1810 0%, #4d2600 100%)" },
                blossom: { title: "Cherry Blossom", titleFont: "https://fonts.googleapis.com/css2?family=Pacifico&display=swap", titleColor: "#ffb6c1", dateFont: "https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap", dateColor: "#ffc0cb", dateBackground: "linear-gradient(135deg, rgba(255,182,193,0.4), rgba(255,192,203,0.3))", dateBorder: "2px solid #ffb6c1", textColor: "#fff0f5", flyerBackground: "linear-gradient(135deg, #2d1b4e 0%, #4b0033 100%)" },
                meadow: { title: "Summer Meadow", titleFont: "https://fonts.googleapis.com/css2?family=Fredericka+the+Great&display=swap", titleColor: "#7cfc00", dateFont: "https://fonts.googleapis.com/css2?family=Quicksand:wght@700&display=swap", dateColor: "#adff2f", dateBackground: "linear-gradient(135deg, rgba(124,252,0,0.3), rgba(173,255,47,0.3))", dateBorder: "2px solid #7cfc00", textColor: "#f0fff0", flyerBackground: "linear-gradient(135deg, #0a2e0a 0%, #1a4d1a 100%)" },
    
                // Horror & Dark (20)
                halloween: { title: "Spooky Spectacular", titleFont: "https://fonts.googleapis.com/css2?family=Creepster&display=swap", titleColor: "#ff6600", dateFont: "https://fonts.googleapis.com/css2?family=Nosifer&display=swap", dateColor: "#9370db", dateBackground: "linear-gradient(135deg, rgba(75,0,130,0.4), rgba(25,0,51,0.4))", dateBorder: "2px solid rgba(255,102,0,0.6)", textColor: "#f0e68c", flyerBackground: "linear-gradient(135deg, #1a0f2e 0%, #0d0617 100%)" },
                vampire: { title: "Vampire's Night", titleFont: "https://fonts.googleapis.com/css2?family=Nosifer&display=swap", titleColor: "#8b0000", dateFont: "https://fonts.googleapis.com/css2?family=Eater&display=swap", dateColor: "#dc143c", dateBackground: "linear-gradient(135deg, rgba(139,0,0,0.6), rgba(0,0,0,0.8))", dateBorder: "2px solid #8b0000", textColor: "#ffcccc", flyerBackground: "linear-gradient(135deg, #1a0000 0%, #330000 100%)" },
                zombie: { title: "Zombie Apocalypse", titleFont: "https://fonts.googleapis.com/css2?family=Creepster&display=swap", titleColor: "#228b22", dateFont: "https://fonts.googleapis.com/css2?family=Eater&display=swap", dateColor: "#7cfc00", dateBackground: "linear-gradient(135deg, rgba(0,100,0,0.5), rgba(0,0,0,0.7))", dateBorder: "2px solid #228b22", textColor: "#90ee90", flyerBackground: "linear-gradient(135deg, #000000 0%, #001a00 100%)" },
                demon: { title: "Demon's Domain", titleFont: "https://fonts.googleapis.com/css2?family=Grenze+Gotisch:wght@900&display=swap", titleColor: "#ff0000", dateFont: "https://fonts.googleapis.com/css2?family=Nosifer&display=swap", dateColor: "#ff4500", dateBackground: "linear-gradient(135deg, rgba(139,0,0,0.7), rgba(0,0,0,0.9))", dateBorder: "2px solid #ff0000", textColor: "#ffcccc", flyerBackground: "linear-gradient(135deg, #1a0000 0%, #000000 100%)" },
                ghost: { title: "Ghost Town", titleFont: "https://fonts.googleapis.com/css2?family=Creepster&display=swap", titleColor: "#f0f0f0", dateFont: "https://fonts.googleapis.com/css2?family=Eater&display=swap", dateColor: "#dcdcdc", dateBackground: "linear-gradient(135deg, rgba(128,128,128,0.3), rgba(0,0,0,0.7))", dateBorder: "2px solid #f0f0f0", textColor: "#ffffff", flyerBackground: "linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%)" },
                werewolf: { title: "Werewolf Hunt", titleFont: "https://fonts.googleapis.com/css2?family=Nosifer&display=swap", titleColor: "#cd853f", dateFont: "https://fonts.googleapis.com/css2?family=Grenze+Gotisch:wght@700&display=swap", dateColor: "#daa520", dateBackground: "linear-gradient(135deg, rgba(139,69,19,0.5), rgba(0,0,0,0.7))", dateBorder: "2px solid #cd853f", textColor: "#f5deb3", flyerBackground: "linear-gradient(135deg, #0a0a0a 0%, #2c1810 100%)" },
                crypt: { title: "Crypt Keeper", titleFont: "https://fonts.googleapis.com/css2?family=Grenze+Gotisch:wght@900&display=swap", titleColor: "#696969", dateFont: "https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&display=swap", dateColor: "#a9a9a9", dateBackground: "linear-gradient(135deg, rgba(47,79,79,0.6), rgba(0,0,0,0.8))", dateBorder: "2px solid #696969", textColor: "#d3d3d3", flyerBackground: "linear-gradient(135deg, #000000 0%, #0a0a0a 100%)" },
                plague: { title: "Plague Doctor", titleFont: "https://fonts.googleapis.com/css2?family=Grenze+Gotisch:wght@900&display=swap", titleColor: "#8b4513", dateFont: "https://fonts.googleapis.com/css2?family=IM+Fell+English&display=swap", dateColor: "#a0522d", dateBackground: "linear-gradient(135deg, rgba(105,105,105,0.5), rgba(0,0,0,0.8))", dateBorder: "2px solid #8b4513", textColor: "#deb887", flyerBackground: "linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%)" },
                asylum: { title: "Asylum Escape", titleFont: "https://fonts.googleapis.com/css2?family=Creepster&display=swap", titleColor: "#b22222", dateFont: "https://fonts.googleapis.com/css2?family=Eater&display=swap", dateColor: "#dc143c", dateBackground: "linear-gradient(135deg, rgba(105,105,105,0.4), rgba(0,0,0,0.8))", dateBorder: "2px solid #b22222", textColor: "#ffc0cb", flyerBackground: "linear-gradient(135deg, #0a0a0a 0%, #1a0000 100%)" },
                occult: { title: "Occult Rituals", titleFont: "https://fonts.googleapis.com/css2?family=Grenze+Gotisch:wght@900&display=swap", titleColor: "#4b0082", dateFont: "https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&display=swap", dateColor: "#8b008b", dateBackground: "linear-gradient(135deg, rgba(75,0,130,0.5), rgba(0,0,0,0.8))", dateBorder: "2px solid #4b0082", textColor: "#e6d5f5", flyerBackground: "linear-gradient(135deg, #0d0617 0%, #000000 100%)" },
                cursed: { title: "Cursed Gaming", titleFont: "https://fonts.googleapis.com/css2?family=Nosifer&display=swap", titleColor: "#8b0000", dateFont: "https://fonts.googleapis.com/css2?family=Creepster&display=swap", dateColor: "#9400d3", dateBackground: "linear-gradient(135deg, rgba(0,0,0,0.9), rgba(139,0,0,0.4))", dateBorder: "2px solid #8b0000", textColor: "#e6b3e6", flyerBackground: "linear-gradient(135deg, #000000 0%, #1a0000 100%)" },
                haunted: { title: "Haunted House", titleFont: "https://fonts.googleapis.com/css2?family=Creepster&display=swap", titleColor: "#daa520", dateFont: "https://fonts.googleapis.com/css2?family=Eater&display=swap", dateColor: "#ffa500", dateBackground: "linear-gradient(135deg, rgba(139,69,19,0.4), rgba(0,0,0,0.8))", dateBorder: "2px solid #daa520", textColor: "#f5deb3", flyerBackground: "linear-gradient(135deg, #0a0a0a 0%, #1a0f0a 100%)" },
                ritual: { title: "Dark Ritual", titleFont: "https://fonts.googleapis.com/css2?family=Grenze+Gotisch:wght@900&display=swap", titleColor: "#8b0000", dateFont: "https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&display=swap", dateColor: "#dc143c", dateBackground: "linear-gradient(135deg, rgba(0,0,0,0.9), rgba(139,0,0,0.4))", dateBorder: "2px solid #8b0000", textColor: "#ffcccc", flyerBackground: "radial-gradient(circle at 50% 50%, #1a0000 0%, #000000 70%)" },
                nightmare: { title: "Nightmare Realm", titleFont: "https://fonts.googleapis.com/css2?family=Creepster&display=swap", titleColor: "#9400d3", dateFont: "https://fonts.googleapis.com/css2?family=Nosifer&display=swap", dateColor: "#ba55d3", dateBackground: "linear-gradient(135deg, rgba(0,0,0,0.9), rgba(75,0,130,0.4))", dateBorder: "2px solid #9400d3", textColor: "#e6d5f5", flyerBackground: "linear-gradient(135deg, #000000 0%, #0d0617 100%)" },
                bloodMoon: { title: "Blood Moon", titleFont: "https://fonts.googleapis.com/css2?family=Nosifer&display=swap", titleColor: "#8b0000", dateFont: "https://fonts.googleapis.com/css2?family=Grenze+Gotisch:wght@700&display=swap", dateColor: "#dc143c", dateBackground: "linear-gradient(135deg, rgba(139,0,0,0.6), rgba(0,0,0,0.8))", dateBorder: "2px solid #8b0000", textColor: "#ffcccc", flyerBackground: "linear-gradient(135deg, #000000 0%, #1a0000 100%)" },
                possessed: { title: "Possessed", titleFont: "https://fonts.googleapis.com/css2?family=Creepster&display=swap", titleColor: "#00ff00", dateFont: "https://fonts.googleapis.com/css2?family=Eater&display=swap", dateColor: "#7fff00", dateBackground: "linear-gradient(135deg, rgba(0,0,0,0.9), rgba(0,100,0,0.3))", dateBorder: "2px solid #00ff00", textColor: "#98fb98", flyerBackground: "linear-gradient(135deg, #000000 0%, #001a00 100%)" },
                darkForest: { title: "Dark Forest", titleFont: "https://fonts.googleapis.com/css2?family=Grenze+Gotisch:wght@900&display=swap", titleColor: "#2e8b57", dateFont: "https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&display=swap", dateColor: "#3cb371", dateBackground: "linear-gradient(135deg, rgba(0,50,0,0.6), rgba(0,0,0,0.8))", dateBorder: "2px solid #2e8b57", textColor: "#90ee90", flyerBackground: "linear-gradient(135deg, #000000 0%, #001a00 100%)" },
                reaper: { title: "Grim Reaper", titleFont: "https://fonts.googleapis.com/css2?family=Nosifer&display=swap", titleColor: "#000000", dateFont: "https://fonts.googleapis.com/css2?family=Creepster&display=swap", dateColor: "#696969", dateBackground: "linear-gradient(135deg, rgba(0,0,0,0.9), rgba(105,105,105,0.3))", dateBorder: "2px solid #000000", textColor: "#d3d3d3", flyerBackground: "linear-gradient(135deg, #000000 0%, #0a0a0a 100%)" },
                wicked: { title: "Wicked Witchery", titleFont: "https://fonts.googleapis.com/css2?family=Creepster&display=swap", titleColor: "#9370db", dateFont: "https://fonts.googleapis.com/css2?family=Eater&display=swap", dateColor: "#ba55d3", dateBackground: "linear-gradient(135deg, rgba(75,0,130,0.5), rgba(0,0,0,0.8))", dateBorder: "2px solid #9370db", textColor: "#e6d5f5", flyerBackground: "linear-gradient(135deg, #0d0617 0%, #1a0033 100%)" },
                sinister: { title: "Sinister Shadows", titleFont: "https://fonts.googleapis.com/css2?family=Nosifer&display=swap", titleColor: "#8b0000", dateFont: "https://fonts.googleapis.com/css2?family=Grenze+Gotisch:wght@700&display=swap", dateColor: "#9400d3", dateBackground: "linear-gradient(135deg, rgba(0,0,0,0.9), rgba(75,0,130,0.4))", dateBorder: "2px solid #8b0000", textColor: "#dda0dd", flyerBackground: "linear-gradient(135deg, #000000 0%, #1a0033 100%)" },

                // Vibrant & Colorful (10)
                tropicalParty: { title: "Tropical Gaming Party", titleFont: "https://fonts.googleapis.com/css2?family=Pacifico&display=swap", titleColor: "#ff6b35", dateFont: "https://fonts.googleapis.com/css2?family=Nunito:wght@800&display=swap", dateColor: "#fff700", dateBackground: "linear-gradient(135deg, rgba(255,107,53,0.5), rgba(255,200,0,0.4))", dateBorder: "3px solid #ff6b35", textColor: "#fff9e6", flyerBackground: "linear-gradient(135deg, #0d3b2e 0%, #1a6b4a 30%, #2d9966 50%, #1a6b4a 70%, #0d3b2e 100%), radial-gradient(circle at 20% 80%, rgba(255,107,53,0.3) 0%, transparent 40%), radial-gradient(circle at 80% 20%, rgba(255,200,0,0.2) 0%, transparent 40%)" },
                candyPop: { title: "Candy Pop Stream", titleFont: "https://fonts.googleapis.com/css2?family=Lilita+One&display=swap", titleColor: "#ff69b4", dateFont: "https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap", dateColor: "#ff1493", dateBackground: "linear-gradient(135deg, rgba(255,105,180,0.4), rgba(255,20,147,0.3))", dateBorder: "3px solid #ff69b4", textColor: "#fff0f5", flyerBackground: "linear-gradient(135deg, #3d0026 0%, #660044 30%, #990066 50%, #660044 70%, #3d0026 100%), radial-gradient(circle at 30% 40%, rgba(255,105,180,0.3) 0%, transparent 40%), radial-gradient(circle at 70% 60%, rgba(255,20,147,0.2) 0%, transparent 35%), repeating-linear-gradient(45deg, transparent, transparent 15px, rgba(255,255,255,0.02) 15px, rgba(255,255,255,0.02) 30px)" },
                festivalNeon: { title: "Festival Stream", titleFont: "https://fonts.googleapis.com/css2?family=Boogaloo&display=swap", titleColor: "#ff00ff", dateFont: "https://fonts.googleapis.com/css2?family=Righteous&display=swap", dateColor: "#00ffff", dateBackground: "linear-gradient(135deg, rgba(255,0,255,0.3), rgba(0,255,255,0.3))", dateBorder: "2px solid #ff00ff", textColor: "#ffffff", flyerBackground: "linear-gradient(135deg, #0a0015 0%, #150030 50%, #0a0015 100%), radial-gradient(circle at 25% 25%, rgba(255,0,255,0.25) 0%, transparent 40%), radial-gradient(circle at 75% 75%, rgba(0,255,255,0.25) 0%, transparent 40%), radial-gradient(circle at 50% 50%, rgba(255,255,0,0.1) 0%, transparent 30%)" },
                prismBurst: { title: "Prism Burst Live", titleFont: "https://fonts.googleapis.com/css2?family=Bangers&display=swap", titleColor: "#ffffff", dateFont: "https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap", dateColor: "#ffffff", dateBackground: "linear-gradient(135deg, rgba(255,0,0,0.3), rgba(0,0,255,0.3))", dateBorder: "2px solid rgba(255,255,255,0.5)", textColor: "#ffffff", flyerBackground: "linear-gradient(135deg, #1a0000 0%, #001a00 25%, #00001a 50%, #1a001a 75%, #1a1a00 100%), radial-gradient(circle at 20% 20%, rgba(255,0,0,0.3) 0%, transparent 35%), radial-gradient(circle at 80% 20%, rgba(255,165,0,0.3) 0%, transparent 35%), radial-gradient(circle at 50% 80%, rgba(0,100,255,0.3) 0%, transparent 35%)" },
                sunsetVibes: { title: "Sunset Stream", titleFont: "https://fonts.googleapis.com/css2?family=Satisfy&display=swap", titleColor: "#ff6600", dateFont: "https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&display=swap", dateColor: "#ffcc00", dateBackground: "linear-gradient(135deg, rgba(255,102,0,0.4), rgba(255,50,0,0.4))", dateBorder: "2px solid #ff6600", textColor: "#fff5e6", flyerBackground: "linear-gradient(180deg, #0d0033 0%, #330033 20%, #660033 40%, #cc3300 60%, #ff6600 80%, #ffcc00 100%)" },
                cottonCandy: { title: "Cotton Candy Stream", titleFont: "https://fonts.googleapis.com/css2?family=Chewy&display=swap", titleColor: "#ff99cc", dateFont: "https://fonts.googleapis.com/css2?family=Nunito:wght@800&display=swap", dateColor: "#99ccff", dateBackground: "linear-gradient(135deg, rgba(255,153,204,0.3), rgba(153,204,255,0.3))", dateBorder: "2px solid #ff99cc", textColor: "#fff0f8", flyerBackground: "linear-gradient(135deg, #1a0033 0%, #330066 30%, #4d0099 50%, #660066 70%, #330033 100%), radial-gradient(ellipse at 30% 30%, rgba(255,153,204,0.2) 0%, transparent 50%), radial-gradient(ellipse at 70% 70%, rgba(153,204,255,0.2) 0%, transparent 50%)" },
                fireworks: { title: "Fireworks Spectacular", titleFont: "https://fonts.googleapis.com/css2?family=Righteous&display=swap", titleColor: "#ffff00", dateFont: "https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap", dateColor: "#ff6600", dateBackground: "linear-gradient(135deg, rgba(255,100,0,0.4), rgba(0,0,50,0.8))", dateBorder: "2px solid #ffff00", textColor: "#fffacd", flyerBackground: "linear-gradient(135deg, #000000 0%, #000033 50%, #000000 100%), radial-gradient(circle at 50% 30%, rgba(255,200,0,0.25) 0%, transparent 30%), radial-gradient(circle at 20% 60%, rgba(255,0,100,0.2) 0%, transparent 25%), radial-gradient(circle at 80% 70%, rgba(0,200,255,0.2) 0%, transparent 25%), radial-gradient(circle at 60% 20%, rgba(255,100,0,0.2) 0%, transparent 20%)" },
                discoFloor: { title: "Disco Stream Night", titleFont: "https://fonts.googleapis.com/css2?family=Bungee&display=swap", titleColor: "#ff00ff", dateFont: "https://fonts.googleapis.com/css2?family=Bungee+Inline&display=swap", dateColor: "#ffff00", dateBackground: "linear-gradient(135deg, rgba(100,0,100,0.6), rgba(0,0,100,0.6))", dateBorder: "3px solid #ff00ff", textColor: "#ffffff", flyerBackground: "linear-gradient(135deg, #0d0026 0%, #260052 50%, #0d0026 100%), repeating-linear-gradient(45deg, transparent, transparent 25px, rgba(255,0,255,0.05) 25px, rgba(255,0,255,0.05) 50px), repeating-linear-gradient(-45deg, transparent, transparent 25px, rgba(0,255,255,0.05) 25px, rgba(0,255,255,0.05) 50px), radial-gradient(circle at 50% 50%, rgba(255,255,0,0.1) 0%, transparent 60%)" },
                graffiti: { title: "Street Art Stream", titleFont: "https://fonts.googleapis.com/css2?family=Permanent+Marker&display=swap", titleColor: "#ff6600", dateFont: "https://fonts.googleapis.com/css2?family=Rock+Salt&display=swap", dateColor: "#00ff00", dateBackground: "linear-gradient(135deg, rgba(0,0,0,0.8), rgba(50,50,50,0.8))", dateBorder: "3px solid #ff6600", textColor: "#ffffff", flyerBackground: "linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #0a0a0a 100%), radial-gradient(circle at 30% 50%, rgba(255,102,0,0.2) 0%, transparent 40%), radial-gradient(circle at 70% 50%, rgba(0,255,0,0.15) 0%, transparent 40%)" },
                rainbowRave: { title: "Rainbow Rave", titleFont: "https://fonts.googleapis.com/css2?family=Boogaloo&display=swap", titleColor: "#ff0000", dateFont: "https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap", dateColor: "#ffffff", dateBackground: "linear-gradient(90deg, rgba(255,0,0,0.3), rgba(255,165,0,0.3), rgba(0,200,0,0.3), rgba(0,0,255,0.3))", dateBorder: "2px solid #ff0000", textColor: "#ffffff", flyerBackground: "linear-gradient(180deg, #330000 0%, #333300 17%, #003300 34%, #003333 51%, #000033 68%, #330033 85%, #330000 100%)" },

                // Sports & Action (10)
                championship: { title: "Championship Stream", titleFont: "https://fonts.googleapis.com/css2?family=Black+Ops+One&display=swap", titleColor: "#ffd700", dateFont: "https://fonts.googleapis.com/css2?family=Teko:wght@700&display=swap", dateColor: "#ffffff", dateBackground: "linear-gradient(135deg, rgba(180,130,0,0.5), rgba(80,60,0,0.5))", dateBorder: "3px solid #ffd700", textColor: "#f5f5f5", flyerBackground: "linear-gradient(135deg, #1a1000 0%, #332000 30%, #4d3000 50%, #332000 70%, #1a1000 100%), radial-gradient(circle at 50% 30%, rgba(255,215,0,0.2) 0%, transparent 50%), repeating-linear-gradient(90deg, transparent, transparent 40px, rgba(255,215,0,0.03) 40px, rgba(255,215,0,0.03) 80px)" },
                raceTrack: { title: "Race Day Stream", titleFont: "https://fonts.googleapis.com/css2?family=Russo+One&display=swap", titleColor: "#ff0000", dateFont: "https://fonts.googleapis.com/css2?family=Saira+Condensed:wght@800&display=swap", dateColor: "#ffffff", dateBackground: "linear-gradient(135deg, rgba(255,0,0,0.4), rgba(0,0,0,0.8))", dateBorder: "3px solid #ff0000", textColor: "#ffffff", flyerBackground: "linear-gradient(135deg, #000000 0%, #1a0000 50%, #000000 100%), repeating-linear-gradient(45deg, transparent, transparent 8px, rgba(255,255,255,0.04) 8px, rgba(255,255,255,0.04) 16px), radial-gradient(circle at 50% 50%, rgba(255,0,0,0.15) 0%, transparent 60%)" },
                ironArena: { title: "Iron Arena", titleFont: "https://fonts.googleapis.com/css2?family=Bungee+Shade&display=swap", titleColor: "#c0c0c0", dateFont: "https://fonts.googleapis.com/css2?family=Teko:wght@700&display=swap", dateColor: "#ff4500", dateBackground: "linear-gradient(135deg, rgba(60,60,60,0.7), rgba(30,30,30,0.9))", dateBorder: "3px solid #c0c0c0", textColor: "#d0d0d0", flyerBackground: "linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #0a0a0a 100%), repeating-linear-gradient(0deg, transparent, transparent 3px, rgba(100,100,100,0.05) 3px, rgba(100,100,100,0.05) 6px), repeating-linear-gradient(90deg, transparent, transparent 3px, rgba(100,100,100,0.05) 3px, rgba(100,100,100,0.05) 6px), radial-gradient(circle at 50% 50%, rgba(255,69,0,0.1) 0%, transparent 60%)" },
                strikezone: { title: "Strike Zone Gaming", titleFont: "https://fonts.googleapis.com/css2?family=Bangers&display=swap", titleColor: "#ff4500", dateFont: "https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap", dateColor: "#ffffff", dateBackground: "linear-gradient(135deg, rgba(255,69,0,0.4), rgba(0,0,0,0.8))", dateBorder: "2px solid #ff4500", textColor: "#f0f0f0", flyerBackground: "linear-gradient(180deg, #000000 0%, #1a0800 40%, #330d00 60%, #1a0800 80%, #000000 100%), radial-gradient(circle at 50% 50%, rgba(255,69,0,0.2) 0%, transparent 55%)" },
                cyberSports: { title: "Cyber Sports League", titleFont: "https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap", titleColor: "#00ff88", dateFont: "https://fonts.googleapis.com/css2?family=Rajdhani:wght@700&display=swap", dateColor: "#00ccff", dateBackground: "linear-gradient(135deg, rgba(0,255,136,0.2), rgba(0,204,255,0.2))", dateBorder: "2px solid #00ff88", textColor: "#ccffee", flyerBackground: "linear-gradient(135deg, #000d1a 0%, #001a33 50%, #000d1a 100%), radial-gradient(circle at 30% 70%, rgba(0,255,136,0.15) 0%, transparent 40%), radial-gradient(circle at 70% 30%, rgba(0,204,255,0.15) 0%, transparent 40%), repeating-linear-gradient(90deg, transparent, transparent 2px, rgba(0,255,136,0.02) 2px, rgba(0,255,136,0.02) 4px)" },
                battleRoyale: { title: "Battle Royale", titleFont: "https://fonts.googleapis.com/css2?family=Rubik+Dirt&display=swap", titleColor: "#ff8c00", dateFont: "https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap", dateColor: "#ffcc00", dateBackground: "linear-gradient(135deg, rgba(100,50,0,0.6), rgba(50,30,0,0.8))", dateBorder: "2px solid #ff8c00", textColor: "#ffe5b4", flyerBackground: "linear-gradient(135deg, #0a0500 0%, #1a0d00 30%, #2d1500 50%, #1a0d00 70%, #0a0500 100%), radial-gradient(circle at 50% 60%, rgba(255,140,0,0.2) 0%, transparent 50%), radial-gradient(circle at 20% 80%, rgba(255,50,0,0.15) 0%, transparent 35%)" },
                speedrunner: { title: "Speedrun Challenge", titleFont: "https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@700&display=swap", titleColor: "#00ff00", dateFont: "https://fonts.googleapis.com/css2?family=Electrolize&display=swap", dateColor: "#00ccff", dateBackground: "linear-gradient(135deg, rgba(0,50,0,0.7), rgba(0,0,50,0.7))", dateBorder: "2px solid #00ff00", textColor: "#ccffcc", flyerBackground: "linear-gradient(135deg, #000800 0%, #001500 50%, #000800 100%), radial-gradient(circle at 50% 50%, rgba(0,255,0,0.1) 0%, transparent 60%), repeating-linear-gradient(0deg, transparent, transparent 20px, rgba(0,255,0,0.03) 20px, rgba(0,255,0,0.03) 40px)" },
                warZone: { title: "War Zone Stream", titleFont: "https://fonts.googleapis.com/css2?family=Special+Elite&display=swap", titleColor: "#8fbc8f", dateFont: "https://fonts.googleapis.com/css2?family=Courier+Prime:wght@700&display=swap", dateColor: "#98fb98", dateBackground: "linear-gradient(135deg, rgba(0,50,0,0.6), rgba(0,30,0,0.8))", dateBorder: "2px solid #556b2f", textColor: "#c8dfc8", flyerBackground: "linear-gradient(135deg, #050a05 0%, #0a1a0a 30%, #0f260f 50%, #0a1a0a 70%, #050a05 100%), radial-gradient(circle at 50% 50%, rgba(0,100,0,0.15) 0%, transparent 60%), repeating-linear-gradient(45deg, transparent, transparent 20px, rgba(0,80,0,0.05) 20px, rgba(0,80,0,0.05) 40px)" },
                nightRider: { title: "Night Rider Stream", titleFont: "https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap", titleColor: "#ff6600", dateFont: "https://fonts.googleapis.com/css2?family=Teko:wght@700&display=swap", dateColor: "#ffffff", dateBackground: "linear-gradient(135deg, rgba(255,102,0,0.3), rgba(0,0,0,0.8))", dateBorder: "2px solid #ff6600", textColor: "#f0f0f0", flyerBackground: "linear-gradient(180deg, #000000 0%, #0a0500 30%, #1a0a00 50%, #0a0500 70%, #000000 100%), radial-gradient(ellipse at 50% 100%, rgba(255,102,0,0.3) 0%, transparent 50%), radial-gradient(circle at 50% 30%, rgba(255,200,0,0.05) 0%, transparent 40%)" },
                epicClash: { title: "Epic Clash Tournament", titleFont: "https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@900&display=swap", titleColor: "#ff4500", dateFont: "https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap", dateColor: "#ffd700", dateBackground: "linear-gradient(135deg, rgba(150,50,0,0.5), rgba(100,30,0,0.5))", dateBorder: "3px solid #ff4500", textColor: "#ffe4c4", flyerBackground: "linear-gradient(135deg, #1a0500 0%, #330a00 30%, #4d1000 50%, #330a00 70%, #1a0500 100%), radial-gradient(circle at 50% 40%, rgba(255,69,0,0.25) 0%, transparent 50%), radial-gradient(circle at 20% 80%, rgba(255,215,0,0.1) 0%, transparent 35%)" },

                // Elegant & Luxury (10)
                goldGala: { title: "Gold Gala Stream", titleFont: "https://fonts.googleapis.com/css2?family=Playfair+Display:wght@900&display=swap", titleColor: "#ffd700", dateFont: "https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@700&display=swap", dateColor: "#ffe680", dateBackground: "linear-gradient(135deg, rgba(100,80,0,0.5), rgba(50,40,0,0.7))", dateBorder: "2px solid #ffd700", textColor: "#fff5cc", flyerBackground: "linear-gradient(135deg, #0d0a00 0%, #1a1500 30%, #2d2200 50%, #1a1500 70%, #0d0a00 100%), radial-gradient(circle at 50% 30%, rgba(255,215,0,0.15) 0%, transparent 50%), repeating-linear-gradient(45deg, transparent, transparent 30px, rgba(255,215,0,0.03) 30px, rgba(255,215,0,0.03) 60px)" },
                royalPurple: { title: "Royal Stream", titleFont: "https://fonts.googleapis.com/css2?family=Cinzel:wght@900&display=swap", titleColor: "#dda0dd", dateFont: "https://fonts.googleapis.com/css2?family=IM+Fell+English:ital@1&display=swap", dateColor: "#e6c9ff", dateBackground: "linear-gradient(135deg, rgba(75,0,130,0.5), rgba(50,0,80,0.7))", dateBorder: "2px solid #9400d3", textColor: "#e8d5f5", flyerBackground: "linear-gradient(135deg, #0d0020 0%, #1a0040 30%, #2d006b 50%, #1a0040 70%, #0d0020 100%), radial-gradient(circle at 50% 40%, rgba(148,0,211,0.2) 0%, transparent 50%), radial-gradient(circle at 20% 80%, rgba(221,160,221,0.1) 0%, transparent 40%)" },
                midnightSilk: { title: "Midnight Silk", titleFont: "https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@700&display=swap", titleColor: "#e8e8e8", dateFont: "https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@300&display=swap", dateColor: "#cccccc", dateBackground: "linear-gradient(135deg, rgba(30,30,30,0.7), rgba(10,10,10,0.9))", dateBorder: "1px solid rgba(255,255,255,0.3)", textColor: "#dddddd", flyerBackground: "linear-gradient(160deg, #000000 0%, #0a0a0f 30%, #050510 50%, #0a0a0f 70%, #000000 100%), radial-gradient(circle at 50% 50%, rgba(200,200,255,0.05) 0%, transparent 60%)" },
                diamondDust: { title: "Diamond Dust Stream", titleFont: "https://fonts.googleapis.com/css2?family=Raleway:wght@900&display=swap", titleColor: "#b9f2ff", dateFont: "https://fonts.googleapis.com/css2?family=Raleway:wght@600&display=swap", dateColor: "#e0faff", dateBackground: "linear-gradient(135deg, rgba(100,200,255,0.2), rgba(200,240,255,0.2))", dateBorder: "1px solid rgba(185,242,255,0.5)", textColor: "#e8f9ff", flyerBackground: "linear-gradient(135deg, #000d1a 0%, #001a2e 30%, #002040 50%, #001a2e 70%, #000d1a 100%), radial-gradient(circle at 50% 40%, rgba(185,242,255,0.12) 0%, transparent 50%), radial-gradient(circle at 30% 70%, rgba(255,255,255,0.05) 0%, transparent 30%), radial-gradient(circle at 70% 20%, rgba(255,255,255,0.05) 0%, transparent 25%)" },
                roseGold: { title: "Rose Gold Stream", titleFont: "https://fonts.googleapis.com/css2?family=Poiret+One&display=swap", titleColor: "#f4c2c2", dateFont: "https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@600&display=swap", dateColor: "#e8a0a0", dateBackground: "linear-gradient(135deg, rgba(180,100,100,0.3), rgba(120,60,60,0.4))", dateBorder: "1px solid #f4c2c2", textColor: "#fce4e4", flyerBackground: "linear-gradient(135deg, #200010 0%, #3d001a 30%, #5c0028 50%, #3d001a 70%, #200010 100%), radial-gradient(circle at 50% 40%, rgba(244,194,194,0.15) 0%, transparent 50%), radial-gradient(circle at 30% 70%, rgba(200,100,100,0.1) 0%, transparent 40%)" },
                velvetNight: { title: "Velvet Night Stream", titleFont: "https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@1,700&display=swap", titleColor: "#cc99ff", dateFont: "https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500&display=swap", dateColor: "#ddbbff", dateBackground: "linear-gradient(135deg, rgba(60,0,80,0.6), rgba(30,0,50,0.8))", dateBorder: "1px solid #cc99ff", textColor: "#e8d5ff", flyerBackground: "linear-gradient(135deg, #050008 0%, #0d0018 30%, #1a002e 50%, #0d0018 70%, #050008 100%), radial-gradient(circle at 50% 50%, rgba(150,0,200,0.12) 0%, transparent 60%), radial-gradient(circle at 20% 30%, rgba(200,150,255,0.08) 0%, transparent 40%)" },
                opulence: { title: "Stream of Opulence", titleFont: "https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@700&display=swap", titleColor: "#d4af37", dateFont: "https://fonts.googleapis.com/css2?family=Libre+Baskerville&display=swap", dateColor: "#f0d060", dateBackground: "linear-gradient(135deg, rgba(80,60,0,0.6), rgba(40,30,0,0.8))", dateBorder: "2px solid #d4af37", textColor: "#f5f0dc", flyerBackground: "linear-gradient(135deg, #080600 0%, #15100a 30%, #201808 50%, #15100a 70%, #080600 100%), radial-gradient(circle at 50% 40%, rgba(212,175,55,0.1) 0%, transparent 55%), repeating-linear-gradient(-45deg, transparent, transparent 40px, rgba(212,175,55,0.02) 40px, rgba(212,175,55,0.02) 80px)" },
                platinumEdge: { title: "Platinum Edge Live", titleFont: "https://fonts.googleapis.com/css2?family=Exo+2:wght@900&display=swap", titleColor: "#e8e8e8", dateFont: "https://fonts.googleapis.com/css2?family=Exo+2:wght@600&display=swap", dateColor: "#cccccc", dateBackground: "linear-gradient(135deg, rgba(80,80,100,0.4), rgba(40,40,60,0.6))", dateBorder: "1px solid #aaaacc", textColor: "#ddddee", flyerBackground: "linear-gradient(160deg, #050508 0%, #0d0d14 30%, #12121e 50%, #0d0d14 70%, #050508 100%), radial-gradient(circle at 30% 30%, rgba(200,200,255,0.07) 0%, transparent 40%), radial-gradient(circle at 70% 70%, rgba(150,150,200,0.07) 0%, transparent 40%), repeating-linear-gradient(90deg, transparent, transparent 60px, rgba(200,200,255,0.02) 60px, rgba(200,200,255,0.02) 120px)" },
                obsidianGlow: { title: "Obsidian Glow", titleFont: "https://fonts.googleapis.com/css2?family=Audiowide&display=swap", titleColor: "#7b68ee", dateFont: "https://fonts.googleapis.com/css2?family=Electrolize&display=swap", dateColor: "#9370db", dateBackground: "linear-gradient(135deg, rgba(40,20,80,0.6), rgba(20,10,40,0.8))", dateBorder: "1px solid #7b68ee", textColor: "#d8d0ff", flyerBackground: "linear-gradient(135deg, #030008 0%, #08000f 30%, #0f0018 50%, #08000f 70%, #030008 100%), radial-gradient(circle at 50% 50%, rgba(123,104,238,0.1) 0%, transparent 55%), radial-gradient(circle at 30% 20%, rgba(80,50,150,0.1) 0%, transparent 40%)" },
                etherealGrace: { title: "Ethereal Grace Stream", titleFont: "https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@1,700&display=swap", titleColor: "#e0c8ff", dateFont: "https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@600&display=swap", dateColor: "#f0e0ff", dateBackground: "linear-gradient(135deg, rgba(100,50,150,0.3), rgba(60,20,100,0.5))", dateBorder: "1px solid rgba(224,200,255,0.4)", textColor: "#eeddf5", flyerBackground: "linear-gradient(135deg, #060010 0%, #0f0020 30%, #180030 50%, #0f0020 70%, #060010 100%), radial-gradient(ellipse at 50% 30%, rgba(200,150,255,0.12) 0%, transparent 55%), radial-gradient(ellipse at 30% 80%, rgba(150,100,200,0.08) 0%, transparent 50%), radial-gradient(circle at 80% 50%, rgba(255,200,255,0.06) 0%, transparent 35%)" },

                // Holidays & Seasons (20)
                christmasClassic: { title: "Christmas Stream Special", titleFont: "https://fonts.googleapis.com/css2?family=Mountains+of+Christmas:wght@700&display=swap", titleColor: "#ff0000", dateFont: "https://fonts.googleapis.com/css2?family=Mountains+of+Christmas&display=swap", dateColor: "#ffd700", dateBackground: "linear-gradient(135deg, rgba(0,80,0,0.6), rgba(0,50,0,0.8))", dateBorder: "3px solid #ff0000", textColor: "#f0fff0", flyerBackground: "linear-gradient(160deg, #001a00 0%, #003300 25%, #004d00 50%, #003300 75%, #001a00 100%), radial-gradient(circle at 50% 20%, rgba(255,215,0,0.15) 0%, transparent 40%), radial-gradient(circle at 20% 80%, rgba(255,0,0,0.15) 0%, transparent 35%), radial-gradient(circle at 80% 60%, rgba(255,0,0,0.1) 0%, transparent 30%), repeating-linear-gradient(45deg, transparent, transparent 20px, rgba(255,255,255,0.02) 20px, rgba(255,255,255,0.02) 40px)" },
                christmasNeon: { title: "Neon Christmas Eve", titleFont: "https://fonts.googleapis.com/css2?family=Mountains+of+Christmas:wght@700&display=swap", titleColor: "#00ff88", dateFont: "https://fonts.googleapis.com/css2?family=Righteous&display=swap", dateColor: "#ff3366", dateBackground: "linear-gradient(135deg, rgba(0,255,136,0.2), rgba(255,51,102,0.2))", dateBorder: "2px solid #00ff88", textColor: "#ccffe8", flyerBackground: "linear-gradient(135deg, #000d00 0%, #001a05 30%, #00260a 50%, #001a05 70%, #000d00 100%), radial-gradient(circle at 30% 40%, rgba(255,51,102,0.2) 0%, transparent 40%), radial-gradient(circle at 70% 60%, rgba(0,255,136,0.2) 0%, transparent 40%), repeating-linear-gradient(0deg, transparent, transparent 3px, rgba(0,255,136,0.02) 3px, rgba(0,255,136,0.02) 6px)" },
                winterWonderland: { title: "Winter Wonderland Stream", titleFont: "https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&display=swap", titleColor: "#e0f4ff", dateFont: "https://fonts.googleapis.com/css2?family=Comfortaa:wght@400&display=swap", dateColor: "#b0d8ff", dateBackground: "linear-gradient(135deg, rgba(100,160,255,0.2), rgba(180,220,255,0.2))", dateBorder: "1px solid rgba(180,220,255,0.5)", textColor: "#e8f4ff", flyerBackground: "linear-gradient(180deg, #020d1a 0%, #051a33 25%, #0a2a4d 50%, #051a33 75%, #020d1a 100%), radial-gradient(circle at 30% 20%, rgba(200,230,255,0.12) 0%, transparent 35%), radial-gradient(circle at 70% 80%, rgba(150,200,255,0.12) 0%, transparent 35%), radial-gradient(circle at 50% 50%, rgba(255,255,255,0.04) 0%, transparent 5%), radial-gradient(circle at 20% 60%, rgba(255,255,255,0.04) 0%, transparent 3%), radial-gradient(circle at 80% 30%, rgba(255,255,255,0.04) 0%, transparent 4%)" },
                snowStorm: { title: "Snow Storm Gaming", titleFont: "https://fonts.googleapis.com/css2?family=Raleway:wght@900&display=swap", titleColor: "#ffffff", dateFont: "https://fonts.googleapis.com/css2?family=Raleway:wght@600&display=swap", dateColor: "#cce8ff", dateBackground: "linear-gradient(135deg, rgba(50,100,150,0.4), rgba(20,60,100,0.6))", dateBorder: "2px solid rgba(255,255,255,0.6)", textColor: "#f0f8ff", flyerBackground: "linear-gradient(180deg, #010810 0%, #03152b 30%, #052040 50%, #03152b 70%, #010810 100%), radial-gradient(circle at 50% 50%, rgba(255,255,255,0.06) 0%, transparent 4%), radial-gradient(circle at 25% 25%, rgba(255,255,255,0.05) 0%, transparent 3%), radial-gradient(circle at 75% 75%, rgba(255,255,255,0.05) 0%, transparent 3%), radial-gradient(circle at 15% 70%, rgba(255,255,255,0.04) 0%, transparent 2%), radial-gradient(circle at 85% 15%, rgba(255,255,255,0.04) 0%, transparent 2%)" },
                newYearEve: { title: "New Year's Eve Stream", titleFont: "https://fonts.googleapis.com/css2?family=Cinzel:wght@900&display=swap", titleColor: "#ffd700", dateFont: "https://fonts.googleapis.com/css2?family=Cinzel:wght@600&display=swap", dateColor: "#ffe680", dateBackground: "linear-gradient(135deg, rgba(100,80,0,0.5), rgba(50,40,0,0.7))", dateBorder: "2px solid #ffd700", textColor: "#fff5cc", flyerBackground: "linear-gradient(135deg, #000000 0%, #0d0a00 30%, #1a1400 50%, #0d0a00 70%, #000000 100%), radial-gradient(circle at 50% 50%, rgba(255,215,0,0.15) 0%, transparent 50%), radial-gradient(circle at 20% 30%, rgba(255,180,0,0.1) 0%, transparent 30%), radial-gradient(circle at 80% 70%, rgba(255,140,0,0.1) 0%, transparent 30%), radial-gradient(circle at 40% 80%, rgba(255,100,0,0.08) 0%, transparent 25%)" },
                newYearGold: { title: "Golden New Year", titleFont: "https://fonts.googleapis.com/css2?family=Playfair+Display:wght@900&display=swap", titleColor: "#ffd700", dateFont: "https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&display=swap", dateColor: "#ffe066", dateBackground: "linear-gradient(135deg, rgba(80,60,0,0.6), rgba(40,30,0,0.8))", dateBorder: "3px solid #ffd700", textColor: "#fffacd", flyerBackground: "linear-gradient(160deg, #050400 0%, #0f0a00 25%, #1a1200 50%, #0f0a00 75%, #050400 100%), radial-gradient(ellipse at 50% 30%, rgba(255,215,0,0.18) 0%, transparent 55%), repeating-linear-gradient(30deg, transparent, transparent 50px, rgba(255,215,0,0.025) 50px, rgba(255,215,0,0.025) 100px), repeating-linear-gradient(-30deg, transparent, transparent 50px, rgba(255,180,0,0.02) 50px, rgba(255,180,0,0.02) 100px)" },
                valentinesDay: { title: "Valentine's Day Stream", titleFont: "https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap", titleColor: "#ff69b4", dateFont: "https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600&display=swap", dateColor: "#ff1493", dateBackground: "linear-gradient(135deg, rgba(255,105,180,0.3), rgba(220,20,60,0.3))", dateBorder: "2px solid #ff69b4", textColor: "#fff0f5", flyerBackground: "linear-gradient(135deg, #200010 0%, #400020 30%, #660033 50%, #400020 70%, #200010 100%), radial-gradient(circle at 50% 40%, rgba(255,105,180,0.2) 0%, transparent 50%), radial-gradient(circle at 30% 70%, rgba(255,20,147,0.15) 0%, transparent 40%), radial-gradient(circle at 70% 20%, rgba(220,20,60,0.1) 0%, transparent 35%)" },
                valentinesDark: { title: "Dark Valentine Stream", titleFont: "https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&display=swap", titleColor: "#dc143c", dateFont: "https://fonts.googleapis.com/css2?family=Cinzel:wght@600&display=swap", dateColor: "#ff4466", dateBackground: "linear-gradient(135deg, rgba(100,0,20,0.6), rgba(50,0,10,0.8))", dateBorder: "2px solid #dc143c", textColor: "#ffcccc", flyerBackground: "linear-gradient(135deg, #0a0005 0%, #150008 30%, #200010 50%, #150008 70%, #0a0005 100%), radial-gradient(circle at 50% 50%, rgba(220,20,60,0.15) 0%, transparent 55%), radial-gradient(circle at 20% 80%, rgba(180,0,30,0.1) 0%, transparent 40%), repeating-linear-gradient(45deg, transparent, transparent 30px, rgba(220,20,60,0.02) 30px, rgba(220,20,60,0.02) 60px)" },
                stPatricks: { title: "St. Patrick's Stream", titleFont: "https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap", titleColor: "#00cc44", dateFont: "https://fonts.googleapis.com/css2?family=Boogaloo&display=swap", dateColor: "#ffdd00", dateBackground: "linear-gradient(135deg, rgba(0,100,30,0.6), rgba(0,60,15,0.8))", dateBorder: "3px solid #00cc44", textColor: "#ccffdd", flyerBackground: "linear-gradient(135deg, #001a08 0%, #003314 30%, #004d1e 50%, #003314 70%, #001a08 100%), radial-gradient(circle at 50% 50%, rgba(0,200,80,0.15) 0%, transparent 55%), radial-gradient(circle at 30% 30%, rgba(0,255,100,0.1) 0%, transparent 35%), radial-gradient(circle at 70% 70%, rgba(255,221,0,0.08) 0%, transparent 30%), repeating-linear-gradient(45deg, transparent, transparent 15px, rgba(0,180,60,0.03) 15px, rgba(0,180,60,0.03) 30px)" },
                easter: { title: "Easter Stream Egg Hunt", titleFont: "https://fonts.googleapis.com/css2?family=Lilita+One&display=swap", titleColor: "#ff99cc", dateFont: "https://fonts.googleapis.com/css2?family=Nunito:wght@800&display=swap", dateColor: "#99eeff", dateBackground: "linear-gradient(135deg, rgba(255,153,204,0.3), rgba(153,238,255,0.3))", dateBorder: "2px solid #ff99cc", textColor: "#fff5ff", flyerBackground: "linear-gradient(135deg, #1a0033 0%, #2d0052 25%, #001a33 50%, #002d00 75%, #1a000d 100%), radial-gradient(circle at 25% 25%, rgba(255,153,204,0.2) 0%, transparent 35%), radial-gradient(circle at 75% 25%, rgba(153,238,255,0.2) 0%, transparent 35%), radial-gradient(circle at 25% 75%, rgba(153,255,153,0.15) 0%, transparent 35%), radial-gradient(circle at 75% 75%, rgba(255,255,153,0.15) 0%, transparent 35%)" },
                independenceDay: { title: "Independence Day Stream", titleFont: "https://fonts.googleapis.com/css2?family=Boogaloo&display=swap", titleColor: "#ffffff", dateFont: "https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap", dateColor: "#ff4444", dateBackground: "linear-gradient(135deg, rgba(0,0,100,0.7), rgba(0,0,60,0.8))", dateBorder: "3px solid #ffffff", textColor: "#f0f0ff", flyerBackground: "linear-gradient(135deg, #000020 0%, #00003d 30%, #000066 50%, #00003d 70%, #000020 100%), radial-gradient(circle at 50% 40%, rgba(255,255,255,0.08) 0%, transparent 50%), radial-gradient(circle at 20% 60%, rgba(255,68,68,0.2) 0%, transparent 35%), radial-gradient(circle at 80% 60%, rgba(255,255,255,0.15) 0%, transparent 30%), radial-gradient(circle at 50% 20%, rgba(255,215,0,0.1) 0%, transparent 25%)" },
                thanksgiving: { title: "Thanksgiving Stream", titleFont: "https://fonts.googleapis.com/css2?family=Rye&display=swap", titleColor: "#d2691e", dateFont: "https://fonts.googleapis.com/css2?family=Lora:wght@700&display=swap", dateColor: "#daa520", dateBackground: "linear-gradient(135deg, rgba(100,50,10,0.6), rgba(60,30,5,0.8))", dateBorder: "2px solid #d2691e", textColor: "#faebd7", flyerBackground: "linear-gradient(160deg, #0d0500 0%, #1a0a00 25%, #2d1200 50%, #1a0a00 75%, #0d0500 100%), radial-gradient(circle at 50% 40%, rgba(210,105,30,0.2) 0%, transparent 50%), radial-gradient(circle at 30% 70%, rgba(218,165,32,0.15) 0%, transparent 40%), radial-gradient(circle at 70% 30%, rgba(139,69,19,0.15) 0%, transparent 35%), repeating-linear-gradient(60deg, transparent, transparent 30px, rgba(210,105,30,0.03) 30px, rgba(210,105,30,0.03) 60px)" },
                hanukkah: { title: "Hanukkah Stream", titleFont: "https://fonts.googleapis.com/css2?family=Cinzel:wght@900&display=swap", titleColor: "#4169e1", dateFont: "https://fonts.googleapis.com/css2?family=Cinzel:wght@600&display=swap", dateColor: "#87ceeb", dateBackground: "linear-gradient(135deg, rgba(30,60,130,0.5), rgba(10,30,80,0.7))", dateBorder: "2px solid #4169e1", textColor: "#e8f0ff", flyerBackground: "linear-gradient(135deg, #000814 0%, #001233 30%, #002060 50%, #001233 70%, #000814 100%), radial-gradient(circle at 50% 40%, rgba(65,105,225,0.2) 0%, transparent 50%), radial-gradient(circle at 30% 70%, rgba(135,206,235,0.12) 0%, transparent 40%), radial-gradient(circle at 70% 30%, rgba(255,255,255,0.06) 0%, transparent 30%), repeating-linear-gradient(45deg, transparent, transparent 25px, rgba(65,105,225,0.03) 25px, rgba(65,105,225,0.03) 50px)" },
                kwanzaa: { title: "Kwanzaa Stream", titleFont: "https://fonts.googleapis.com/css2?family=Playfair+Display:wght@900&display=swap", titleColor: "#cc0000", dateFont: "https://fonts.googleapis.com/css2?family=Lora:wght@700&display=swap", dateColor: "#009900", dateBackground: "linear-gradient(135deg, rgba(100,0,0,0.5), rgba(0,70,0,0.5))", dateBorder: "3px solid #cc0000", textColor: "#fff8e7", flyerBackground: "linear-gradient(135deg, #0a0000 0%, #1a0000 25%, #0a0a00 50%, #000a00 75%, #00000a 100%), radial-gradient(circle at 30% 50%, rgba(204,0,0,0.2) 0%, transparent 40%), radial-gradient(circle at 70% 50%, rgba(0,153,0,0.2) 0%, transparent 40%), radial-gradient(circle at 50% 80%, rgba(200,150,0,0.15) 0%, transparent 35%)" },
                diaDeMuertos: { title: "D√≠a de Muertos Stream", titleFont: "https://fonts.googleapis.com/css2?family=Lobster&display=swap", titleColor: "#ff6600", dateFont: "https://fonts.googleapis.com/css2?family=Pacifico&display=swap", dateColor: "#ff00ff", dateBackground: "linear-gradient(135deg, rgba(100,0,100,0.5), rgba(150,50,0,0.5))", dateBorder: "2px solid #ff6600", textColor: "#fff0e6", flyerBackground: "linear-gradient(135deg, #0d000d 0%, #1a001a 25%, #26001a 50%, #1a000d 75%, #0d0000 100%), radial-gradient(circle at 50% 40%, rgba(255,102,0,0.2) 0%, transparent 45%), radial-gradient(circle at 25% 65%, rgba(255,0,255,0.15) 0%, transparent 35%), radial-gradient(circle at 75% 65%, rgba(255,215,0,0.12) 0%, transparent 35%), repeating-linear-gradient(45deg, transparent, transparent 20px, rgba(255,102,0,0.03) 20px, rgba(255,102,0,0.03) 40px)" },
                lunarNewYear: { title: "Lunar New Year Stream", titleFont: "https://fonts.googleapis.com/css2?family=Noto+Serif:wght@700&display=swap", titleColor: "#ff2200", dateFont: "https://fonts.googleapis.com/css2?family=Noto+Serif:wght@400&display=swap", dateColor: "#ffd700", dateBackground: "linear-gradient(135deg, rgba(150,0,0,0.6), rgba(80,0,0,0.8))", dateBorder: "3px solid #ff2200", textColor: "#fff5cc", flyerBackground: "linear-gradient(135deg, #1a0000 0%, #330000 25%, #4d0000 50%, #330000 75%, #1a0000 100%), radial-gradient(circle at 50% 40%, rgba(255,34,0,0.2) 0%, transparent 50%), radial-gradient(circle at 25% 75%, rgba(255,215,0,0.15) 0%, transparent 40%), radial-gradient(circle at 75% 25%, rgba(255,140,0,0.12) 0%, transparent 35%), repeating-linear-gradient(90deg, transparent, transparent 40px, rgba(255,215,0,0.03) 40px, rgba(255,215,0,0.03) 80px)" },
                diwali: { title: "Diwali Stream Festival", titleFont: "https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&display=swap", titleColor: "#ffaa00", dateFont: "https://fonts.googleapis.com/css2?family=Cinzel:wght@600&display=swap", dateColor: "#ff6600", dateBackground: "linear-gradient(135deg, rgba(150,80,0,0.5), rgba(80,40,0,0.7))", dateBorder: "2px solid #ffaa00", textColor: "#fff5cc", flyerBackground: "linear-gradient(135deg, #0d0500 0%, #1a0a00 25%, #2d1500 50%, #1a0a00 75%, #0d0500 100%), radial-gradient(circle at 50% 40%, rgba(255,170,0,0.22) 0%, transparent 50%), radial-gradient(circle at 20% 70%, rgba(255,102,0,0.18) 0%, transparent 40%), radial-gradient(circle at 80% 30%, rgba(255,50,0,0.15) 0%, transparent 35%), radial-gradient(circle at 50% 80%, rgba(255,215,0,0.12) 0%, transparent 30%)" },
                autumnFall: { title: "Autumn Fall Stream", titleFont: "https://fonts.googleapis.com/css2?family=Rye&display=swap", titleColor: "#ff6600", dateFont: "https://fonts.googleapis.com/css2?family=Lora:wght@700&display=swap", dateColor: "#ffcc44", dateBackground: "linear-gradient(135deg, rgba(120,50,0,0.5), rgba(60,20,0,0.7))", dateBorder: "2px solid #ff6600", textColor: "#fff0d4", flyerBackground: "linear-gradient(160deg, #100500 0%, #200a00 25%, #3d1500 50%, #200a00 75%, #100500 100%), radial-gradient(circle at 50% 30%, rgba(255,102,0,0.2) 0%, transparent 45%), radial-gradient(circle at 20% 70%, rgba(204,80,0,0.18) 0%, transparent 40%), radial-gradient(circle at 80% 60%, rgba(255,170,0,0.15) 0%, transparent 35%), repeating-linear-gradient(60deg, transparent, transparent 25px, rgba(200,80,0,0.03) 25px, rgba(200,80,0,0.03) 50px)" },
                summerSolstice: { title: "Summer Solstice Stream", titleFont: "https://fonts.googleapis.com/css2?family=Pacifico&display=swap", titleColor: "#ffdd00", dateFont: "https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&display=swap", dateColor: "#ff8800", dateBackground: "linear-gradient(135deg, rgba(180,100,0,0.4), rgba(100,60,0,0.5))", dateBorder: "2px solid #ffdd00", textColor: "#fff9e6", flyerBackground: "linear-gradient(180deg, #000d1a 0%, #001a33 20%, #003366 40%, #0066aa 60%, #ff8800 80%, #ffcc00 100%)" },
                springBloom: { title: "Spring Bloom Stream", titleFont: "https://fonts.googleapis.com/css2?family=Satisfy&display=swap", titleColor: "#ff66aa", dateFont: "https://fonts.googleapis.com/css2?family=Comfortaa:wght@600&display=swap", dateColor: "#88dd00", dateBackground: "linear-gradient(135deg, rgba(255,102,170,0.3), rgba(136,221,0,0.3))", dateBorder: "2px solid #ff66aa", textColor: "#fff0f8", flyerBackground: "linear-gradient(135deg, #0d0018 0%, #1a003d 25%, #002600 50%, #1a003d 75%, #0d0018 100%), radial-gradient(circle at 30% 40%, rgba(255,102,170,0.2) 0%, transparent 40%), radial-gradient(circle at 70% 60%, rgba(136,221,0,0.18) 0%, transparent 40%), radial-gradient(circle at 50% 20%, rgba(255,200,220,0.1) 0%, transparent 30%), repeating-linear-gradient(45deg, transparent, transparent 20px, rgba(255,102,170,0.02) 20px, rgba(255,102,170,0.02) 40px)" }
            };
            
            const design = themes[preset];
            if (!design) return;
            
            // Extract font families first
            const titleFontFamily = extractFontFamily(design.titleFont);
            const dateFontFamily = extractFontFamily(design.dateFont);
            
            // Apply the preset
            document.getElementById('title').value = design.title;
            document.getElementById('preview-title').textContent = design.title;
            
            // Load and apply fonts
            loadCustomFont(design.titleFont, 'title-font');
            loadCustomFont(design.dateFont, 'date-font');
            
            if (titleFontFamily) {
                document.getElementById('preview-title').style.fontFamily = `'${titleFontFamily}', sans-serif`;
            }
            if (dateFontFamily) {
                document.getElementById('preview-date').style.fontFamily = `'${dateFontFamily}', sans-serif`;
            }
            
            // Apply colors
            document.getElementById('preview-title').style.color = design.titleColor;
            document.getElementById('preview-date').style.color = design.dateColor;
            
            // Apply date box styling
            const dateBox = document.querySelector('.flyer-datetime');
            if (dateBox) {
                dateBox.style.background = design.dateBackground;
                dateBox.style.border = design.dateBorder;
            }
            
            // Apply text colors and fonts to streamers
            let style = document.getElementById('custom-text-colors');
            if (!style) {
                style = document.createElement('style');
                style.id = 'custom-text-colors';
                document.head.appendChild(style);
            }
            
            style.textContent = `
                .streamer-name { 
                    color: ${design.textColor} !important; 
                    font-family: '${titleFontFamily}', sans-serif !important;
                }
                .streamer-time { 
                    color: ${design.textColor} !important; 
                    opacity: 0.8; 
                    font-family: '${dateFontFamily}', sans-serif !important;
                }
            `;
            
            // Apply background
            const flyer = document.getElementById('flyer');
            flyer.style.background = design.flyerBackground;
            
            // Apply SVG decorations
            applyDecoration(preset);

            showStatus('‚ú® Theme applied!', 'success');
        }

        // SVG decoration patterns per theme category
        function applyDecoration(preset) {
            const svg = document.getElementById('flyer-decoration');
            if (!svg) return;

            const W = currentOrientation === 'landscape' ? 800 : 600;
            const H = currentOrientation === 'landscape' ? 600 : 800;
            const decorations = {
                // Gaming & Tech
                cyberpunk: `<g opacity="0.22"><polygon points="0,0 180,0 0,180" fill="#00ffff"/><polygon points="600,800 420,800 600,620" fill="#ff00ff"/><line x1="0" y1="160" x2="600" y2="160" stroke="#00ffff" stroke-width="1.5"/><line x1="0" y1="640" x2="600" y2="640" stroke="#ff00ff" stroke-width="1.5"/><line x1="40" y1="0" x2="40" y2="800" stroke="#00ffff" stroke-width="0.8"/><line x1="560" y1="0" x2="560" y2="800" stroke="#ff00ff" stroke-width="0.8"/><circle cx="300" cy="400" r="180" fill="none" stroke="#00ffff" stroke-width="1.5"/><circle cx="300" cy="400" r="120" fill="none" stroke="#ff00ff" stroke-width="1"/><rect x="260" y="360" width="80" height="80" fill="none" stroke="#00ffff" stroke-width="1.5" transform="rotate(45 300 400)"/><line x1="300" y1="220" x2="300" y2="100" stroke="#00ffff" stroke-width="1"/><line x1="300" y1="580" x2="300" y2="700" stroke="#ff00ff" stroke-width="1"/><polygon points="0,0 30,0 0,30" fill="#ff00ff"/><polygon points="600,0 570,0 600,30" fill="#00ffff"/><polygon points="0,800 30,800 0,770" fill="#00ffff"/><polygon points="600,800 570,800 600,770" fill="#ff00ff"/></g>`,
                vaporwave: `<g opacity="0.2"><line x1="0" y1="480" x2="600" y2="480" stroke="#ff6ec7" stroke-width="2.5"/><line x1="0" y1="510" x2="600" y2="510" stroke="#b44fe8" stroke-width="1.5"/><line x1="0" y1="535" x2="600" y2="535" stroke="#ff6ec7" stroke-width="1"/><line x1="300" y1="480" x2="0" y2="800" stroke="#ff6ec7" stroke-width="1.5"/><line x1="300" y1="480" x2="600" y2="800" stroke="#ff6ec7" stroke-width="1.5"/><line x1="300" y1="480" x2="80" y2="800" stroke="#b44fe8" stroke-width="1"/><line x1="300" y1="480" x2="520" y2="800" stroke="#b44fe8" stroke-width="1"/><circle cx="300" cy="300" r="100" fill="none" stroke="#ff6ec7" stroke-width="2.5"/><circle cx="300" cy="300" r="60" fill="rgba(255,110,199,0.15)"/><line x1="300" y1="200" x2="300" y2="150" stroke="#ff6ec7" stroke-width="2"/><rect x="20" y="20" width="560" height="440" fill="none" stroke="rgba(255,110,199,0.2)" stroke-width="1.5"/></g>`,
                matrix: `<g opacity="0.15"><text x="20" y="60" fill="#00ff41" font-family="monospace" font-size="11">10110010 01001101</text><text x="380" y="90" fill="#00ff41" font-family="monospace" font-size="10">01110010</text><text x="20" y="180" fill="#00ff41" font-family="monospace" font-size="10">11001010 10110100</text><text x="20" y="480" fill="#00ff41" font-family="monospace" font-size="10">10011001 01101100</text><text x="20" y="700" fill="#00ff41" font-family="monospace" font-size="11">01001101 10110010</text><rect x="15" y="15" width="570" height="770" fill="none" stroke="#00ff41" stroke-width="1" stroke-dasharray="3,9"/><line x1="15" y1="400" x2="585" y2="400" stroke="rgba(0,255,65,0.2)" stroke-width="0.5"/><line x1="300" y1="15" x2="300" y2="785" stroke="rgba(0,255,65,0.15)" stroke-width="0.5"/></g>`,
                retroArcade: `<g opacity="0.2"><rect x="0" y="0" width="600" height="800" fill="none" stroke="#ffff00" stroke-width="6"/><rect x="10" y="10" width="580" height="780" fill="none" stroke="#ff00ff" stroke-width="2.5"/><line x1="0" y1="400" x2="600" y2="400" stroke="#ffff00" stroke-width="2" stroke-dasharray="15,15"/><line x1="300" y1="0" x2="300" y2="800" stroke="#ff00ff" stroke-width="2" stroke-dasharray="15,15"/><rect x="22" y="22" width="30" height="30" fill="#ffff00"/><rect x="548" y="22" width="30" height="30" fill="#ff00ff"/><rect x="22" y="748" width="30" height="30" fill="#00ffff"/><rect x="548" y="748" width="30" height="30" fill="#ffff00"/><circle cx="300" cy="400" r="80" fill="none" stroke="#ffff00" stroke-width="2"/><polygon points="300,320 380,400 300,480 220,400" fill="none" stroke="#00ffff" stroke-width="2"/></g>`,
                space: `<g opacity="0.2"><circle cx="80" cy="80" r="5" fill="white"/><circle cx="200" cy="150" r="3" fill="white"/><circle cx="450" cy="60" r="6" fill="white"/><circle cx="30" cy="350" r="5" fill="white"/><circle cx="100" cy="600" r="4" fill="white"/><circle cx="480" cy="650" r="5" fill="white"/><circle cx="300" cy="400" r="140" fill="none" stroke="rgba(100,0,200,0.45)" stroke-width="2"/><ellipse cx="300" cy="400" rx="220" ry="65" fill="none" stroke="rgba(200,100,255,0.25)" stroke-width="2"/><circle cx="300" cy="400" r="30" fill="rgba(100,0,200,0.2)"/></g>`,
                // Fantasy
                fantasy: `<g opacity="0.2"><rect x="0" y="0" width="600" height="800" fill="none" stroke="#ffd700" stroke-width="5"/><rect x="14" y="14" width="572" height="772" fill="none" stroke="#8b4513" stroke-width="2"/><polygon points="0,0 80,0 0,80" fill="rgba(255,215,0,0.35)"/><polygon points="600,0 520,0 600,80" fill="rgba(255,215,0,0.35)"/><polygon points="0,800 80,800 0,720" fill="rgba(255,215,0,0.35)"/><polygon points="600,800 520,800 600,720" fill="rgba(255,215,0,0.35)"/><polygon points="300,20 320,80 385,80 333,117 353,180 300,143 247,180 267,117 215,80 280,80" fill="none" stroke="#ffd700" stroke-width="2.5"/><circle cx="300" cy="100" r="16" fill="#ffd700" opacity="0.6"/><circle cx="300" cy="400" r="140" fill="none" stroke="#ffd700" stroke-width="1.5" stroke-dasharray="8,16"/></g>`,
                halloween: `<g opacity="0.22"><polygon points="300,40 325,115 405,115 342,160 365,235 300,190 235,235 258,160 195,115 275,115" fill="#ff6600"/><line x1="300" y1="235" x2="300" y2="310" stroke="#ff6600" stroke-width="2"/><rect x="0" y="0" width="600" height="800" fill="none" stroke="rgba(255,102,0,0.3)" stroke-width="4"/><circle cx="70" cy="680" r="38" fill="none" stroke="#9370db" stroke-width="2.5"/><line x1="70" y1="642" x2="70" y2="718" stroke="#9370db" stroke-width="1.5"/><line x1="32" y1="680" x2="108" y2="680" stroke="#9370db" stroke-width="1.5"/><circle cx="530" cy="700" r="32" fill="none" stroke="#9370db" stroke-width="2"/></g>`,
                // Nature
                ocean: `<g opacity="0.18"><path d="M 0 600 Q 60 575 120 600 Q 180 625 240 600 Q 300 575 360 600 Q 420 625 480 600 Q 540 575 600 600" fill="none" stroke="#00ffff" stroke-width="3"/><path d="M 0 640 Q 75 615 150 640 Q 225 665 300 640 Q 375 615 450 640 Q 525 665 600 640" fill="none" stroke="#00bfff" stroke-width="2.5"/><path d="M 0 675 Q 75 652 150 675 Q 225 698 300 675 Q 375 652 450 675 Q 525 698 600 675" fill="none" stroke="#00ffff" stroke-width="2"/><circle cx="120" cy="260" r="60" fill="none" stroke="rgba(0,200,255,0.25)" stroke-width="1.5"/></g>`,
                forest: `<g opacity="0.18"><polygon points="40,800 75,640 110,800" fill="#228b22"/><polygon points="55,730 90,570 125,730" fill="#2d5a27"/><polygon points="110,800 155,615 200,800" fill="#1a6b1a"/><polygon points="200,800 250,600 300,800" fill="#2d5a27"/><polygon points="300,800 350,600 400,800" fill="#1a6b1a"/><polygon points="400,800 445,615 490,800" fill="#2d5a27"/><polygon points="490,800 525,640 560,800" fill="#228b22"/><circle cx="300" cy="300" r="80" fill="none" stroke="rgba(144,238,144,0.2)" stroke-width="2"/></g>`,
                // Holidays
                christmasClassic: `<g opacity="0.2"><polygon points="300,28 338,118 316,118 355,195 326,195 368,278 232,278 274,195 245,195 284,118 262,118" fill="#228b22"/><rect x="278" y="278" width="44" height="35" fill="#8b4513"/><circle cx="300" cy="52" r="13" fill="#ffd700"/><circle cx="258" cy="138" r="9" fill="#ff0000"/><circle cx="342" cy="138" r="9" fill="#ffd700"/><circle cx="240" cy="210" r="8" fill="#ffd700"/><circle cx="360" cy="210" r="8" fill="#ff0000"/><polygon points="0,0 100,0 0,100" fill="rgba(255,0,0,0.22)"/><polygon points="600,0 500,0 600,100" fill="rgba(0,150,0,0.22)"/></g>`,
                valentinesDay: `<g opacity="0.22"><path d="M 300 420 C 300 420 180 355 180 278 C 180 240 213 212 255 212 C 278 212 300 228 300 228 C 300 228 322 212 345 212 C 387 212 420 240 420 278 C 420 355 300 420 300 420 Z" fill="rgba(255,100,150,0.45)"/><path d="M 150 600 C 150 600 100 572 100 545 C 100 528 115 516 132 516 C 142 516 150 522 150 522 C 150 522 158 516 168 516 C 185 516 200 528 200 545 C 200 572 150 600 150 600 Z" fill="rgba(255,100,150,0.35)"/><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(255,100,150,0.25)" stroke-width="2"/></g>`,
                newYearEve: `<g opacity="0.22"><line x1="300" y1="250" x2="300" y2="120" stroke="rgba(255,215,0,0.6)" stroke-width="3"/><line x1="300" y1="250" x2="400" y2="165" stroke="rgba(255,180,0,0.55)" stroke-width="2.5"/><line x1="300" y1="250" x2="420" y2="290" stroke="rgba(255,150,0,0.55)" stroke-width="2.5"/><line x1="300" y1="250" x2="380" y2="380" stroke="rgba(255,215,0,0.55)" stroke-width="2.5"/><line x1="300" y1="250" x2="200" y2="165" stroke="rgba(255,215,0,0.55)" stroke-width="2.5"/><line x1="300" y1="250" x2="180" y2="290" stroke="rgba(255,180,0,0.55)" stroke-width="2.5"/><line x1="300" y1="250" x2="220" y2="380" stroke="rgba(255,150,0,0.55)" stroke-width="2.5"/><circle cx="300" cy="250" r="28" fill="rgba(255,215,0,0.45)"/></g>`,
                stPatricks: `<g opacity="0.22"><path d="M 300 380 C 300 380 268 350 268 322 C 268 308 280 298 292 302 C 296 304 300 310 300 310 C 300 310 304 304 308 302 C 320 298 332 308 332 322 C 332 350 300 380 300 380 Z" fill="rgba(0,160,0,0.5)"/><path d="M 300 380 C 300 380 268 410 268 438 C 268 452 280 462 292 458 C 296 456 300 450 300 450 C 300 450 304 456 308 458 C 320 462 332 452 332 438 C 332 410 300 380 300 380 Z" fill="rgba(0,140,0,0.5)"/><path d="M 300 380 C 300 380 258 370 242 348 C 236 336 240 322 252 320 C 258 320 264 326 264 326 C 264 326 262 318 266 314 C 274 306 288 308 296 316 Z" fill="rgba(0,180,0,0.5)"/><path d="M 300 380 C 300 380 342 370 358 348 C 364 336 360 322 348 320 C 342 320 336 326 336 326 C 336 326 338 318 334 314 C 326 306 312 308 304 316 Z" fill="rgba(0,160,0,0.5)"/><line x1="300" y1="380" x2="300" y2="600" stroke="rgba(0,140,0,0.4)" stroke-width="3"/></g>`,
                // Elegant
                goldGala: `<g opacity="0.2"><rect x="15" y="15" width="570" height="770" fill="none" stroke="#ffd700" stroke-width="3"/><rect x="28" y="28" width="544" height="744" fill="none" stroke="rgba(255,215,0,0.3)" stroke-width="1.5"/><polygon points="15,15 85,15 15,85" fill="rgba(255,215,0,0.3)"/><polygon points="585,15 515,15 585,85" fill="rgba(255,215,0,0.3)"/><polygon points="15,785 85,785 15,715" fill="rgba(255,215,0,0.3)"/><polygon points="585,785 515,785 585,715" fill="rgba(255,215,0,0.3)"/><polygon points="300,55 318,112 378,112 330,147 348,204 300,169 252,204 270,147 222,112 282,112" fill="rgba(255,215,0,0.35)"/></g>`,
                championship: `<g opacity="0.22"><polygon points="300,30 335,140 450,140 360,205 393,315 300,250 207,315 240,205 150,140 265,140" fill="rgba(255,215,0,0.35)"/><circle cx="300" cy="172" r="10" fill="rgba(255,240,100,0.7)"/><rect x="0" y="0" width="600" height="800" fill="none" stroke="#ffd700" stroke-width="5"/><polygon points="0,0 70,0 0,70" fill="rgba(255,215,0,0.25)"/><polygon points="600,0 530,0 600,70" fill="rgba(255,215,0,0.25)"/><polygon points="0,800 70,800 0,730" fill="rgba(255,215,0,0.25)"/><polygon points="600,800 530,800 600,730" fill="rgba(255,215,0,0.25)"/></g>`,
                hanukkah: `<g opacity="0.22"><line x1="300" y1="660" x2="300" y2="548" stroke="#4169e1" stroke-width="6"/><line x1="258" y1="660" x2="258" y2="595" stroke="#4169e1" stroke-width="4"/><line x1="216" y1="660" x2="216" y2="622" stroke="#87ceeb" stroke-width="4"/><line x1="174" y1="660" x2="174" y2="638" stroke="#87ceeb" stroke-width="3.5"/><line x1="342" y1="660" x2="342" y2="595" stroke="#4169e1" stroke-width="4"/><line x1="384" y1="660" x2="384" y2="622" stroke="#87ceeb" stroke-width="4"/><line x1="426" y1="660" x2="426" y2="638" stroke="#87ceeb" stroke-width="3.5"/><line x1="148" y1="660" x2="452" y2="660" stroke="#4169e1" stroke-width="6"/><circle cx="300" cy="542" r="11" fill="#ffd700"/></g>`,
                diaDeMuertos: `<g opacity="0.22"><circle cx="300" cy="358" r="82" fill="none" stroke="rgba(255,102,0,0.45)" stroke-width="2.5"/><ellipse cx="272" cy="342" rx="16" ry="20" fill="none" stroke="rgba(255,0,255,0.5)" stroke-width="2.5"/><ellipse cx="328" cy="342" rx="16" ry="20" fill="none" stroke="rgba(255,0,255,0.5)" stroke-width="2.5"/><path d="M 264 385 Q 300 402 336 385" fill="none" stroke="rgba(255,102,0,0.5)" stroke-width="2.5"/><line x1="280" y1="402" x2="277" y2="425" stroke="rgba(255,0,255,0.4)" stroke-width="2"/><line x1="300" y1="403" x2="300" y2="428" stroke="rgba(255,102,0,0.4)" stroke-width="2"/><line x1="320" y1="402" x2="323" y2="425" stroke="rgba(255,0,255,0.4)" stroke-width="2"/></g>`,
                lunarNewYear: `<g opacity="0.22"><circle cx="300" cy="368" r="155" fill="none" stroke="rgba(255,34,0,0.45)" stroke-width="3"/><circle cx="300" cy="368" r="105" fill="none" stroke="rgba(255,215,0,0.35)" stroke-width="2"/><path d="M 300 213 L 366 352 L 300 320 L 234 352 Z" fill="rgba(255,215,0,0.45)"/><polygon points="0,0 120,0 0,120" fill="rgba(255,34,0,0.28)"/><polygon points="600,0 480,0 600,120" fill="rgba(255,34,0,0.28)"/><polygon points="0,800 120,800 0,680" fill="rgba(255,215,0,0.22)"/><polygon points="600,800 480,800 600,680" fill="rgba(255,215,0,0.22)"/></g>`,
                diwali: `<g opacity="0.24"><circle cx="300" cy="355" r="12" fill="#ffaa00"/><path d="M 300 341 L 296 316 L 304 316 Z" fill="#ff6600"/><circle cx="300" cy="355" r="20" fill="none" stroke="rgba(255,170,0,0.35)" stroke-width="2"/><circle cx="150" cy="530" r="10" fill="#ff8800"/><path d="M 150 519 L 147 498 L 153 498 Z" fill="#ffaa00"/><circle cx="150" cy="530" r="16" fill="none" stroke="rgba(255,136,0,0.35)" stroke-width="1.5"/><circle cx="450" cy="530" r="10" fill="#ff8800"/><path d="M 450 519 L 447 498 L 453 498 Z" fill="#ffaa00"/><circle cx="450" cy="530" r="16" fill="none" stroke="rgba(255,136,0,0.35)" stroke-width="1.5"/></g>`,
                autumnFall: `<g opacity="0.2"><ellipse cx="75" cy="210" rx="18" ry="28" fill="#ff6600" transform="rotate(-32 75 210)"/><ellipse cx="158" cy="155" rx="15" ry="24" fill="#cc4400" transform="rotate(18 158 155)"/><ellipse cx="520" cy="290" rx="16" ry="26" fill="#ff8800" transform="rotate(-22 520 290)"/><ellipse cx="448" cy="198" rx="18" ry="28" fill="#dd5500" transform="rotate(28 448 198)"/><ellipse cx="140" cy="568" rx="19" ry="30" fill="#ff8800" transform="rotate(-15 140 568)"/><ellipse cx="488" cy="640" rx="18" ry="28" fill="#ff6600" transform="rotate(-18 488 640)"/><ellipse cx="295" cy="715" rx="20" ry="30" fill="#ff6600" transform="rotate(-10 295 715)"/></g>`,
                summerSolstice: `<g opacity="0.22"><circle cx="300" cy="118" r="75" fill="rgba(255,221,0,0.22)"/><circle cx="300" cy="118" r="95" fill="none" stroke="rgba(255,221,0,0.3)" stroke-width="2.5"/><line x1="300" y1="23" x2="300" y2="0" stroke="#ffdd00" stroke-width="3"/><line x1="300" y1="213" x2="300" y2="255" stroke="#ffdd00" stroke-width="3"/><line x1="205" y1="58" x2="165" y2="18" stroke="#ffdd00" stroke-width="2.5"/><line x1="395" y1="58" x2="435" y2="18" stroke="#ffdd00" stroke-width="2.5"/><line x1="155" y1="118" x2="110" y2="118" stroke="#ffdd00" stroke-width="2.5"/><line x1="445" y1="118" x2="490" y2="118" stroke="#ffdd00" stroke-width="2.5"/><line x1="205" y1="178" x2="165" y2="218" stroke="#ffdd00" stroke-width="2.5"/><line x1="395" y1="178" x2="435" y2="218" stroke="#ffdd00" stroke-width="2.5"/></g>`,
                steampunk: `<g opacity="0.2"><circle cx="90" cy="90" r="65" fill="none" stroke="#cd7f32" stroke-width="2.5"/><circle cx="90" cy="90" r="50" fill="none" stroke="#b8860b" stroke-width="1.5"/><line x1="90" y1="25" x2="90" y2="155" stroke="#cd7f32" stroke-width="2"/><line x1="25" y1="90" x2="155" y2="90" stroke="#cd7f32" stroke-width="2"/><line x1="44" y1="44" x2="136" y2="136" stroke="#cd7f32" stroke-width="1.5"/><line x1="136" y1="44" x2="44" y2="136" stroke="#cd7f32" stroke-width="1.5"/><circle cx="90" cy="90" r="10" fill="#b8860b"/><circle cx="510" cy="710" r="65" fill="none" stroke="#b8860b" stroke-width="2.5"/><circle cx="510" cy="710" r="50" fill="none" stroke="#cd7f32" stroke-width="1.5"/><line x1="510" y1="645" x2="510" y2="775" stroke="#b8860b" stroke-width="2"/><line x1="445" y1="710" x2="575" y2="710" stroke="#b8860b" stroke-width="2"/><line x1="464" y1="664" x2="556" y2="756" stroke="#b8860b" stroke-width="1.5"/><line x1="556" y1="664" x2="464" y2="756" stroke="#b8860b" stroke-width="1.5"/><circle cx="510" cy="710" r="10" fill="#cd7f32"/><circle cx="300" cy="400" r="150" fill="none" stroke="#cd7f32" stroke-width="1.5" stroke-dasharray="8,6"/><rect x="260" y="360" width="80" height="80" fill="none" stroke="#daa520" stroke-width="2"/></g>`,
                glitch: `<g opacity="0.2"><rect x="0" y="80" width="600" height="12" fill="#ff0066"/><rect x="0" y="84" width="400" height="4" fill="#00ffff" opacity="0.5"/><rect x="0" y="200" width="600" height="6" fill="#00ffff"/><rect x="0" y="350" width="600" height="10" fill="#ff0066"/><rect x="0" y="500" width="600" height="8" fill="#00ffff"/><rect x="0" y="650" width="600" height="10" fill="#ff0066"/><rect x="15" y="0" width="5" height="800" fill="#00ffff"/><rect x="580" y="0" width="5" height="800" fill="#ff0066"/><rect x="0" y="0" width="600" height="800" fill="none" stroke="#ff0066" stroke-width="3"/><rect x="3" y="3" width="594" height="794" fill="none" stroke="#00ffff" stroke-width="1.5"/></g>`,
                holographic: `<g opacity="0.18"><polygon points="300,40 380,270 590,270 420,390 485,620 300,500 115,620 180,390 10,270 220,270" fill="none" stroke="#00ffff" stroke-width="2"/><polygon points="300,80 360,260 550,260 400,370 455,570 300,455 145,570 200,370 50,260 240,260" fill="none" stroke="#ff00ff" stroke-width="1.5"/><circle cx="300" cy="400" r="200" fill="none" stroke="#00ffff" stroke-width="1.5"/><circle cx="300" cy="400" r="150" fill="none" stroke="#ff00ff" stroke-width="1"/><line x1="300" y1="200" x2="300" y2="100" stroke="#00ffff" stroke-width="1.5"/><line x1="300" y1="600" x2="300" y2="700" stroke="#ff00ff" stroke-width="1.5"/></g>`,
                terminal: `<g opacity="0.15"><rect x="15" y="15" width="570" height="770" fill="none" stroke="#00ff00" stroke-width="2.5"/><rect x="25" y="25" width="550" height="50" fill="rgba(0,255,0,0.1)"/><line x1="25" y1="75" x2="575" y2="75" stroke="#00ff00" stroke-width="1.5"/><circle cx="45" cy="50" r="8" fill="#ff5f57" opacity="0.7"/><circle cx="70" cy="50" r="8" fill="#febc2e" opacity="0.7"/><circle cx="95" cy="50" r="8" fill="#28c840" opacity="0.7"/><text x="30" y="55" fill="#00ff00" font-family="monospace" font-size="12">user@stream:~$</text><text x="30" y="110" fill="#00ff00" font-family="monospace" font-size="10" opacity="0.7">./start_stream.sh</text><text x="30" y="135" fill="#00ff00" font-family="monospace" font-size="10" opacity="0.5">Stream live!</text></g>`,
                neonCity: `<g opacity="0.2"><rect x="0" y="500" width="70" height="300" fill="none" stroke="#ff1493" stroke-width="2"/><rect x="80" y="440" width="55" height="360" fill="none" stroke="#00ffff" stroke-width="2"/><rect x="155" y="520" width="45" height="280" fill="none" stroke="#ff1493" stroke-width="1.5"/><rect x="420" y="460" width="50" height="340" fill="none" stroke="#00ffff" stroke-width="2"/><rect x="490" y="490" width="60" height="310" fill="none" stroke="#ff1493" stroke-width="2"/><rect x="530" y="430" width="70" height="370" fill="none" stroke="#00ffff" stroke-width="1.5"/><line x1="0" y1="500" x2="600" y2="500" stroke="#ff1493" stroke-width="2"/><circle cx="300" cy="250" r="80" fill="none" stroke="#ff1493" stroke-width="1.5"/></g>`,
                cyberpunkRed: `<g opacity="0.22"><polygon points="0,0 200,0 0,200" fill="#ff0000"/><polygon points="600,800 400,800 600,600" fill="#cc0000"/><line x1="0" y1="150" x2="600" y2="150" stroke="#ff0000" stroke-width="2"/><line x1="0" y1="650" x2="600" y2="650" stroke="#ff0000" stroke-width="2"/><circle cx="300" cy="400" r="190" fill="none" stroke="#ff0000" stroke-width="1.5"/><rect x="255" y="355" width="90" height="90" fill="none" stroke="#ffff00" stroke-width="2.5" transform="rotate(45 300 400)"/><line x1="300" y1="210" x2="300" y2="100" stroke="#ff0000" stroke-width="1.5"/><line x1="110" y1="400" x2="20" y2="400" stroke="#ffff00" stroke-width="1.5"/><line x1="490" y1="400" x2="580" y2="400" stroke="#ffff00" stroke-width="1.5"/></g>`,
                digitalRain: `<g opacity="0.14"><text x="30" y="80" fill="#39ff14" font-family="monospace" font-size="11">10110100</text><text x="30" y="200" fill="#39ff14" font-family="monospace" font-size="10" opacity="0.7">11010010</text><text x="380" y="120" fill="#39ff14" font-family="monospace" font-size="11">11001010</text><text x="200" y="600" fill="#39ff14" font-family="monospace" font-size="11">00110101</text><line x1="0" y1="0" x2="600" y2="800" stroke="#39ff14" stroke-width="0.8" opacity="0.2"/><line x1="600" y1="0" x2="0" y2="800" stroke="#39ff14" stroke-width="0.8" opacity="0.2"/><rect x="20" y="20" width="560" height="760" fill="none" stroke="#39ff14" stroke-width="1" stroke-dasharray="2,12"/></g>`,
                synthwave: `<g opacity="0.2"><line x1="0" y1="500" x2="600" y2="500" stroke="#f0ff10" stroke-width="3"/><line x1="0" y1="530" x2="600" y2="530" stroke="#f0ff10" stroke-width="1.5"/><line x1="300" y1="500" x2="0" y2="800" stroke="#ff10f0" stroke-width="2"/><line x1="300" y1="500" x2="600" y2="800" stroke="#ff10f0" stroke-width="2"/><line x1="300" y1="500" x2="60" y2="800" stroke="#b800d8" stroke-width="1.2"/><line x1="300" y1="500" x2="540" y2="800" stroke="#b800d8" stroke-width="1.2"/><circle cx="300" cy="220" r="100" fill="none" stroke="#ff10f0" stroke-width="2.5"/><circle cx="300" cy="220" r="65" fill="rgba(255,16,240,0.12)"/><line x1="300" y1="120" x2="300" y2="50" stroke="#f0ff10" stroke-width="2"/></g>`,
                quantumRealm: `<g opacity="0.18"><circle cx="300" cy="400" r="210" fill="none" stroke="#9d00ff" stroke-width="2"/><circle cx="300" cy="400" r="160" fill="none" stroke="#00ffff" stroke-width="1.5"/><circle cx="300" cy="400" r="110" fill="none" stroke="#9d00ff" stroke-width="1"/><ellipse cx="300" cy="400" rx="210" ry="70" fill="none" stroke="#00ffff" stroke-width="1.5" transform="rotate(30 300 400)"/><ellipse cx="300" cy="400" rx="210" ry="70" fill="none" stroke="#9d00ff" stroke-width="1.5" transform="rotate(-30 300 400)"/><circle cx="300" cy="190" r="10" fill="#00ffff" opacity="0.7"/><circle cx="300" cy="610" r="10" fill="#9d00ff" opacity="0.7"/></g>`,
                hackerGreen: `<g opacity="0.16"><rect x="15" y="15" width="570" height="770" fill="none" stroke="#00ff41" stroke-width="2" stroke-dasharray="4,10"/><rect x="30" y="30" width="540" height="60" fill="rgba(0,255,65,0.07)"/><text x="40" y="65" fill="#00ff41" font-family="monospace" font-size="13">root@hacknet:~# _</text><line x1="30" y1="90" x2="570" y2="90" stroke="#00ff41" stroke-width="1.5"/><text x="40" y="125" fill="#00ff41" font-family="monospace" font-size="10" opacity="0.6">Scanning target...</text><text x="40" y="148" fill="#00ff41" font-family="monospace" font-size="10" opacity="0.5">Port 443: OPEN</text><text x="40" y="168" fill="#00ff41" font-family="monospace" font-size="10" opacity="0.4">Access granted.</text></g>`,
                futureNoir: `<g opacity="0.18"><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(220,220,255,0.4)" stroke-width="3"/><rect x="28" y="28" width="544" height="744" fill="none" stroke="rgba(180,180,220,0.2)" stroke-width="1"/><line x1="0" y1="0" x2="600" y2="800" stroke="rgba(255,255,255,0.1)" stroke-width="2"/><line x1="600" y1="0" x2="0" y2="800" stroke="rgba(255,255,255,0.1)" stroke-width="2"/><circle cx="300" cy="400" r="180" fill="none" stroke="rgba(220,220,255,0.25)" stroke-width="1.5" stroke-dasharray="10,10"/><polygon points="300,220 480,510 120,510" fill="none" stroke="rgba(220,220,255,0.2)" stroke-width="1.5"/></g>`,
                circuitBoard: `<g opacity="0.18"><line x1="40" y1="80" x2="180" y2="80" stroke="#00ff00" stroke-width="2.5"/><line x1="180" y1="80" x2="180" y2="200" stroke="#00ff00" stroke-width="2.5"/><line x1="180" y1="200" x2="360" y2="200" stroke="#00ff00" stroke-width="2.5"/><line x1="360" y1="200" x2="360" y2="320" stroke="#00ff00" stroke-width="2.5"/><line x1="360" y1="320" x2="500" y2="320" stroke="#00ff00" stroke-width="2.5"/><line x1="80" y1="400" x2="80" y2="600" stroke="#ffff00" stroke-width="2"/><line x1="80" y1="600" x2="240" y2="600" stroke="#ffff00" stroke-width="2"/><line x1="240" y1="600" x2="240" y2="720" stroke="#ffff00" stroke-width="2"/><circle cx="180" cy="80" r="7" fill="#00ff00"/><circle cx="360" cy="200" r="7" fill="#00ff00"/><circle cx="500" cy="320" r="7" fill="#ffff00"/><circle cx="80" cy="400" r="7" fill="#ffff00"/><rect x="155" y="155" width="50" height="50" fill="none" stroke="#00ff00" stroke-width="2"/><rect x="335" y="295" width="50" height="50" fill="none" stroke="#ffff00" stroke-width="2"/></g>`,
                laserGrid: `<g opacity="0.18"><line x1="0" y1="160" x2="600" y2="160" stroke="#ff0080" stroke-width="2"/><line x1="0" y1="320" x2="600" y2="320" stroke="#00ffff" stroke-width="2"/><line x1="0" y1="480" x2="600" y2="480" stroke="#ff0080" stroke-width="2"/><line x1="0" y1="640" x2="600" y2="640" stroke="#00ffff" stroke-width="2"/><line x1="120" y1="0" x2="120" y2="800" stroke="#00ffff" stroke-width="2"/><line x1="240" y1="0" x2="240" y2="800" stroke="#ff0080" stroke-width="2"/><line x1="360" y1="0" x2="360" y2="800" stroke="#00ffff" stroke-width="2"/><line x1="480" y1="0" x2="480" y2="800" stroke="#ff0080" stroke-width="2"/><circle cx="120" cy="160" r="7" fill="#ff0080"/><circle cx="240" cy="320" r="7" fill="#ff0080"/><circle cx="300" cy="400" r="12" fill="#fff" opacity="0.6"/></g>`,
                pixelPerfect: `<g opacity="0.2"><rect x="0" y="0" width="600" height="800" fill="none" stroke="#ff6600" stroke-width="6"/><rect x="18" y="18" width="564" height="764" fill="none" stroke="#00ff00" stroke-width="2"/><rect x="0" y="0" width="40" height="40" fill="#ff6600" opacity="0.5"/><rect x="560" y="0" width="40" height="40" fill="#00ff00" opacity="0.5"/><rect x="280" y="380" width="40" height="40" fill="#ffff00" opacity="0.4"/><line x1="0" y1="400" x2="600" y2="400" stroke="#ffff00" stroke-width="1.5" stroke-dasharray="10,10"/><line x1="300" y1="0" x2="300" y2="800" stroke="#ffff00" stroke-width="1.5" stroke-dasharray="10,10"/></g>`,
                techNeon: `<g opacity="0.18"><circle cx="300" cy="400" r="210" fill="none" stroke="#00ffff" stroke-width="2"/><circle cx="300" cy="400" r="150" fill="none" stroke="#ff00ff" stroke-width="1.5"/><circle cx="300" cy="400" r="90" fill="none" stroke="#00ffff" stroke-width="1"/><polygon points="300,190 510,505 90,505" fill="none" stroke="#00ffff" stroke-width="2"/><polygon points="300,610 90,295 510,295" fill="none" stroke="#ff00ff" stroke-width="1.5"/><circle cx="300" cy="190" r="8" fill="#00ffff" opacity="0.8"/></g>`,
                dataStream: `<g opacity="0.16"><line x1="0" y1="160" x2="600" y2="160" stroke="rgba(0,255,255,0.35)" stroke-width="2"/><line x1="0" y1="320" x2="600" y2="320" stroke="rgba(0,255,255,0.25)" stroke-width="1.5"/><line x1="0" y1="480" x2="600" y2="480" stroke="rgba(0,255,255,0.35)" stroke-width="2"/><line x1="0" y1="640" x2="600" y2="640" stroke="rgba(0,255,255,0.25)" stroke-width="1.5"/><circle cx="80" cy="160" r="6" fill="#00ffff" opacity="0.6"/><circle cx="350" cy="320" r="6" fill="#00ffff" opacity="0.6"/><line x1="80" y1="160" x2="350" y2="320" stroke="rgba(0,255,255,0.2)" stroke-width="1"/><line x1="350" y1="320" x2="100" y2="480" stroke="rgba(0,255,255,0.2)" stroke-width="1"/><rect x="20" y="20" width="560" height="760" fill="none" stroke="rgba(0,200,200,0.15)" stroke-width="1.5"/></g>`,
                galaxy: `<g opacity="0.2"><circle cx="300" cy="400" r="220" fill="none" stroke="rgba(150,100,255,0.3)" stroke-width="2"/><circle cx="300" cy="400" r="170" fill="none" stroke="rgba(100,150,255,0.25)" stroke-width="1.5"/><circle cx="300" cy="400" r="120" fill="none" stroke="rgba(150,100,255,0.2)" stroke-width="1.5"/><ellipse cx="300" cy="400" rx="260" ry="80" fill="none" stroke="rgba(150,100,255,0.22)" stroke-width="2"/><circle cx="300" cy="400" r="25" fill="rgba(200,150,255,0.3)"/><circle cx="100" cy="150" r="4" fill="white"/><circle cx="450" cy="100" r="3" fill="white"/></g>`,
                nebula: `<g opacity="0.18"><circle cx="180" cy="280" r="140" fill="rgba(200,100,255,0.13)"/><circle cx="420" cy="520" r="120" fill="rgba(100,200,255,0.13)"/><circle cx="320" cy="380" r="100" fill="rgba(255,100,200,0.13)"/><circle cx="460" cy="250" r="90" fill="rgba(100,180,255,0.1)"/><circle cx="100" cy="100" r="4" fill="white"/><circle cx="500" cy="150" r="4" fill="white"/></g>`,
                deepSpace: `<g opacity="0.2"><circle cx="300" cy="400" r="50" fill="rgba(0,0,0,0.8)"/><circle cx="300" cy="400" r="80" fill="none" stroke="rgba(255,200,100,0.5)" stroke-width="3"/><circle cx="300" cy="400" r="130" fill="none" stroke="rgba(200,200,255,0.35)" stroke-width="2"/><circle cx="300" cy="400" r="190" fill="none" stroke="rgba(150,150,200,0.2)" stroke-width="1.5"/><ellipse cx="300" cy="400" rx="230" ry="60" fill="none" stroke="rgba(200,150,100,0.3)" stroke-width="2"/><circle cx="100" cy="200" r="4" fill="white"/></g>`,
                interstellar: `<g opacity="0.2"><circle cx="300" cy="400" r="70" fill="rgba(255,200,0,0.3)"/><circle cx="300" cy="400" r="50" fill="rgba(255,220,50,0.4)"/><ellipse cx="300" cy="400" rx="200" ry="55" fill="none" stroke="rgba(255,200,100,0.4)" stroke-width="4"/><ellipse cx="300" cy="400" rx="260" ry="75" fill="none" stroke="rgba(200,150,50,0.3)" stroke-width="2.5"/><ellipse cx="300" cy="400" rx="310" ry="90" fill="none" stroke="rgba(180,120,30,0.2)" stroke-width="2"/></g>`,
                dragonLore: `<g opacity="0.2"><path d="M 120 420 Q 170 300 230 330 Q 200 375 250 395 Q 210 295 300 310 Q 390 295 350 395 Q 400 375 370 330 Q 430 300 480 420 Q 510 530 460 575 Q 380 625 300 605 Q 220 625 140 575 Q 90 530 120 420 Z" fill="none" stroke="rgba(200,80,0,0.3)" stroke-width="2"/><path d="M 250 210 L 230 150 L 255 165 L 260 120 L 285 155 L 300 120 L 315 155 L 340 120 L 345 165 L 370 150 L 350 210" fill="none" stroke="rgba(200,80,0,0.35)" stroke-width="2"/><polygon points="300,180 320,230 300,220 280,230" fill="rgba(220,100,0,0.45)"/></g>`,
                wizardTower: `<g opacity="0.2"><polygon points="300,30 360,160 440,210 395,300 420,320 300,320 180,320 205,300 160,210 240,160" fill="none" stroke="rgba(100,50,200,0.4)" stroke-width="2"/><rect x="240" y="320" width="120" height="240" fill="none" stroke="rgba(100,50,200,0.35)" stroke-width="2"/><rect x="258" y="360" width="35" height="50" fill="none" stroke="rgba(150,100,255,0.4)" stroke-width="1.5"/><rect x="308" y="360" width="35" height="50" fill="none" stroke="rgba(150,100,255,0.4)" stroke-width="1.5"/><polygon points="300,90 310,120 340,120 318,138 326,168 300,150 274,168 282,138 260,120 290,120" fill="rgba(180,130,255,0.4)"/></g>`,
                holyKnight: `<g opacity="0.2"><polygon points="300,40 330,110 300,95 270,110" fill="rgba(255,215,0,0.6)"/><rect x="265" y="110" width="70" height="150" rx="6" fill="none" stroke="rgba(255,215,0,0.5)" stroke-width="2.5"/><path d="M 265 260 Q 265 330 300 355 Q 335 330 335 260" fill="none" stroke="rgba(255,215,0,0.5)" stroke-width="2.5"/><line x1="300" y1="110" x2="300" y2="355" stroke="rgba(255,215,0,0.3)" stroke-width="1.5"/><line x1="265" y1="185" x2="335" y2="185" stroke="rgba(255,215,0,0.3)" stroke-width="1.5"/><polygon points="300,175 304,182 312,182 306,187 308,195 300,190 292,195 294,187 288,182 296,182" fill="rgba(255,215,0,0.5)"/></g>`,
                elvishWoods: `<g opacity="0.2"><polygon points="300,60 370,210 320,190 340,280 300,260 260,280 280,190 230,210" fill="rgba(100,200,100,0.4)"/><polygon points="300,140 380,330 320,305 345,420 300,395 255,420 280,305 220,330" fill="rgba(80,180,80,0.35)"/><polygon points="300,250 395,470 325,440 355,580 300,550 245,580 275,440 205,470" fill="rgba(60,160,60,0.3)"/><rect x="278" y="580" width="44" height="80" fill="rgba(100,60,20,0.5)"/></g>`,
                enchantedForest: `<g opacity="0.2"><polygon points="150,520 185,405 168,405 190,310 168,310 180,250 150,275 120,250 132,310 110,310 132,405 115,405" fill="rgba(100,200,150,0.35)"/><polygon points="460,560 495,445 478,445 500,350 478,350 490,290 460,315 430,290 442,350 420,350 442,445 425,445" fill="rgba(100,180,200,0.35)"/><circle cx="150" cy="245" r="5" fill="rgba(255,220,100,0.7)"/><circle cx="460" cy="285" r="5" fill="rgba(255,220,100,0.7)"/></g>`,
                celestialMagic: `<g opacity="0.2"><polygon points="300,55 320,115 384,115 334,151 354,215 300,179 246,215 266,151 216,115 280,115" fill="rgba(200,180,100,0.45)"/><circle cx="300" cy="135" r="100" fill="none" stroke="rgba(200,180,100,0.25)" stroke-width="2"/><circle cx="100" cy="300" r="28" fill="rgba(200,180,100,0.3)"/><circle cx="500" cy="280" r="22" fill="rgba(200,180,100,0.25)"/><circle cx="80" cy="600" r="18" fill="rgba(200,180,100,0.2)"/></g>`,
                phoenixRising: `<g opacity="0.22"><path d="M 300 430 Q 240 310 180 250 Q 230 285 300 265 Q 370 285 420 250 Q 360 310 300 430 Z" fill="rgba(255,150,0,0.45)"/><path d="M 300 510 Q 200 460 140 510 Q 175 480 205 525 Q 250 570 300 540 Q 350 570 395 525 Q 425 480 460 510 Q 400 460 300 510 Z" fill="rgba(255,100,0,0.35)"/><path d="M 300 430 Q 290 370 260 340 Q 300 360 340 340 Q 310 370 300 430 Z" fill="rgba(255,200,50,0.4)"/><circle cx="300" cy="340" r="25" fill="rgba(255,220,80,0.5)"/></g>`,
                fairyTale: `<g opacity="0.2"><polygon points="300,50 318,105 378,105 330,140 348,195 300,160 252,195 270,140 222,105 282,105" fill="rgba(255,200,255,0.5)"/><circle cx="300" cy="122" r="90" fill="none" stroke="rgba(255,150,255,0.3)" stroke-width="2"/><circle cx="80" cy="600" r="30" fill="rgba(255,200,255,0.2)"/><circle cx="520" cy="650" r="28" fill="rgba(200,200,255,0.2)"/></g>`,
                iceKingdom: `<g opacity="0.2"><polygon points="300,30 308,58 338,58 315,74 323,102 300,86 277,102 285,74 262,58 292,58" fill="rgba(150,230,255,0.6)"/><polygon points="100,200 108,228 138,228 115,244 123,272 100,256 77,272 85,244 62,228 92,228" fill="rgba(150,230,255,0.45)"/><polygon points="500,600 508,628 538,628 515,644 523,672 500,656 477,672 485,644 462,628 492,628" fill="rgba(150,230,255,0.45)"/><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(150,220,255,0.25)" stroke-width="2"/></g>`,
                crystalCave: `<g opacity="0.2"><polygon points="100,800 70,580 95,510 120,580" fill="rgba(180,100,255,0.35)"/><polygon points="190,800 160,560 190,485 215,560" fill="rgba(150,150,255,0.35)"/><polygon points="270,800 245,545 272,465 295,545" fill="rgba(200,120,255,0.35)"/><polygon points="330,800 355,545 328,465 305,545" fill="rgba(150,150,255,0.35)"/><polygon points="410,800 385,560 410,485 435,560" fill="rgba(180,100,255,0.35)"/><polygon points="500,800 530,580 505,510 480,580" fill="rgba(150,150,255,0.35)"/><circle cx="330" cy="455" r="10" fill="rgba(200,160,255,0.6)"/></g>`,
                cave: `<g opacity="0.2"><path d="M 0 0 Q 80 90 180 50 Q 280 10 370 70 Q 460 110 560 40 Q 600 20 600 0 Z" fill="rgba(80,60,40,0.5)"/><polygon points="60,0 35,120 85,120" fill="rgba(60,50,40,0.5)"/><polygon points="160,0 130,140 190,140" fill="rgba(70,55,40,0.5)"/><polygon points="380,0 350,100 410,100" fill="rgba(70,55,40,0.5)"/><circle cx="200" cy="450" r="20" fill="rgba(150,80,20,0.3)"/></g>`,
                dwarvenForge: `<g opacity="0.22"><circle cx="300" cy="560" r="90" fill="rgba(255,100,0,0.3)"/><circle cx="300" cy="560" r="60" fill="rgba(255,150,0,0.35)"/><circle cx="300" cy="560" r="30" fill="rgba(255,200,50,0.4)"/><rect x="240" y="420" width="120" height="140" rx="8" fill="none" stroke="rgba(180,100,0,0.45)" stroke-width="2.5"/><rect x="215" y="475" width="30" height="50" rx="5" fill="none" stroke="rgba(180,100,0,0.4)" stroke-width="2"/><rect x="355" y="475" width="30" height="50" rx="5" fill="none" stroke="rgba(180,100,0,0.4)" stroke-width="2"/></g>`,
                arcaneLibrary: `<g opacity="0.18"><rect x="30" y="280" width="35" height="120" rx="4" fill="rgba(180,140,80,0.35)"/><rect x="72" y="260" width="28" height="140" rx="4" fill="rgba(160,120,60,0.35)"/><rect x="107" y="290" width="32" height="110" rx="4" fill="rgba(200,155,80,0.35)"/><rect x="438" y="260" width="32" height="140" rx="4" fill="rgba(180,140,80,0.35)"/><rect x="477" y="280" width="28" height="120" rx="4" fill="rgba(160,120,60,0.35)"/><rect x="512" y="265" width="35" height="135" rx="4" fill="rgba(200,155,80,0.35)"/><circle cx="300" cy="400" r="100" fill="none" stroke="rgba(200,160,80,0.35)" stroke-width="2"/></g>`,
                mysticPortal: `<g opacity="0.22"><circle cx="300" cy="400" r="170" fill="none" stroke="rgba(100,0,200,0.5)" stroke-width="3.5"/><circle cx="300" cy="400" r="130" fill="none" stroke="rgba(150,0,255,0.4)" stroke-width="2.5"/><circle cx="300" cy="400" r="90" fill="none" stroke="rgba(100,0,200,0.35)" stroke-width="2"/><circle cx="300" cy="400" r="50" fill="rgba(100,0,200,0.2)"/><ellipse cx="300" cy="400" rx="170" ry="55" fill="none" stroke="rgba(200,100,255,0.35)" stroke-width="2"/><ellipse cx="300" cy="400" rx="170" ry="55" fill="none" stroke="rgba(150,0,255,0.25)" stroke-width="1.5" transform="rotate(60 300 400)"/><circle cx="300" cy="230" r="10" fill="rgba(200,100,255,0.6)"/></g>`,
                ancientRunes: `<g opacity="0.2"><text x="35" y="210" fill="rgba(200,180,100,0.5)" font-size="34">&#x16A0;</text><text x="520" y="210" fill="rgba(200,180,100,0.5)" font-size="34">&#x16A2;</text><text x="35" y="620" fill="rgba(200,180,100,0.5)" font-size="34">&#x16A6;</text><text x="520" y="620" fill="rgba(200,180,100,0.5)" font-size="34">&#x16A8;</text><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(180,150,80,0.35)" stroke-width="2.5"/><circle cx="300" cy="400" r="160" fill="none" stroke="rgba(180,150,80,0.2)" stroke-width="1.5" stroke-dasharray="5,15"/></g>`,
                mythicalBeasts: `<g opacity="0.18"><path d="M 180 420 Q 220 350 270 380 Q 260 400 290 410 Q 270 340 330 355 Q 390 340 370 410 Q 400 400 390 380 Q 440 350 480 420 Q 500 490 460 530 Q 400 565 330 548 Q 260 565 200 530 Q 160 490 180 420 Z" fill="none" stroke="rgba(180,130,50,0.35)" stroke-width="2"/><path d="M 240 230 L 220 160 L 248 178 L 252 130 L 278 170 L 300 130 L 322 170 L 348 130 L 352 178 L 380 160 L 360 230" fill="none" stroke="rgba(180,130,50,0.4)" stroke-width="2"/></g>`,
                jungle: `<g opacity="0.2"><path d="M 0 720 L 0 580 Q 70 538 120 610 Q 155 565 200 640 L 200 800 Z" fill="rgba(0,100,0,0.3)"/><path d="M 400 720 L 400 580 Q 470 538 520 610 Q 555 565 600 640 L 600 800 Z" fill="rgba(0,80,0,0.3)"/><ellipse cx="80" cy="680" rx="95" ry="35" fill="rgba(50,150,50,0.25)" transform="rotate(-25 80 680)"/><ellipse cx="460" cy="655" rx="100" ry="32" fill="rgba(50,150,50,0.25)" transform="rotate(20 460 655)"/></g>`,
                rainforest: `<g opacity="0.18"><path d="M 0 760 L 0 580 Q 90 535 140 615 Q 175 570 220 650 L 220 800 Z" fill="rgba(0,100,0,0.25)"/><path d="M 380 760 L 380 580 Q 470 535 520 615 Q 555 570 600 650 L 600 800 Z" fill="rgba(0,80,0,0.25)"/><ellipse cx="50" cy="600" rx="70" ry="25" fill="rgba(30,120,30,0.2)" transform="rotate(-20 50 600)"/></g>`,
                desert: `<g opacity="0.2"><path d="M 0 720 Q 100 688 200 720 Q 300 752 400 720 Q 500 688 600 720 L 600 800 L 0 800 Z" fill="rgba(200,150,50,0.2)"/><circle cx="140" cy="280" r="60" fill="none" stroke="rgba(255,200,100,0.3)" stroke-width="2"/><circle cx="460" cy="240" r="80" fill="none" stroke="rgba(255,180,50,0.25)" stroke-width="2"/></g>`,
                mountain: `<g opacity="0.2"><polygon points="0,800 140,380 280,480 420,260 560,440 600,400 600,800" fill="rgba(80,80,120,0.22)"/><polygon points="0,800 80,580 180,630 330,470 480,570 580,510 600,530 600,800" fill="rgba(60,60,100,0.28)"/><polygon points="140,380 160,350 180,380" fill="rgba(255,255,255,0.3)"/><polygon points="420,260 440,230 460,260" fill="rgba(255,255,255,0.35)"/></g>`,
                savanna: `<g opacity="0.18"><path d="M 0 710 Q 100 680 200 710 Q 300 740 400 710 Q 500 680 600 710 L 600 800 L 0 800 Z" fill="rgba(200,160,50,0.22)"/><line x1="80" y1="710" x2="70" y2="590" stroke="rgba(140,90,20,0.5)" stroke-width="4"/><ellipse cx="70" cy="558" rx="70" ry="38" fill="rgba(100,140,50,0.35)"/><line x1="350" y1="710" x2="342" y2="550" stroke="rgba(120,70,15,0.5)" stroke-width="5"/><ellipse cx="340" cy="512" rx="90" ry="45" fill="rgba(80,120,40,0.35)"/></g>`,
                tundra: `<g opacity="0.16"><path d="M 0 710 Q 150 690 300 710 Q 450 730 600 710 L 600 800 L 0 800 Z" fill="rgba(200,230,255,0.22)"/><circle cx="100" cy="180" r="5" fill="white"/><circle cx="220" cy="110" r="3" fill="white"/><circle cx="380" cy="150" r="4" fill="white"/><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(200,230,255,0.2)" stroke-width="2"/></g>`,
                glacier: `<g opacity="0.18"><polygon points="0,380 140,170 280,320 420,120 560,270 600,240 600,800 0,800" fill="rgba(150,220,255,0.17)"/><polygon points="0,480 180,280 360,380 560,220 600,240 600,800 0,800" fill="rgba(100,200,255,0.13)"/></g>`,
                waterfall: `<g opacity="0.2"><line x1="230" y1="0" x2="210" y2="800" stroke="rgba(100,200,255,0.35)" stroke-width="4"/><line x1="260" y1="0" x2="245" y2="800" stroke="rgba(150,220,255,0.3)" stroke-width="6"/><line x1="295" y1="0" x2="282" y2="800" stroke="rgba(100,200,255,0.35)" stroke-width="5"/><line x1="320" y1="0" x2="312" y2="800" stroke="rgba(150,220,255,0.3)" stroke-width="4"/><path d="M 160 780 Q 280 750 400 780" fill="none" stroke="rgba(100,200,255,0.5)" stroke-width="3"/></g>`,
                volcano: `<g opacity="0.2"><polygon points="0,800 180,360 360,800" fill="rgba(160,45,0,0.25)"/><polygon points="120,800 280,280 440,800" fill="rgba(180,55,0,0.2)"/><polygon points="240,800 300,200 360,800" fill="rgba(200,65,0,0.22)"/><circle cx="300" cy="200" r="50" fill="rgba(255,100,0,0.35)"/><circle cx="300" cy="200" r="30" fill="rgba(255,150,0,0.45)"/></g>`,
                earthquake: `<g opacity="0.18"><line x1="0" y1="420" x2="120" y2="395" stroke="rgba(150,100,50,0.5)" stroke-width="3.5"/><line x1="120" y1="395" x2="175" y2="465" stroke="rgba(150,100,50,0.5)" stroke-width="3.5"/><line x1="175" y1="465" x2="260" y2="380" stroke="rgba(150,100,50,0.5)" stroke-width="3.5"/><line x1="260" y1="380" x2="330" y2="450" stroke="rgba(150,100,50,0.5)" stroke-width="3.5"/><line x1="330" y1="450" x2="400" y2="380" stroke="rgba(150,100,50,0.5)" stroke-width="3.5"/><line x1="400" y1="380" x2="460" y2="440" stroke="rgba(150,100,50,0.5)" stroke-width="3.5"/><line x1="460" y1="440" x2="600" y2="410" stroke="rgba(150,100,50,0.5)" stroke-width="3.5"/></g>`,
                thunderstorm: `<g opacity="0.2"><polygon points="290,60 268,280 308,258 274,490 348,258 318,278 338,60" fill="rgba(255,255,100,0.5)"/><polygon points="100,170 82,320 108,306 84,435 132,306 108,322 118,170" fill="rgba(255,255,100,0.3)"/><path d="M 0 200 Q 100 170 200 200 Q 300 230 400 200 Q 500 170 600 200" fill="none" stroke="rgba(100,120,180,0.3)" stroke-width="3"/></g>`,
                typhoon: `<g opacity="0.2"><circle cx="300" cy="400" r="220" fill="none" stroke="rgba(100,150,255,0.35)" stroke-width="2.5"/><circle cx="300" cy="400" r="175" fill="none" stroke="rgba(150,200,255,0.3)" stroke-width="2"/><circle cx="300" cy="400" r="130" fill="none" stroke="rgba(100,150,255,0.35)" stroke-width="2"/><circle cx="300" cy="400" r="85" fill="none" stroke="rgba(150,200,255,0.3)" stroke-width="1.5"/><circle cx="300" cy="400" r="15" fill="rgba(255,255,255,0.2)"/></g>`,
                sandstorm: `<g opacity="0.2"><line x1="0" y1="180" x2="600" y2="230" stroke="rgba(200,160,80,0.35)" stroke-width="5"/><line x1="0" y1="260" x2="600" y2="300" stroke="rgba(190,150,70,0.3)" stroke-width="8"/><line x1="0" y1="360" x2="600" y2="390" stroke="rgba(200,160,80,0.35)" stroke-width="6"/><line x1="0" y1="450" x2="600" y2="475" stroke="rgba(190,150,70,0.25)" stroke-width="7"/></g>`,
                solarFlare: `<g opacity="0.22"><circle cx="300" cy="400" r="90" fill="rgba(255,200,50,0.35)"/><circle cx="300" cy="400" r="65" fill="rgba(255,220,80,0.45)"/><circle cx="300" cy="400" r="140" fill="none" stroke="rgba(255,150,0,0.45)" stroke-width="2.5"/><line x1="300" y1="260" x2="300" y2="120" stroke="rgba(255,200,0,0.5)" stroke-width="4"/><line x1="300" y1="540" x2="300" y2="680" stroke="rgba(255,200,0,0.5)" stroke-width="4"/><line x1="160" y1="400" x2="40" y2="400" stroke="rgba(255,200,0,0.5)" stroke-width="4"/><line x1="440" y1="400" x2="560" y2="400" stroke="rgba(255,200,0,0.5)" stroke-width="4"/></g>`,
                supernova: `<g opacity="0.22"><circle cx="300" cy="400" r="70" fill="rgba(255,255,200,0.35)"/><circle cx="300" cy="400" r="140" fill="none" stroke="rgba(255,200,100,0.45)" stroke-width="2.5"/><circle cx="300" cy="400" r="210" fill="none" stroke="rgba(255,100,50,0.3)" stroke-width="2"/><line x1="300" y1="190" x2="300" y2="60" stroke="rgba(255,200,100,0.5)" stroke-width="4"/><line x1="300" y1="610" x2="300" y2="740" stroke="rgba(255,200,100,0.5)" stroke-width="4"/><line x1="90" y1="400" x2="0" y2="400" stroke="rgba(255,200,100,0.5)" stroke-width="4"/><line x1="510" y1="400" x2="600" y2="400" stroke="rgba(255,200,100,0.5)" stroke-width="4"/></g>`,
                blackHole: `<g opacity="0.22"><circle cx="300" cy="400" r="45" fill="rgba(0,0,0,0.9)"/><circle cx="300" cy="400" r="70" fill="none" stroke="rgba(255,150,50,0.6)" stroke-width="4"/><circle cx="300" cy="400" r="100" fill="none" stroke="rgba(200,100,255,0.4)" stroke-width="2.5"/><circle cx="300" cy="400" r="140" fill="none" stroke="rgba(150,80,220,0.3)" stroke-width="2"/><ellipse cx="300" cy="400" rx="250" ry="65" fill="none" stroke="rgba(255,150,50,0.3)" stroke-width="2.5"/></g>`,
                cosmicDust: `<g opacity="0.18"><circle cx="160" cy="220" r="70" fill="rgba(200,150,255,0.13)"/><circle cx="440" cy="620" r="90" fill="rgba(100,200,255,0.13)"/><circle cx="460" cy="220" r="70" fill="rgba(255,150,200,0.12)"/><circle cx="200" cy="100" r="4" fill="white"/><circle cx="400" cy="120" r="3" fill="white"/></g>`,
                cosmicRift: `<g opacity="0.2"><path d="M 300 0 Q 270 150 290 300 Q 310 450 280 600 Q 300 720 300 800" fill="none" stroke="rgba(200,100,255,0.5)" stroke-width="4"/><path d="M 300 0 Q 330 150 310 300 Q 290 450 320 600 Q 300 720 300 800" fill="none" stroke="rgba(100,200,255,0.4)" stroke-width="3"/><circle cx="300" cy="400" r="90" fill="none" stroke="rgba(200,100,255,0.3)" stroke-width="1.5"/></g>`,
                wormhole: `<g opacity="0.2"><circle cx="300" cy="400" r="210" fill="none" stroke="rgba(100,50,200,0.22)" stroke-width="1.5"/><circle cx="300" cy="400" r="175" fill="none" stroke="rgba(150,100,255,0.28)" stroke-width="2"/><circle cx="300" cy="400" r="140" fill="none" stroke="rgba(100,50,200,0.32)" stroke-width="2.5"/><circle cx="300" cy="400" r="105" fill="none" stroke="rgba(150,100,255,0.35)" stroke-width="2"/><circle cx="300" cy="400" r="70" fill="none" stroke="rgba(100,50,200,0.4)" stroke-width="2"/><circle cx="300" cy="400" r="35" fill="rgba(100,50,200,0.3)"/></g>`,
                marsColony: `<g opacity="0.2"><path d="M 0 690 Q 100 658 200 690 Q 300 722 400 690 Q 500 658 600 690 L 600 800 L 0 800 Z" fill="rgba(180,80,30,0.25)"/><rect x="180" y="540" width="90" height="55" rx="6" fill="none" stroke="rgba(200,100,50,0.4)" stroke-width="2"/><path d="M 180 540 Q 225 510 270 540" fill="none" stroke="rgba(200,100,50,0.4)" stroke-width="2"/><rect x="320" y="520" width="70" height="75" rx="6" fill="none" stroke="rgba(200,100,50,0.4)" stroke-width="2"/></g>`,
                moonBase: `<g opacity="0.18"><path d="M 0 700 Q 150 678 300 700 Q 450 722 600 700 L 600 800 L 0 800 Z" fill="rgba(180,180,200,0.22)"/><circle cx="80" cy="700" r="35" fill="rgba(150,150,180,0.35)"/><rect x="230" y="560" width="120" height="70" rx="10" fill="none" stroke="rgba(200,200,255,0.45)" stroke-width="2.5"/><path d="M 230 560 Q 290 528 350 560" fill="none" stroke="rgba(200,200,255,0.45)" stroke-width="2.5"/></g>`,
                asteroidBelt: `<g opacity="0.18"><polygon points="70,190 88,215 108,203 96,232 73,220 55,232 48,203 63,215" fill="rgba(150,130,100,0.45)"/><polygon points="430,340 455,372 480,356 466,398 437,382 412,398 405,356 424,372" fill="rgba(130,110,90,0.45)"/><polygon points="520,650 538,670 558,660 548,685 526,674 508,685 502,660 516,670" fill="rgba(140,120,95,0.4)"/><circle cx="300" cy="400" r="220" fill="none" stroke="rgba(150,130,100,0.22)" stroke-width="1.5" stroke-dasharray="12,24"/></g>`,
                starship: `<g opacity="0.2"><polygon points="300,80 345,200 325,200 350,310 300,290 250,310 275,200 255,200" fill="none" stroke="rgba(100,200,255,0.5)" stroke-width="2.5"/><ellipse cx="300" cy="310" rx="60" ry="20" fill="none" stroke="rgba(100,200,255,0.4)" stroke-width="2"/><line x1="300" y1="310" x2="300" y2="700" stroke="rgba(100,200,255,0.25)" stroke-width="4"/><line x1="240" y1="450" x2="120" y2="520" stroke="rgba(100,200,255,0.2)" stroke-width="2.5"/><line x1="360" y1="450" x2="480" y2="520" stroke="rgba(100,200,255,0.2)" stroke-width="2.5"/></g>`,
                alienWorld: `<g opacity="0.2"><circle cx="120" cy="680" r="70" fill="rgba(100,200,100,0.22)"/><circle cx="450" cy="660" r="90" fill="rgba(150,255,150,0.18)"/><polygon points="80,610 115,490 150,610" fill="rgba(100,200,100,0.35)"/><polygon points="380,620 420,488 460,620" fill="rgba(100,200,100,0.35)"/><circle cx="280" cy="240" r="55" fill="none" stroke="rgba(100,200,100,0.3)" stroke-width="2"/></g>`,
                stellarNursery: `<g opacity="0.18"><circle cx="200" cy="260" r="90" fill="rgba(255,150,200,0.13)"/><circle cx="420" cy="560" r="110" fill="rgba(150,200,255,0.13)"/><circle cx="120" cy="120" r="5" fill="white"/><circle cx="200" cy="175" r="18" fill="rgba(255,220,150,0.4)"/><circle cx="200" cy="175" r="8" fill="rgba(255,240,200,0.7)"/></g>`,
                quantumField: `<g opacity="0.18"><circle cx="150" cy="200" r="35" fill="none" stroke="rgba(150,100,255,0.45)" stroke-width="2"/><circle cx="450" cy="200" r="35" fill="none" stroke="rgba(100,200,255,0.45)" stroke-width="2"/><circle cx="150" cy="600" r="35" fill="none" stroke="rgba(100,200,255,0.45)" stroke-width="2"/><circle cx="450" cy="600" r="35" fill="none" stroke="rgba(150,100,255,0.45)" stroke-width="2"/><circle cx="300" cy="400" r="90" fill="none" stroke="rgba(200,150,255,0.35)" stroke-width="2.5"/><line x1="150" y1="200" x2="450" y2="200" stroke="rgba(150,100,255,0.2)" stroke-width="1.5"/></g>`,
                timeWarp: `<g opacity="0.18"><circle cx="300" cy="400" r="210" fill="none" stroke="rgba(100,200,255,0.22)" stroke-width="2"/><circle cx="300" cy="400" r="170" fill="none" stroke="rgba(255,200,100,0.25)" stroke-width="2"/><circle cx="300" cy="400" r="130" fill="none" stroke="rgba(100,200,255,0.28)" stroke-width="2.5"/><circle cx="300" cy="400" r="90" fill="none" stroke="rgba(255,200,100,0.32)" stroke-width="2"/><circle cx="300" cy="400" r="50" fill="none" stroke="rgba(100,200,255,0.35)" stroke-width="1.5"/><line x1="300" y1="190" x2="300" y2="130" stroke="rgba(255,200,100,0.4)" stroke-width="3"/></g>`,
                vampire: `<g opacity="0.22"><path d="M 250 70 L 300 190 L 350 70 Q 375 45 400 58 L 355 165 Q 330 215 300 205 Q 270 215 245 165 L 200 58 Q 225 45 250 70 Z" fill="rgba(180,0,0,0.5)"/><circle cx="300" cy="380" r="170" fill="none" stroke="rgba(180,0,0,0.3)" stroke-width="2"/><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(180,0,0,0.25)" stroke-width="2.5"/></g>`,
                zombie: `<g opacity="0.18"><path d="M 0 380 Q 45 355 80 395 Q 115 430 155 388 Q 195 346 235 395 Q 268 435 300 385" fill="none" stroke="rgba(100,150,50,0.45)" stroke-width="3.5"/><path d="M 300 385 Q 335 340 375 390 Q 415 435 455 385 Q 490 340 530 390 Q 562 428 600 400" fill="none" stroke="rgba(100,150,50,0.45)" stroke-width="3.5"/></g>`,
                demon: `<g opacity="0.22"><polygon points="228,55 262,155 250,178 300,132 350,178 338,155 372,55 348,80 326,32 300,105 274,32 252,80" fill="rgba(180,0,0,0.55)"/><polygon points="148,100 170,180 155,195 210,155 280,135 210,175 148,100" fill="rgba(160,0,0,0.35)"/><polygon points="452,100 430,180 445,195 390,155 320,135 390,175 452,100" fill="rgba(160,0,0,0.35)"/><circle cx="300" cy="380" r="180" fill="none" stroke="rgba(180,0,0,0.3)" stroke-width="2"/></g>`,
                ghost: `<g opacity="0.18"><path d="M 225 240 Q 225 158 300 135 Q 375 112 400 165 Q 445 190 445 278 L 445 415 Q 418 390 395 415 Q 372 440 348 415 Q 324 390 300 415 Q 276 440 252 415 Q 228 390 205 415 L 205 278 Z" fill="rgba(200,220,255,0.22)" stroke="rgba(200,220,255,0.35)" stroke-width="2"/><ellipse cx="275" cy="305" rx="18" ry="22" fill="rgba(180,200,255,0.5)"/><ellipse cx="325" cy="305" rx="18" ry="22" fill="rgba(180,200,255,0.5)"/></g>`,
                werewolf: `<g opacity="0.2"><circle cx="300" cy="55" r="50" fill="none" stroke="rgba(180,150,80,0.35)" stroke-width="2.5"/><ellipse cx="282" cy="44" rx="10" ry="14" fill="rgba(180,150,80,0.4)"/><ellipse cx="318" cy="44" rx="10" ry="14" fill="rgba(180,150,80,0.4)"/><path d="M 0 580 Q 80 545 160 580 Q 240 615 320 580 Q 400 545 480 580 Q 540 608 600 590" fill="none" stroke="rgba(150,120,60,0.35)" stroke-width="3"/><polygon points="0,800 60,680 120,800" fill="rgba(150,120,60,0.2)"/></g>`,
                crypt: `<g opacity="0.2"><rect x="228" y="360" width="144" height="200" rx="6" fill="none" stroke="rgba(150,130,150,0.45)" stroke-width="2.5"/><path d="M 228 360 Q 300 302 372 360" fill="none" stroke="rgba(150,130,150,0.45)" stroke-width="2.5"/><line x1="300" y1="395" x2="300" y2="540" stroke="rgba(150,130,150,0.45)" stroke-width="2.5"/><line x1="252" y1="468" x2="348" y2="468" stroke="rgba(150,130,150,0.45)" stroke-width="2.5"/><text x="278" y="430" fill="rgba(150,130,150,0.4)" font-family="serif" font-size="16">R.I.P</text><circle cx="300" cy="338" r="14" fill="rgba(150,130,150,0.4)"/></g>`,
                plague: `<g opacity="0.18"><circle cx="300" cy="340" r="90" fill="none" stroke="rgba(80,120,60,0.4)" stroke-width="2.5"/><path d="M 222 272 L 255 260 Q 300 243 345 260 L 378 272 Q 396 316 385 348 L 300 372 L 215 348 Q 204 316 222 272 Z" fill="none" stroke="rgba(80,120,60,0.45)" stroke-width="2"/><circle cx="270" cy="330" r="12" fill="rgba(80,120,60,0.4)"/><circle cx="330" cy="330" r="12" fill="rgba(80,120,60,0.4)"/></g>`,
                asylum: `<g opacity="0.18"><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(200,200,200,0.3)" stroke-width="2.5"/><line x1="150" y1="15" x2="150" y2="785" stroke="rgba(200,200,200,0.18)" stroke-width="1.5"/><line x1="300" y1="15" x2="300" y2="785" stroke="rgba(200,200,200,0.18)" stroke-width="1.5"/><line x1="450" y1="15" x2="450" y2="785" stroke="rgba(200,200,200,0.18)" stroke-width="1.5"/><line x1="15" y1="400" x2="585" y2="400" stroke="rgba(200,200,200,0.18)" stroke-width="1"/></g>`,
                occult: `<g opacity="0.2"><polygon points="300,80 420,370 130,178 470,178 180,370" fill="none" stroke="rgba(180,0,180,0.45)" stroke-width="2.5"/><circle cx="300" cy="224" r="170" fill="none" stroke="rgba(150,0,150,0.35)" stroke-width="2"/><circle cx="300" cy="80" r="10" fill="rgba(200,0,200,0.6)"/><circle cx="420" cy="370" r="10" fill="rgba(180,0,180,0.6)"/><circle cx="130" cy="178" r="10" fill="rgba(180,0,180,0.6)"/><circle cx="470" cy="178" r="10" fill="rgba(200,0,200,0.6)"/><circle cx="180" cy="370" r="10" fill="rgba(180,0,180,0.6)"/></g>`,
                cursed: `<g opacity="0.2"><path d="M 300 80 Q 240 180 190 290 Q 140 400 190 510 Q 240 620 300 720 Q 360 620 410 510 Q 460 400 410 290 Q 360 180 300 80 Z" fill="none" stroke="rgba(150,0,150,0.35)" stroke-width="2.5"/><circle cx="300" cy="400" r="110" fill="none" stroke="rgba(120,0,120,0.35)" stroke-width="2"/></g>`,
                haunted: `<g opacity="0.2"><rect x="180" y="280" width="240" height="330" fill="none" stroke="rgba(180,180,150,0.35)" stroke-width="2.5"/><rect x="210" y="258" width="180" height="48" fill="none" stroke="rgba(180,180,150,0.35)" stroke-width="2"/><rect x="195" y="355" width="60" height="85" fill="none" stroke="rgba(160,160,130,0.25)" stroke-width="1.5"/><rect x="345" y="355" width="60" height="85" fill="none" stroke="rgba(160,160,130,0.25)" stroke-width="1.5"/><rect x="264" y="415" width="72" height="100" rx="4" fill="none" stroke="rgba(160,160,130,0.3)" stroke-width="1.5"/></g>`,
                ritual: `<g opacity="0.22"><circle cx="300" cy="400" r="215" fill="none" stroke="rgba(180,0,0,0.35)" stroke-width="2.5"/><polygon points="300,185 476,318 410,520 190,520 124,318" fill="none" stroke="rgba(180,0,0,0.4)" stroke-width="2.5"/><circle cx="300" cy="185" r="11" fill="rgba(200,0,0,0.7)"/><circle cx="476" cy="318" r="11" fill="rgba(180,0,0,0.7)"/><circle cx="410" cy="520" r="11" fill="rgba(200,0,0,0.7)"/><circle cx="190" cy="520" r="11" fill="rgba(180,0,0,0.7)"/><circle cx="124" cy="318" r="11" fill="rgba(200,0,0,0.7)"/></g>`,
                nightmare: `<g opacity="0.2"><line x1="0" y1="0" x2="600" y2="800" stroke="rgba(100,0,100,0.25)" stroke-width="3"/><line x1="600" y1="0" x2="0" y2="800" stroke="rgba(100,0,100,0.25)" stroke-width="3"/><circle cx="300" cy="400" r="130" fill="none" stroke="rgba(150,0,150,0.3)" stroke-width="2"/><circle cx="300" cy="400" r="30" fill="rgba(100,0,100,0.2)"/></g>`,
                bloodMoon: `<g opacity="0.22"><circle cx="300" cy="195" r="95" fill="rgba(180,0,0,0.28)"/><circle cx="300" cy="195" r="70" fill="rgba(200,0,0,0.22)"/><circle cx="300" cy="195" r="115" fill="none" stroke="rgba(180,0,0,0.38)" stroke-width="2.5"/><circle cx="300" cy="195" r="145" fill="none" stroke="rgba(150,0,0,0.25)" stroke-width="2"/><path d="M 0 680 Q 100 642 200 680 Q 300 718 400 680 Q 500 642 600 680" fill="none" stroke="rgba(180,0,0,0.35)" stroke-width="2.5"/></g>`,
                possessed: `<g opacity="0.2"><circle cx="300" cy="340" r="70" fill="none" stroke="rgba(200,0,200,0.45)" stroke-width="2.5"/><ellipse cx="300" cy="340" rx="22" ry="38" fill="rgba(200,0,200,0.35)"/><ellipse cx="300" cy="320" rx="8" ry="12" fill="rgba(50,0,50,0.6)"/><circle cx="300" cy="340" r="130" fill="none" stroke="rgba(160,0,160,0.25)" stroke-width="1.5"/></g>`,
                darkForest: `<g opacity="0.2"><polygon points="0,800 42,568 84,800" fill="rgba(15,50,15,0.55)"/><polygon points="55,800 100,545 145,800" fill="rgba(20,60,20,0.55)"/><polygon points="120,800 172,520 224,800" fill="rgba(15,50,15,0.55)"/><polygon points="200,800 255,498 310,800" fill="rgba(20,60,20,0.5)"/><polygon points="290,800 345,498 400,800" fill="rgba(15,50,15,0.5)"/><polygon points="376,800 428,520 480,800" fill="rgba(20,60,20,0.55)"/><polygon points="455,800 500,545 545,800" fill="rgba(15,50,15,0.55)"/><polygon points="516,800 558,568 600,800" fill="rgba(20,60,20,0.55)"/></g>`,
                reaper: `<g opacity="0.2"><path d="M 300 80 L 275 195 L 232 248 L 210 358 L 232 412 L 300 434 L 368 412 L 390 358 L 368 248 L 325 195 Z" fill="none" stroke="rgba(150,150,150,0.35)" stroke-width="2.5"/><line x1="300" y1="434" x2="300" y2="720" stroke="rgba(150,150,150,0.4)" stroke-width="4"/><path d="M 300 240 Q 380 200 440 240 Q 480 270 470 340 Q 450 300 400 290 Q 350 280 300 320" fill="none" stroke="rgba(150,150,150,0.4)" stroke-width="2.5"/></g>`,
                wicked: `<g opacity="0.2"><polygon points="300,30 338,162 318,162 352,255 300,235 248,255 282,162 262,162" fill="rgba(100,0,150,0.45)"/><polygon points="120,140 155,220 140,220 165,280 120,260 75,280 100,220 85,220" fill="rgba(80,0,120,0.35)"/><polygon points="480,160 512,235 498,235 520,292 480,272 440,292 462,235 448,235" fill="rgba(80,0,120,0.35)"/></g>`,
                sinister: `<g opacity="0.2"><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(139,0,0,0.45)" stroke-width="3.5"/><line x1="0" y1="0" x2="600" y2="800" stroke="rgba(139,0,0,0.18)" stroke-width="2.5"/><line x1="600" y1="0" x2="0" y2="800" stroke="rgba(139,0,0,0.18)" stroke-width="2.5"/><polygon points="0,0 50,0 0,50" fill="rgba(139,0,0,0.3)"/><polygon points="600,0 550,0 600,50" fill="rgba(139,0,0,0.3)"/><polygon points="0,800 50,800 0,750" fill="rgba(139,0,0,0.3)"/><polygon points="600,800 550,800 600,750" fill="rgba(139,0,0,0.3)"/></g>`,
                necromancer: `<g opacity="0.2"><circle cx="300" cy="340" r="115" fill="none" stroke="rgba(100,0,200,0.35)" stroke-width="2.5"/><polygon points="300,225 388,420 212,420" fill="none" stroke="rgba(100,0,200,0.4)" stroke-width="2.5"/><circle cx="300" cy="225" r="12" fill="rgba(160,0,255,0.6)"/><line x1="300" y1="455" x2="300" y2="660" stroke="rgba(100,0,200,0.3)" stroke-width="3"/></g>`,
                witchcraft: `<g opacity="0.2"><circle cx="300" cy="370" r="135" fill="none" stroke="rgba(100,0,150,0.35)" stroke-width="2.5"/><polygon points="300,235 388,438 212,438" fill="none" stroke="rgba(180,0,180,0.4)" stroke-width="2.5"/><circle cx="300" cy="235" r="10" fill="rgba(180,0,180,0.6)"/><path d="M 240 680 Q 260 645 300 638 Q 340 645 360 680 Q 340 700 300 708 Q 260 700 240 680 Z" fill="rgba(100,0,150,0.45)"/></g>`,
                shadowRealm: `<g opacity="0.2"><polygon points="300,40 558,720 42,720" fill="none" stroke="rgba(80,0,80,0.45)" stroke-width="2.5"/><polygon points="300,130 508,700 92,700" fill="none" stroke="rgba(100,0,100,0.35)" stroke-width="2"/><circle cx="300" cy="400" r="90" fill="rgba(50,0,50,0.32)"/></g>`,
                voidWalker: `<g opacity="0.22"><circle cx="300" cy="400" r="215" fill="none" stroke="rgba(50,0,100,0.32)" stroke-width="2"/><circle cx="300" cy="400" r="175" fill="none" stroke="rgba(80,0,150,0.35)" stroke-width="2.5"/><circle cx="300" cy="400" r="135" fill="none" stroke="rgba(100,0,200,0.38)" stroke-width="2.5"/><circle cx="300" cy="400" r="95" fill="none" stroke="rgba(120,0,220,0.42)" stroke-width="2"/><circle cx="300" cy="400" r="55" fill="none" stroke="rgba(100,0,200,0.45)" stroke-width="1.5"/><circle cx="300" cy="400" r="22" fill="rgba(100,0,200,0.35)"/></g>`,
                darkSorcery: `<g opacity="0.2"><polygon points="300,65 345,198 472,198 372,275 410,408 300,330 190,408 228,275 128,198 255,198" fill="none" stroke="rgba(150,0,150,0.45)" stroke-width="2.5"/><circle cx="300" cy="236" r="90" fill="none" stroke="rgba(150,0,150,0.3)" stroke-width="2"/><circle cx="300" cy="65" r="10" fill="rgba(180,0,180,0.6)"/></g>`,
                tropicalParty: `<g opacity="0.2"><ellipse cx="70" cy="685" rx="75" ry="32" fill="rgba(0,150,80,0.35)" transform="rotate(-22 70 685)"/><ellipse cx="520" cy="668" rx="80" ry="28" fill="rgba(0,150,80,0.35)" transform="rotate(18 520 668)"/><line x1="80" y1="685" x2="65" y2="800" stroke="rgba(100,50,20,0.4)" stroke-width="4"/><line x1="510" y1="668" x2="525" y2="800" stroke="rgba(100,50,20,0.4)" stroke-width="4"/><circle cx="300" cy="180" r="80" fill="rgba(255,150,0,0.22)"/></g>`,
                candyPop: `<g opacity="0.22"><circle cx="80" cy="200" r="35" fill="rgba(255,105,180,0.35)"/><circle cx="520" cy="280" r="28" fill="rgba(255,20,147,0.35)"/><polygon points="300,55 320,118 388,118 334,156 356,219 300,181 244,219 266,156 212,118 280,118" fill="rgba(255,105,180,0.45)"/><circle cx="300" cy="400" r="160" fill="none" stroke="rgba(255,105,180,0.25)" stroke-width="2"/></g>`,
                festivalNeon: `<g opacity="0.2"><circle cx="300" cy="400" r="215" fill="none" stroke="rgba(255,0,255,0.35)" stroke-width="2.5"/><circle cx="300" cy="400" r="165" fill="none" stroke="rgba(0,255,255,0.3)" stroke-width="2"/><circle cx="300" cy="400" r="115" fill="none" stroke="rgba(255,0,255,0.3)" stroke-width="1.5"/><circle cx="300" cy="400" r="65" fill="none" stroke="rgba(0,255,255,0.3)" stroke-width="1.5"/></g>`,
                prismBurst: `<g opacity="0.22"><line x1="300" y1="400" x2="0" y2="0" stroke="rgba(255,0,0,0.3)" stroke-width="2.5"/><line x1="300" y1="400" x2="300" y2="0" stroke="rgba(255,165,0,0.3)" stroke-width="2.5"/><line x1="300" y1="400" x2="600" y2="0" stroke="rgba(255,255,0,0.3)" stroke-width="2.5"/><line x1="300" y1="400" x2="600" y2="400" stroke="rgba(0,255,0,0.3)" stroke-width="2.5"/><line x1="300" y1="400" x2="600" y2="800" stroke="rgba(0,0,255,0.3)" stroke-width="2.5"/><line x1="300" y1="400" x2="0" y2="800" stroke="rgba(148,0,211,0.3)" stroke-width="2.5"/><line x1="300" y1="400" x2="0" y2="400" stroke="rgba(255,0,255,0.3)" stroke-width="2.5"/><circle cx="300" cy="400" r="80" fill="none" stroke="rgba(255,255,255,0.3)" stroke-width="2"/></g>`,
                sunsetVibes: `<g opacity="0.2"><path d="M 0 480 Q 150 445 300 480 Q 450 515 600 480" fill="none" stroke="rgba(255,150,0,0.35)" stroke-width="2.5"/><path d="M 0 540 Q 150 508 300 540 Q 450 572 600 540" fill="none" stroke="rgba(255,100,0,0.3)" stroke-width="2.5"/><path d="M 0 600 Q 150 572 300 600 Q 450 628 600 600" fill="none" stroke="rgba(220,60,20,0.28)" stroke-width="2"/><circle cx="300" cy="195" r="90" fill="rgba(255,150,0,0.22)"/></g>`,
                cottonCandy: `<g opacity="0.2"><circle cx="150" cy="185" r="70" fill="rgba(255,153,204,0.25)"/><circle cx="200" cy="155" r="55" fill="rgba(255,180,220,0.22)"/><circle cx="460" cy="638" r="78" fill="rgba(153,204,255,0.25)"/><circle cx="510" cy="605" r="60" fill="rgba(180,220,255,0.22)"/></g>`,
                fireworks: `<g opacity="0.22"><line x1="300" y1="225" x2="300" y2="110" stroke="rgba(255,215,0,0.55)" stroke-width="2.5"/><line x1="300" y1="225" x2="392" y2="145" stroke="rgba(255,100,0,0.55)" stroke-width="2.5"/><line x1="300" y1="225" x2="408" y2="272" stroke="rgba(255,0,100,0.55)" stroke-width="2.5"/><line x1="300" y1="225" x2="208" y2="145" stroke="rgba(200,0,255,0.55)" stroke-width="2.5"/><circle cx="300" cy="225" r="20" fill="rgba(255,215,0,0.45)"/><circle cx="80" cy="580" r="14" fill="rgba(255,100,0,0.4)"/></g>`,
                discoFloor: `<g opacity="0.2"><line x1="100" y1="560" x2="100" y2="800" stroke="rgba(255,0,255,0.18)" stroke-width="1.5"/><line x1="200" y1="560" x2="200" y2="800" stroke="rgba(0,255,255,0.18)" stroke-width="1.5"/><line x1="300" y1="560" x2="300" y2="800" stroke="rgba(255,0,255,0.18)" stroke-width="1.5"/><line x1="400" y1="560" x2="400" y2="800" stroke="rgba(0,255,255,0.18)" stroke-width="1.5"/><line x1="500" y1="560" x2="500" y2="800" stroke="rgba(255,0,255,0.18)" stroke-width="1.5"/><circle cx="300" cy="280" r="110" fill="none" stroke="rgba(255,0,255,0.3)" stroke-width="2.5"/></g>`,
                graffiti: `<g opacity="0.2"><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(255,102,0,0.25)" stroke-width="4"/><polygon points="0,0 100,0 0,100" fill="rgba(255,102,0,0.25)"/><polygon points="600,0 500,0 600,100" fill="rgba(0,200,0,0.22)"/><polygon points="0,800 100,800 0,700" fill="rgba(0,200,0,0.22)"/><polygon points="600,800 500,800 600,700" fill="rgba(255,102,0,0.25)"/><circle cx="300" cy="400" r="100" fill="none" stroke="rgba(255,102,0,0.2)" stroke-width="2"/></g>`,
                rainbowRave: `<g opacity="0.2"><line x1="0" y1="90" x2="600" y2="90" stroke="rgba(255,0,0,0.3)" stroke-width="3.5"/><line x1="0" y1="180" x2="600" y2="180" stroke="rgba(255,165,0,0.3)" stroke-width="3.5"/><line x1="0" y1="270" x2="600" y2="270" stroke="rgba(255,255,0,0.25)" stroke-width="3"/><line x1="0" y1="400" x2="600" y2="400" stroke="rgba(0,255,0,0.25)" stroke-width="3"/><line x1="0" y1="530" x2="600" y2="530" stroke="rgba(0,0,255,0.25)" stroke-width="3"/><line x1="0" y1="620" x2="600" y2="620" stroke="rgba(75,0,130,0.25)" stroke-width="3"/><line x1="0" y1="710" x2="600" y2="710" stroke="rgba(148,0,211,0.25)" stroke-width="3.5"/></g>`,
                raceTrack: `<g opacity="0.2"><line x1="0" y1="385" x2="600" y2="385" stroke="rgba(255,0,0,0.25)" stroke-width="2.5"/><line x1="0" y1="400" x2="600" y2="400" stroke="rgba(255,255,255,0.35)" stroke-width="4" stroke-dasharray="35,25"/><line x1="0" y1="415" x2="600" y2="415" stroke="rgba(255,0,0,0.25)" stroke-width="2.5"/><polygon points="0,0 100,0 0,100" fill="rgba(255,0,0,0.25)"/><polygon points="600,800 500,800 600,700" fill="rgba(255,0,0,0.25)"/><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(255,200,0,0.2)" stroke-width="2"/></g>`,
                ironArena: `<g opacity="0.2"><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(192,192,192,0.4)" stroke-width="3.5"/><rect x="32" y="32" width="536" height="736" fill="none" stroke="rgba(150,150,150,0.22)" stroke-width="1.5"/><line x1="15" y1="400" x2="585" y2="400" stroke="rgba(255,69,0,0.25)" stroke-width="1.5"/><circle cx="300" cy="400" r="150" fill="none" stroke="rgba(192,192,192,0.2)" stroke-width="2"/><polygon points="0,0 55,0 0,55" fill="rgba(192,192,192,0.25)"/><polygon points="600,0 545,0 600,55" fill="rgba(192,192,192,0.25)"/><polygon points="0,800 55,800 0,745" fill="rgba(192,192,192,0.25)"/><polygon points="600,800 545,800 600,745" fill="rgba(192,192,192,0.25)"/></g>`,
                strikezone: `<g opacity="0.2"><circle cx="300" cy="400" r="200" fill="none" stroke="rgba(255,200,0,0.35)" stroke-width="3"/><circle cx="300" cy="400" r="140" fill="none" stroke="rgba(255,200,0,0.28)" stroke-width="2.5"/><circle cx="300" cy="400" r="80" fill="none" stroke="rgba(255,200,0,0.22)" stroke-width="2"/><circle cx="300" cy="400" r="30" fill="rgba(255,200,0,0.2)"/><line x1="300" y1="200" x2="300" y2="600" stroke="rgba(255,100,0,0.2)" stroke-width="1.5"/><line x1="100" y1="400" x2="500" y2="400" stroke="rgba(255,100,0,0.2)" stroke-width="1.5"/></g>`,
                cyberSports: `<g opacity="0.22"><rect x="15" y="15" width="570" height="770" fill="none" stroke="#00ffff" stroke-width="3"/><rect x="28" y="28" width="544" height="744" fill="none" stroke="rgba(0,255,255,0.3)" stroke-width="1"/><circle cx="300" cy="400" r="180" fill="none" stroke="rgba(0,255,255,0.25)" stroke-width="2"/><polygon points="300,220 480,510 120,510" fill="none" stroke="rgba(0,255,255,0.25)" stroke-width="1.5"/><line x1="300" y1="220" x2="300" y2="80" stroke="#00ffff" stroke-width="2"/><circle cx="300" cy="78" r="8" fill="#00ffff" opacity="0.6"/></g>`,
                battleRoyale: `<g opacity="0.22"><rect x="0" y="0" width="600" height="800" fill="none" stroke="rgba(255,100,0,0.4)" stroke-width="5"/><rect x="14" y="14" width="572" height="772" fill="none" stroke="rgba(200,50,0,0.25)" stroke-width="2"/><circle cx="300" cy="400" r="200" fill="none" stroke="rgba(255,100,0,0.3)" stroke-width="2" stroke-dasharray="10,20"/><circle cx="300" cy="400" r="130" fill="none" stroke="rgba(255,50,0,0.2)" stroke-width="1.5" stroke-dasharray="5,15"/><polygon points="0,0 80,0 0,80" fill="rgba(255,100,0,0.25)"/><polygon points="600,0 520,0 600,80" fill="rgba(255,100,0,0.25)"/><polygon points="0,800 80,800 0,720" fill="rgba(255,100,0,0.25)"/><polygon points="600,800 520,800 600,720" fill="rgba(255,100,0,0.25)"/></g>`,
                speedrunner: `<g opacity="0.2"><line x1="0" y1="400" x2="600" y2="400" stroke="rgba(0,255,100,0.35)" stroke-width="3"/><line x1="0" y1="390" x2="600" y2="390" stroke="rgba(0,200,80,0.2)" stroke-width="1.5"/><line x1="0" y1="410" x2="600" y2="410" stroke="rgba(0,200,80,0.2)" stroke-width="1.5"/><polygon points="0,0 150,0 0,150" fill="rgba(0,255,100,0.2)"/><circle cx="300" cy="400" r="120" fill="none" stroke="rgba(0,255,100,0.22)" stroke-width="2"/><line x1="300" y1="280" x2="300" y2="180" stroke="rgba(0,255,100,0.3)" stroke-width="2"/><circle cx="300" cy="178" r="8" fill="rgba(0,255,100,0.5)"/></g>`,
                warZone: `<g opacity="0.2"><line x1="0" y1="0" x2="600" y2="800" stroke="rgba(100,80,50,0.18)" stroke-width="2"/><line x1="600" y1="0" x2="0" y2="800" stroke="rgba(100,80,50,0.18)" stroke-width="2"/><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(100,80,50,0.35)" stroke-width="3"/><circle cx="300" cy="400" r="150" fill="none" stroke="rgba(100,80,50,0.22)" stroke-width="2" stroke-dasharray="8,16"/><line x1="300" y1="250" x2="300" y2="100" stroke="rgba(200,50,0,0.3)" stroke-width="2.5"/><circle cx="300" cy="98" r="10" fill="rgba(200,50,0,0.4)"/></g>`,
                nightRider: `<g opacity="0.2"><line x1="0" y1="460" x2="600" y2="460" stroke="rgba(255,200,0,0.25)" stroke-width="2.5"/><line x1="0" y1="480" x2="600" y2="480" stroke="rgba(255,255,255,0.3)" stroke-width="3" stroke-dasharray="30,20"/><line x1="0" y1="500" x2="600" y2="500" stroke="rgba(255,200,0,0.25)" stroke-width="2.5"/><line x1="300" y1="460" x2="0" y2="800" stroke="rgba(255,200,0,0.15)" stroke-width="2"/><line x1="300" y1="460" x2="600" y2="800" stroke="rgba(255,200,0,0.15)" stroke-width="2"/><circle cx="300" cy="240" r="70" fill="rgba(255,200,0,0.15)"/></g>`,
                epicClash: `<g opacity="0.22"><line x1="100" y1="100" x2="500" y2="700" stroke="rgba(255,100,0,0.4)" stroke-width="4"/><line x1="500" y1="100" x2="100" y2="700" stroke="rgba(0,150,255,0.4)" stroke-width="4"/><circle cx="300" cy="400" r="160" fill="none" stroke="rgba(255,200,0,0.3)" stroke-width="2.5"/><circle cx="300" cy="400" r="80" fill="none" stroke="rgba(255,100,0,0.22)" stroke-width="2"/><circle cx="300" cy="400" r="20" fill="rgba(255,200,0,0.3)"/></g>`,
                royalPurple: `<g opacity="0.2"><rect x="15" y="15" width="570" height="770" fill="none" stroke="#8b008b" stroke-width="4"/><rect x="28" y="28" width="544" height="744" fill="none" stroke="rgba(139,0,139,0.3)" stroke-width="1.5"/><polygon points="15,15 75,15 15,75" fill="rgba(139,0,139,0.3)"/><polygon points="585,15 525,15 585,75" fill="rgba(139,0,139,0.3)"/><polygon points="15,785 75,785 15,725" fill="rgba(139,0,139,0.3)"/><polygon points="585,785 525,785 585,725" fill="rgba(139,0,139,0.3)"/><circle cx="300" cy="400" r="170" fill="none" stroke="rgba(139,0,139,0.2)" stroke-width="1.5" stroke-dasharray="5,15"/><polygon points="300,55 318,112 378,112 330,147 348,204 300,169 252,204 270,147 222,112 282,112" fill="rgba(139,0,139,0.3)"/></g>`,
                midnightSilk: `<g opacity="0.18"><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(100,100,180,0.4)" stroke-width="2.5"/><line x1="0" y1="0" x2="600" y2="800" stroke="rgba(150,150,220,0.12)" stroke-width="2"/><line x1="600" y1="0" x2="0" y2="800" stroke="rgba(150,150,220,0.12)" stroke-width="2"/><circle cx="300" cy="400" r="200" fill="none" stroke="rgba(100,100,180,0.2)" stroke-width="1.5"/><circle cx="300" cy="400" r="130" fill="none" stroke="rgba(150,150,220,0.18)" stroke-width="1"/><polygon points="300,200 480,490 120,490" fill="none" stroke="rgba(100,100,180,0.18)" stroke-width="1.5"/></g>`,
                diamondDust: `<g opacity="0.2"><polygon points="300,80 355,220 510,220 385,310 430,450 300,360 170,450 215,310 90,220 245,220" fill="none" stroke="rgba(200,240,255,0.45)" stroke-width="2.5"/><circle cx="300" cy="270" r="100" fill="none" stroke="rgba(200,240,255,0.28)" stroke-width="1.5"/><circle cx="300" cy="270" r="14" fill="rgba(220,255,255,0.6)"/><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(200,240,255,0.25)" stroke-width="2"/><circle cx="80" cy="680" r="6" fill="rgba(200,240,255,0.6)"/><circle cx="520" cy="650" r="8" fill="rgba(200,240,255,0.5)"/><circle cx="150" cy="150" r="6" fill="rgba(200,240,255,0.5)"/><circle cx="450" cy="120" r="8" fill="rgba(200,240,255,0.6)"/></g>`,
                roseGold: `<g opacity="0.2"><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(183,110,121,0.45)" stroke-width="3"/><polygon points="15,15 75,15 15,75" fill="rgba(183,110,121,0.3)"/><polygon points="585,15 525,15 585,75" fill="rgba(183,110,121,0.3)"/><polygon points="15,785 75,785 15,725" fill="rgba(183,110,121,0.3)"/><polygon points="585,785 525,785 585,725" fill="rgba(183,110,121,0.3)"/><polygon points="300,55 318,112 378,112 330,147 348,204 300,169 252,204 270,147 222,112 282,112" fill="rgba(183,110,121,0.35)"/><circle cx="300" cy="400" r="170" fill="none" stroke="rgba(183,110,121,0.2)" stroke-width="1.5" stroke-dasharray="6,14"/></g>`,
                velvetNight: `<g opacity="0.18"><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(72,0,72,0.5)" stroke-width="3"/><rect x="30" y="30" width="540" height="740" fill="none" stroke="rgba(100,0,100,0.25)" stroke-width="1"/><circle cx="300" cy="400" r="200" fill="none" stroke="rgba(72,0,72,0.2)" stroke-width="2"/><circle cx="300" cy="400" r="120" fill="none" stroke="rgba(100,0,100,0.18)" stroke-width="1.5"/><polygon points="0,0 65,0 0,65" fill="rgba(72,0,72,0.35)"/><polygon points="600,0 535,0 600,65" fill="rgba(72,0,72,0.35)"/><polygon points="0,800 65,800 0,735" fill="rgba(72,0,72,0.35)"/><polygon points="600,800 535,800 600,735" fill="rgba(72,0,72,0.35)"/></g>`,
                opulence: `<g opacity="0.2"><rect x="15" y="15" width="570" height="770" fill="none" stroke="#ffd700" stroke-width="4"/><rect x="28" y="28" width="544" height="744" fill="none" stroke="rgba(255,215,0,0.3)" stroke-width="1.5"/><polygon points="300,55 318,112 378,112 330,147 348,204 300,169 252,204 270,147 222,112 282,112" fill="rgba(255,215,0,0.35)"/><circle cx="300" cy="132" r="12" fill="rgba(255,215,0,0.6)"/><polygon points="15,15 75,15 15,75" fill="rgba(255,215,0,0.3)"/><polygon points="585,15 525,15 585,75" fill="rgba(255,215,0,0.3)"/><polygon points="15,785 75,785 15,725" fill="rgba(255,215,0,0.3)"/><polygon points="585,785 525,785 585,725" fill="rgba(255,215,0,0.3)"/><circle cx="300" cy="400" r="175" fill="none" stroke="rgba(255,215,0,0.18)" stroke-width="1.5" stroke-dasharray="5,15"/></g>`,
                platinumEdge: `<g opacity="0.2"><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(180,190,200,0.5)" stroke-width="4"/><rect x="28" y="28" width="544" height="744" fill="none" stroke="rgba(160,175,185,0.28)" stroke-width="1.5"/><polygon points="15,15 80,15 15,80" fill="rgba(180,190,200,0.3)"/><polygon points="585,15 520,15 585,80" fill="rgba(180,190,200,0.3)"/><polygon points="15,785 80,785 15,720" fill="rgba(180,190,200,0.3)"/><polygon points="585,785 520,785 585,720" fill="rgba(180,190,200,0.3)"/><circle cx="300" cy="400" r="175" fill="none" stroke="rgba(180,190,200,0.18)" stroke-width="1.5" stroke-dasharray="5,15"/></g>`,
                obsidianGlow: `<g opacity="0.2"><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(40,40,60,0.8)" stroke-width="4"/><rect x="28" y="28" width="544" height="744" fill="none" stroke="rgba(100,100,160,0.3)" stroke-width="1.5"/><circle cx="300" cy="400" r="200" fill="none" stroke="rgba(100,100,200,0.22)" stroke-width="2"/><circle cx="300" cy="400" r="130" fill="none" stroke="rgba(80,80,160,0.18)" stroke-width="1.5"/><polygon points="0,0 70,0 0,70" fill="rgba(60,60,100,0.35)"/><polygon points="600,0 530,0 600,70" fill="rgba(60,60,100,0.35)"/><polygon points="0,800 70,800 0,730" fill="rgba(60,60,100,0.35)"/><polygon points="600,800 530,800 600,730" fill="rgba(60,60,100,0.35)"/></g>`,
                etherealGrace: `<g opacity="0.18"><circle cx="300" cy="400" r="220" fill="none" stroke="rgba(200,210,255,0.32)" stroke-width="2"/><circle cx="300" cy="400" r="165" fill="none" stroke="rgba(220,230,255,0.25)" stroke-width="1.5"/><circle cx="300" cy="400" r="110" fill="none" stroke="rgba(200,210,255,0.2)" stroke-width="1.5"/><polygon points="300,180 480,505 120,505" fill="none" stroke="rgba(220,230,255,0.22)" stroke-width="1.5"/><polygon points="300,620 120,295 480,295" fill="none" stroke="rgba(200,210,255,0.18)" stroke-width="1.5"/><circle cx="300" cy="180" r="8" fill="rgba(220,230,255,0.5)"/></g>`,
                christmasNeon: `<g opacity="0.22"><polygon points="300,30 340,130 316,130 360,215 326,215 374,310 226,310 274,215 240,215 284,130 260,130" fill="rgba(0,255,100,0.4)"/><rect x="278" y="310" width="44" height="38" fill="rgba(255,100,0,0.4)"/><circle cx="300" cy="50" r="13" fill="rgba(255,255,0,0.7)"/><circle cx="252" cy="148" r="9" fill="#ff1493"/><circle cx="348" cy="148" r="9" fill="#00ffff"/><circle cx="236" cy="220" r="8" fill="#ff1493"/><circle cx="364" cy="220" r="8" fill="#00ffff"/><circle cx="246" cy="290" r="8" fill="#00ffff"/><circle cx="354" cy="290" r="8" fill="#ff1493"/><rect x="0" y="0" width="600" height="800" fill="none" stroke="rgba(0,255,100,0.25)" stroke-width="3"/></g>`,
                winterWonderland: `<g opacity="0.2"><polygon points="300,50 308,78 338,78 315,94 323,122 300,106 277,122 285,94 262,78 292,78" fill="rgba(200,230,255,0.55)"/><polygon points="90,180 96,200 118,200 101,212 107,232 90,220 73,232 79,212 62,200 84,200" fill="rgba(200,230,255,0.5)"/><polygon points="510,260 516,280 538,280 521,292 527,312 510,300 493,312 499,292 482,280 504,280" fill="rgba(200,230,255,0.5)"/><polygon points="140,620 146,640 168,640 151,652 157,672 140,660 123,672 129,652 112,640 134,640" fill="rgba(180,220,255,0.5)"/><polygon points="470,650 476,670 498,670 481,682 487,702 470,690 453,702 459,682 442,670 464,670" fill="rgba(180,220,255,0.5)"/><path d="M 0 720 Q 150 698 300 720 Q 450 742 600 720 L 600 800 L 0 800 Z" fill="rgba(200,230,255,0.2)"/></g>`,
                snowStorm: `<g opacity="0.18"><circle cx="80" cy="150" r="4" fill="rgba(200,230,255,0.7)"/><circle cx="200" cy="80" r="3" fill="rgba(200,230,255,0.6)"/><circle cx="350" cy="120" r="5" fill="rgba(200,230,255,0.7)"/><circle cx="480" cy="60" r="3" fill="rgba(200,230,255,0.6)"/><circle cx="560" cy="180" r="4" fill="rgba(200,230,255,0.65)"/><circle cx="130" cy="350" r="5" fill="rgba(200,230,255,0.65)"/><circle cx="420" cy="300" r="3" fill="rgba(200,230,255,0.6)"/><circle cx="520" cy="450" r="4" fill="rgba(200,230,255,0.7)"/><circle cx="60" cy="550" r="3" fill="rgba(200,230,255,0.6)"/><circle cx="270" cy="600" r="5" fill="rgba(200,230,255,0.65)"/><circle cx="460" cy="700" r="4" fill="rgba(200,230,255,0.6)"/><circle cx="180" cy="720" r="3" fill="rgba(200,230,255,0.65)"/><line x1="0" y1="180" x2="600" y2="250" stroke="rgba(200,230,255,0.15)" stroke-width="2.5"/><line x1="0" y1="380" x2="600" y2="420" stroke="rgba(200,230,255,0.12)" stroke-width="2"/></g>`,
                newYearGold: `<g opacity="0.22"><line x1="300" y1="220" x2="300" y2="80" stroke="rgba(255,215,0,0.6)" stroke-width="3.5"/><line x1="300" y1="220" x2="408" y2="138" stroke="rgba(255,200,0,0.55)" stroke-width="3"/><line x1="300" y1="220" x2="430" y2="268" stroke="rgba(255,180,0,0.55)" stroke-width="3"/><line x1="300" y1="220" x2="392" y2="362" stroke="rgba(255,215,0,0.55)" stroke-width="3"/><line x1="300" y1="220" x2="192" y2="138" stroke="rgba(255,215,0,0.55)" stroke-width="3"/><line x1="300" y1="220" x2="170" y2="268" stroke="rgba(255,200,0,0.55)" stroke-width="3"/><line x1="300" y1="220" x2="208" y2="362" stroke="rgba(255,180,0,0.55)" stroke-width="3"/><circle cx="300" cy="220" r="30" fill="rgba(255,215,0,0.4)"/><circle cx="300" cy="220" r="14" fill="rgba(255,240,100,0.6)"/><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(255,215,0,0.2)" stroke-width="2"/></g>`,
                valentinesDark: `<g opacity="0.22"><path d="M 300 430 C 300 430 170 352 170 262 C 170 220 205 190 252 190 C 276 190 300 210 300 210 C 300 210 324 190 348 190 C 395 190 430 220 430 262 C 430 352 300 430 300 430 Z" fill="rgba(180,0,60,0.45)"/><path d="M 145 620 C 145 620 92 590 92 557 C 92 538 107 524 125 524 C 136 524 145 532 145 532 C 145 532 154 524 165 524 C 183 524 198 538 198 557 C 198 590 145 620 145 620 Z" fill="rgba(150,0,50,0.35)"/><path d="M 455 600 C 455 600 402 570 402 537 C 402 518 417 504 435 504 C 446 504 455 512 455 512 C 455 512 464 504 475 504 C 493 504 508 518 508 537 C 508 570 455 600 455 600 Z" fill="rgba(180,0,60,0.35)"/><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(180,0,60,0.25)" stroke-width="2"/></g>`,
                easter: `<g opacity="0.22"><ellipse cx="300" cy="390" rx="90" ry="115" fill="none" stroke="rgba(255,150,200,0.4)" stroke-width="2.5"/><line x1="210" y1="390" x2="390" y2="390" stroke="rgba(100,200,255,0.35)" stroke-width="2"/><path d="M 280 280 Q 300 310 320 280" fill="none" stroke="rgba(255,200,0,0.4)" stroke-width="2"/><ellipse cx="120" cy="560" rx="55" ry="70" fill="none" stroke="rgba(100,255,100,0.4)" stroke-width="2"/><ellipse cx="480" cy="540" rx="55" ry="70" fill="none" stroke="rgba(255,200,100,0.4)" stroke-width="2"/><circle cx="80" cy="200" r="20" fill="rgba(255,200,255,0.2)"/><circle cx="520" cy="250" r="16" fill="rgba(200,255,200,0.2)"/><circle cx="300" cy="150" r="15" fill="rgba(255,255,150,0.25)"/></g>`,
                independenceDay: `<g opacity="0.22"><line x1="300" y1="220" x2="300" y2="80" stroke="rgba(255,50,50,0.6)" stroke-width="3"/><line x1="300" y1="220" x2="430" y2="143" stroke="rgba(255,255,255,0.55)" stroke-width="2.5"/><line x1="300" y1="220" x2="430" y2="297" stroke="rgba(50,50,255,0.55)" stroke-width="2.5"/><line x1="300" y1="220" x2="170" y2="143" stroke="rgba(255,255,255,0.55)" stroke-width="2.5"/><line x1="300" y1="220" x2="170" y2="297" stroke="rgba(50,50,255,0.55)" stroke-width="2.5"/><line x1="300" y1="220" x2="300" y2="360" stroke="rgba(255,50,50,0.55)" stroke-width="3"/><circle cx="300" cy="220" r="22" fill="rgba(255,50,50,0.3)"/><circle cx="300" cy="220" r="12" fill="rgba(255,255,255,0.4)"/><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(50,50,200,0.2)" stroke-width="2"/><polygon points="0,0 60,0 0,60" fill="rgba(255,50,50,0.2)"/><polygon points="600,0 540,0 600,60" fill="rgba(50,50,255,0.2)"/></g>`,
                thanksgiving: `<g opacity="0.2"><ellipse cx="70" cy="670" rx="60" ry="28" fill="rgba(200,120,30,0.35)" transform="rotate(-18 70 670)"/><ellipse cx="150" cy="635" rx="55" ry="24" fill="rgba(180,100,20,0.3)" transform="rotate(12 150 635)"/><ellipse cx="500" cy="660" rx="62" ry="26" fill="rgba(200,120,30,0.35)" transform="rotate(16 500 660)"/><ellipse cx="420" cy="620" rx="52" ry="22" fill="rgba(180,100,20,0.3)" transform="rotate(-10 420 620)"/><circle cx="300" cy="320" r="110" fill="none" stroke="rgba(200,120,30,0.28)" stroke-width="2.5"/><polygon points="300,210 318,267 378,267 330,302 348,359 300,324 252,359 270,302 222,267 282,267" fill="rgba(200,120,30,0.35)"/><circle cx="300" cy="240" r="11" fill="rgba(255,180,0,0.6)"/></g>`,
                kwanzaa: `<g opacity="0.22"><line x1="300" y1="640" x2="300" y2="510" stroke="rgba(0,0,0,0.5)" stroke-width="7"/><line x1="248" y1="640" x2="248" y2="560" stroke="rgba(200,0,0,0.5)" stroke-width="5"/><line x1="196" y1="640" x2="196" y2="596" stroke="rgba(200,0,0,0.45)" stroke-width="5"/><line x1="352" y1="640" x2="352" y2="560" stroke="rgba(0,150,0,0.5)" stroke-width="5"/><line x1="404" y1="640" x2="404" y2="596" stroke="rgba(0,150,0,0.45)" stroke-width="5"/><line x1="152" y1="640" x2="152" y2="614" stroke="rgba(200,0,0,0.4)" stroke-width="4.5"/><line x1="448" y1="640" x2="448" y2="614" stroke="rgba(0,150,0,0.4)" stroke-width="4.5"/><line x1="110" y1="640" x2="490" y2="640" stroke="rgba(0,0,0,0.5)" stroke-width="6"/><circle cx="300" cy="505" r="9" fill="rgba(255,215,0,0.65)"/><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(200,0,0,0.2)" stroke-width="2"/></g>`,
                springBloom: `<g opacity="0.2"><circle cx="300" cy="330" r="30" fill="rgba(255,200,100,0.35)"/><path d="M 300 300 Q 280 265 260 280 Q 275 300 300 300 Z" fill="rgba(255,150,200,0.4)"/><path d="M 300 300 Q 265 288 260 310 Q 282 318 300 300 Z" fill="rgba(255,180,220,0.4)"/><path d="M 300 300 Q 268 320 272 344 Q 293 342 300 300 Z" fill="rgba(255,150,200,0.4)"/><path d="M 300 300 Q 300 335 322 344 Q 330 323 300 300 Z" fill="rgba(255,180,220,0.4)"/><path d="M 300 300 Q 335 318 340 310 Q 336 289 300 300 Z" fill="rgba(255,150,200,0.4)"/><path d="M 300 300 Q 336 288 320 268 Q 304 272 300 300 Z" fill="rgba(255,180,220,0.4)"/><circle cx="100" cy="580" r="18" fill="rgba(255,150,200,0.3)"/><circle cx="500" cy="620" r="16" fill="rgba(200,255,200,0.3)"/><circle cx="80" cy="200" r="14" fill="rgba(255,200,255,0.3)"/></g>`,
                blossom: `<g opacity="0.2"><circle cx="300" cy="300" r="24" fill="rgba(255,200,220,0.4)"/><path d="M 300 276 Q 282 252 264 268 Q 272 290 300 276 Z" fill="rgba(255,180,210,0.45)"/><path d="M 300 276 Q 276 274 268 296 Q 288 305 300 276 Z" fill="rgba(255,200,225,0.45)"/><path d="M 300 276 Q 278 298 286 318 Q 305 314 300 276 Z" fill="rgba(255,180,210,0.45)"/><path d="M 300 276 Q 316 316 335 310 Q 338 291 300 276 Z" fill="rgba(255,200,225,0.45)"/><path d="M 300 276 Q 326 278 330 256 Q 315 245 300 276 Z" fill="rgba(255,180,210,0.45)"/><circle cx="150" cy="550" r="18" fill="rgba(255,180,210,0.35)"/><circle cx="460" cy="580" r="20" fill="rgba(255,200,225,0.35)"/><circle cx="480" cy="200" r="16" fill="rgba(255,180,210,0.3)"/></g>`,
                aurora: `<g opacity="0.2"><path d="M 0 280 Q 150 220 300 270 Q 450 320 600 260" fill="none" stroke="rgba(0,255,150,0.35)" stroke-width="4"/><path d="M 0 340 Q 150 285 300 335 Q 450 385 600 325" fill="none" stroke="rgba(100,150,255,0.3)" stroke-width="5"/><path d="M 0 400 Q 150 350 300 400 Q 450 450 600 390" fill="none" stroke="rgba(200,50,255,0.25)" stroke-width="4"/><path d="M 0 460 Q 150 415 300 462 Q 450 509 600 450" fill="none" stroke="rgba(0,255,200,0.22)" stroke-width="3.5"/><circle cx="100" cy="150" r="4" fill="white"/><circle cx="300" cy="120" r="3" fill="white"/><circle cx="500" cy="160" r="4" fill="white"/></g>`,
                meadow: `<g opacity="0.2"><path d="M 0 700 Q 100 680 200 700 Q 300 720 400 700 Q 500 680 600 700 L 600 800 L 0 800 Z" fill="rgba(80,160,50,0.22)"/><polygon points="40,700 55,580 70,700" fill="rgba(60,140,40,0.4)"/><polygon points="90,700 102,600 115,700" fill="rgba(80,160,50,0.4)"/><polygon points="150,700 165,570 180,700" fill="rgba(60,140,40,0.4)"/><polygon points="320,700 335,575 350,700" fill="rgba(80,160,50,0.4)"/><polygon points="440,700 455,590 470,700" fill="rgba(60,140,40,0.4)"/><polygon points="520,700 535,580 550,700" fill="rgba(80,160,50,0.4)"/><circle cx="200" cy="300" r="50" fill="rgba(255,220,100,0.2)"/><circle cx="400" cy="280" r="40" fill="rgba(200,255,180,0.2)"/></g>`,

            };

            const defaultDeco = `<g opacity="0.1"><rect x="20" y="20" width="560" height="760" fill="none" stroke="rgba(255,255,255,0.3)" stroke-width="2"/><polygon points="20,20 70,20 20,70" fill="rgba(255,255,255,0.1)"/><polygon points="580,20 530,20 580,70" fill="rgba(255,255,255,0.1)"/><polygon points="20,780 70,780 20,730" fill="rgba(255,255,255,0.1)"/><polygon points="580,780 530,780 580,730" fill="rgba(255,255,255,0.1)"/></g>`;

            svg.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${W} ${H}" style="position:absolute;top:0;left:0;width:100%;height:100%;">${decorations[preset] || defaultDeco}</svg>`;
        }

        function loadCustomFont(fontUrl, id) {
            const existing = document.querySelector(`link[data-font-id="${id}"]`);
            if (existing) existing.remove();
            
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = fontUrl;
            link.setAttribute('data-font-id', id);
            document.head.appendChild(link);
        }

        function extractFontFamily(fontUrl) {
            const match = fontUrl.match(/family=([^:&]+)/);
            return match ? match[1].replace(/\+/g, ' ') : null;
        }

        async function generateAIBackground() {
            const theme = document.getElementById('theme').value.trim();
            
            if (!theme) {
                showStatus('Please enter a theme first!', 'error');
                return;
            }

            const generateBtn = document.getElementById('generateBtn');
            const btnText = document.getElementById('generateBtnText');
            
            // Disable button and show loading
            generateBtn.disabled = true;
            btnText.innerHTML = '<span class="loading-spinner"></span> Generating...';
            showStatus('AI is creating your custom flyer design...', 'info');

            try {
                const response = await fetch('http://localhost:3000/api/anthropic/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        model: 'claude-sonnet-4-20250514',
                        max_tokens: 3000,
                        messages: [{
                            role: 'user',
                            content: `<g opacity="0.18"><rect x="15" y="15" width="570" height="770" fill="none" stroke="rgba(150,150,200,0.3)" stroke-width="2"/><circle cx="300" cy="400" r="180" fill="none" stroke="rgba(150,150,200,0.2)" stroke-width="1.5"/><line x1="300" y1="220" x2="300" y2="80" stroke="rgba(150,150,200,0.25)" stroke-width="1.5"/><line x1="480" y1="400" x2="580" y2="400" stroke="rgba(150,150,200,0.2)" stroke-width="1.5"/></g>`
                        }]
                    })
                });

                if (!response.ok) {
                    throw new Error(`API request failed: ${response.status}`);
                }

                const data = await response.json();
                console.log('API Response:', data);
                
                if (!data.content || !data.content[0] || !data.content[0].text) {
                    throw new Error('Invalid API response structure');
                }
                
                let responseText = data.content[0].text.trim();
                console.log('Response text:', responseText);
                
                // Clean up JSON - remove markdown code blocks
                responseText = responseText.replace(/```json\n?/g, '').replace(/```\n?/g, '').trim();
                
                // Try to extract JSON if there's extra text
                const jsonMatch = responseText.match(/\{[\s\S]*\}/);
                if (jsonMatch) {
                    responseText = jsonMatch[0];
                }
                
                console.log('Cleaned response:', responseText);
                
                let design;
                try {
                    design = JSON.parse(responseText);
                } catch (parseError) {
                    console.error('JSON Parse Error:', parseError);
                    console.error('Failed to parse:', responseText);
                    throw new Error('Failed to parse AI response as JSON');
                }
                
                console.log('Parsed design:', design);
                
                // Update title
                if (design.title) {
                    document.getElementById('title').value = design.title;
                    document.getElementById('preview-title').textContent = design.title;
                }
                
                // Load custom font
                if (design.titleFont) {
                    const existingFontLinks = document.querySelectorAll('link[data-custom-font]');
                    existingFontLinks.forEach(link => link.remove());
                    
                    const fontLink = document.createElement('link');
                    fontLink.rel = 'stylesheet';
                    fontLink.href = design.titleFont;
                    fontLink.setAttribute('data-custom-font', 'true');
                    document.head.appendChild(fontLink);
                    
                    const fontMatch = design.titleFont.match(/family=([^:&]+)/);
                    if (fontMatch) {
                        const fontFamily = fontMatch[1].replace(/\+/g, ' ');
                        document.getElementById('preview-title').style.fontFamily = `'${fontFamily}', sans-serif`;
                    }
                }
                
                // Apply title color
                if (design.titleColor) {
                    const titleElement = document.getElementById('preview-title');
                    
                    if (design.titleColor.includes('gradient')) {
                        titleElement.style.background = design.titleColor;
                        titleElement.style.webkitBackgroundClip = 'text';
                        titleElement.style.webkitTextFillColor = 'transparent';
                        titleElement.style.backgroundClip = 'text';
                    } else {
                        titleElement.style.color = design.titleColor;
                    }
                }
                
                // Load date font
                if (design.dateFont) {
                    const dateFontLink = document.querySelector('link[data-date-font]');
                    if (dateFontLink) dateFontLink.remove();
                    
                    const fontLink = document.createElement('link');
                    fontLink.rel = 'stylesheet';
                    fontLink.href = design.dateFont;
                    fontLink.setAttribute('data-date-font', 'true');
                    document.head.appendChild(fontLink);
                    
                    const fontMatch = design.dateFont.match(/family=([^:&]+)/);
                    if (fontMatch) {
                        const fontFamily = fontMatch[1].replace(/\+/g, ' ');
                        document.getElementById('preview-date').style.fontFamily = `'${fontFamily}', sans-serif`;
                    }
                }
                
                // Apply date color
                if (design.dateColor) {
                    document.getElementById('preview-date').style.color = design.dateColor;
                }
                
                // Apply date box styling
                const dateBox = document.querySelector('.flyer-datetime');
                if (dateBox) {
                    if (design.dateBackground) {
                        dateBox.style.background = design.dateBackground;
                    }
                    if (design.dateBorder) {
                        dateBox.style.border = design.dateBorder;
                    }
                }
                
                // Apply text color
                if (design.textColor) {
                    let style = document.getElementById('custom-text-colors');
                    if (!style) {
                        style = document.createElement('style');
                        style.id = 'custom-text-colors';
                        document.head.appendChild(style);
                    }
                    
                    style.textContent = `
                        .streamer-name { color: ${design.textColor} !important; }
                        .streamer-time { color: ${design.textColor} !important; opacity: 0.8; }
                    `;
                }
                
                // Apply flyer styling
                const flyer = document.getElementById('flyer');
                
                if (design.flyerBackground) {
                    flyer.style.background = design.flyerBackground;
                }
                
                if (design.flyerBoxShadow) {
                    flyer.style.boxShadow = design.flyerBoxShadow;
                }
                
                currentBackground = design;
                showStatus('‚ú® Flyer design generated successfully!', 'success');
                
                // Force repaint
                flyer.offsetHeight;
                
            } catch (error) {
                console.error('Full error:', error);
                showStatus('Failed to generate design: ' + error.message, 'error');
            } finally {
                generateBtn.disabled = false;
                btnText.textContent = '‚ú® Generate AI Design';
            }
        }

        function showStatus(message, type) {
            const statusDiv = document.getElementById('aiStatus');
            statusDiv.className = `status-message ${type}`;
            statusDiv.textContent = message;
            
            if (type === 'success') {
                setTimeout(() => {
                    statusDiv.textContent = '';
                    statusDiv.className = '';
                }, 5000);
            }
        }

        function addStreamer() {
            try {
                // Safety: limit to 50 streamers (generous limit to prevent performance issues)
                if (streamers.length >= 50) {
                    alert('Maximum 50 streamers reached. Remove some to add more.');
                    return;
                }
                
                streamerCount++;
                const streamerId = `streamer-${streamerCount}`;
                
                const streamerDiv = document.createElement('div');
                streamerDiv.className = 'streamer-entry';
                streamerDiv.id = streamerId;
                streamerDiv.innerHTML = `
                <div class="form-group">
                    <label>Twitch Username</label>
                    <input type="text" class="streamer-username" placeholder="Enter username (e.g., ninja, pokimane)" oninput="fetchTwitchProfile(this, '${streamerId}')">
                </div>
                <div class="image-upload-group">
                    <label style="margin-bottom: 8px; font-weight: 700; color: #9146ff;">üì∏ Profile Picture</label>
                    <img class="image-preview" id="${streamerId}-preview" alt="Profile preview">
                    <div style="background: #e8f5e9; padding: 12px; border-radius: 8px; margin: 10px 0; border-left: 4px solid #10b981;">
                        <div style="font-size: 0.85em; color: #333;">
                            ‚ú® <strong>Auto-fetch enabled!</strong><br>
                            Profile pictures load automatically from Twitch API
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" placeholder="Or paste custom image URL" class="image-url-input" style="flex: 1;" onchange="loadImageFromUrl(this, '${streamerId}')">
                        <label for="${streamerId}-file-upload" style="padding: 8px 12px; background: #9146ff; color: white; border-radius: 6px; cursor: pointer; font-size: 0.85em; white-space: nowrap;">
                            üìÅ Upload
                        </label>
                        <input type="file" id="${streamerId}-file-upload" accept="image/*" style="display: none;" onchange="handleImageUpload(event, '${streamerId}')">
                    </div>
                </div>
                <div class="form-group">
                    <label>Display Name</label>
                    <input type="text" class="streamer-name" placeholder="Auto-filled from Twitch">
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
                    <div class="form-group" style="margin:0;">
                        <label>Start Time</label>
                        <input type="time" class="streamer-time">
                    </div>
                    <div class="form-group" style="margin:0;">
                        <label>End Time <span style="color:#888;font-size:0.85em;">(optional)</span></label>
                        <input type="time" class="streamer-endtime">
                    </div>
                </div>
                <div class="streamer-controls">
                    <button class="remove-btn" onclick="removeStreamer('${streamerId}')">Remove</button>
                </div>
            `;

            document.getElementById('streamers-list').appendChild(streamerDiv);
            
            // Add input listeners
            streamerDiv.querySelectorAll('input').forEach(input => {
                input.addEventListener('input', updatePreview);
                input.addEventListener('change', updatePreview);
            });
            
            streamers.push({ id: streamerId, imageUrl: null });
            updatePreview();
            refreshFeaturedDropdown();
            
            // Update button badge
            var badge = document.getElementById('streamer-count-badge');
            if (badge) badge.textContent = streamers.length >= 50 ? ' (max)' : (' (' + streamers.length + '/50)');
            
            // Scroll new streamer into view
            var list = document.getElementById('streamers-list');
            if (list && list.lastElementChild) {
                list.lastElementChild.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        } catch (error) {
            console.error('Error adding streamer:', error);
            alert('Could not add streamer. Please refresh the page and try again.\n\nError: ' + error.message);
        }
    }

        // Convert an external image URL to a base64 data URL so html2canvas
        // can render it without CORS issues when hosted on Netlify
        async function imageUrlToBase64(url) {
            // Skip if already a data URL
            if (url.startsWith('data:')) return url;
            try {
                // Try canvas approach first
                const img = new Image();
                img.crossOrigin = 'anonymous';
                await new Promise((resolve, reject) => {
                    img.onload = resolve;
                    img.onerror = reject;
                    img.src = url + (url.includes('?') ? '&' : '?') + '_cb=' + Date.now();
                    setTimeout(reject, 5000);
                });
                const canvas = document.createElement('canvas');
                canvas.width = img.naturalWidth || 300;
                canvas.height = img.naturalHeight || 300;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0);
                return canvas.toDataURL('image/png');
            } catch(e) {
                // Canvas CORS blocked ‚Äî try fetching through allorigins proxy as blob
                try {
                    const proxyUrl = `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;
                    const resp = await fetch(proxyUrl, { signal: (function(){ var ctrl = new AbortController(); setTimeout(function(){ ctrl.abort(); }, 5000); return ctrl.signal; })() });
                    if (!resp.ok) return null;
                    const blob = await resp.blob();
                    return await new Promise((resolve) => {
                        const reader = new FileReader();
                        reader.onload = () => resolve(reader.result);
                        reader.onerror = () => resolve(null);
                        reader.readAsDataURL(blob);
                    });
                } catch(e2) {
                    return null; // Give up, use original URL
                }
            }
        }

        // Move tryLoadImage outside so it's not re-declared inside arrow fn
        // Convert external image to base64 so html2canvas works cross-origin
        async function tryLoadImage(url, timeoutMs) {
            timeoutMs = timeoutMs || 6000;
            if (!url) return null;
            return new Promise(function(resolve) {
                var img = new Image();
                img.crossOrigin = 'anonymous';
                var timer = setTimeout(function() { img.src = ''; resolve(null); }, timeoutMs);
                img.onload = function() {
                    clearTimeout(timer);
                    try {
                        var c = document.createElement('canvas');
                        c.width  = img.naturalWidth  || 300;
                        c.height = img.naturalHeight || 300;
                        c.getContext('2d').drawImage(img, 0, 0);
                        resolve(c.toDataURL('image/png'));
                    } catch(e) { resolve(url); }
                };
                img.onerror = function() { clearTimeout(timer); resolve(null); };
                img.src = url;
            });
        }

        function fetchTwitchProfile(input, streamerId) {
            var username = input.value.trim();
            var streamer   = streamers.find(function(s){ return s.id === streamerId; });
            var previewImg = document.getElementById(streamerId + '-preview');
            var nameInput  = document.getElementById(streamerId).querySelector('.streamer-name');

            if (!username) {
                streamer.imageUrl = null;
                previewImg.classList.remove('show');
                updatePreview();
                return;
            }

            if (input.timeout) clearTimeout(input.timeout);

            if (!nameInput.value) {
                nameInput.value = username;
                updatePreview();
            }

            input.timeout = setTimeout(async function() {
                var existingStatus = input.parentElement.querySelector('.loading-status');
                if (existingStatus) existingStatus.remove();
                var statusText = document.createElement('small');
                statusText.style.color    = '#9146ff';
                statusText.style.fontSize = '0.85em';
                statusText.textContent    = '\u23f3 Fetching from Twitch...';
                statusText.className      = 'loading-status';
                input.parentElement.appendChild(statusText);

                var imageUrl    = null;
                var displayName = username;

                // Source 1: localhost dev server (works when running locally)
                try {
                    var r1 = await fetch('http://localhost:3000/api/twitch/user/' + username,
                        { signal: (function(){ var ctrl = new AbortController(); setTimeout(function(){ ctrl.abort(); }, 1500); return ctrl.signal; })() });
                    if (r1.ok) {
                        var d = await r1.json();
                        displayName = d.display_name || username;
                        imageUrl = await tryLoadImage(d.profile_image_url);
                    }
                } catch(e) { /* not local */ }

                // Source 2: Twitch public GQL API (same client-id their website uses)
                // No OAuth needed ‚Äî works from any domain
                if (!imageUrl) {
                    try {
                        console.log('[Twitch Fetch] Trying GQL API for:', username);
                        var gqlBody = JSON.stringify([{
                            operationName: 'GetUserByLogin',
                            variables: { login: username },
                            extensions: {
                                persistedQuery: {
                                    version: 1,
                                    sha256Hash: 'fd923b6f3a62b1a9226f87b8c0b3b42e808b9eb0b6b7e49b9d18a24d31bb0c9d'
                                }
                            }
                        }]);
                        var gqlRes = await fetch('https://gql.twitch.tv/gql', {
                            method: 'POST',
                            headers: {
                                'Client-ID': 'kimne78kx3ncx6brgo4mv6wki5h1ko',
                                'Content-Type': 'application/json'
                            },
                            body: gqlBody,
                            signal: (function(){ var ctrl = new AbortController(); setTimeout(function(){ ctrl.abort(); }, 5000); return ctrl.signal; })()
                        });
                        if (gqlRes.ok) {
                            var gqlData = await gqlRes.json();
                            console.log('[Twitch Fetch] GQL Response:', gqlData);
                            var user = gqlData && gqlData[0] && gqlData[0].data && gqlData[0].data.user;
                            if (user && user.profileImageURL) {
                                displayName = user.displayName || username;
                                imageUrl = await tryLoadImage(user.profileImageURL);
                                console.log('[Twitch Fetch] Got image from GQL:', imageUrl ? 'success' : 'failed');
                            }
                        } else {
                            console.log('[Twitch Fetch] GQL failed:', gqlRes.status);
                        }
                    } catch(e) { 
                        console.log('[Twitch Fetch] GQL error:', e.message);
                    }
                }

                // Source 3: Twitch GQL with simpler inline query (fallback query format)
                if (!imageUrl) {
                    try {
                        var gqlBody2 = JSON.stringify({
                            query: 'query { user(login: "' + username.replace(/"/g,'') + '") { displayName profileImageURL(width: 300) } }'
                        });
                        var gqlRes2 = await fetch('https://gql.twitch.tv/gql', {
                            method: 'POST',
                            headers: {
                                'Client-ID': 'kimne78kx3ncx6brgo4mv6wki5h1ko',
                                'Content-Type': 'application/json'
                            },
                            body: gqlBody2,
                            signal: (function(){ var ctrl = new AbortController(); setTimeout(function(){ ctrl.abort(); }, 5000); return ctrl.signal; })()
                        });
                        if (gqlRes2.ok) {
                            var gqlData2 = await gqlRes2.json();
                            var user2 = gqlData2 && gqlData2.data && gqlData2.data.user;
                            if (user2 && user2.profileImageURL) {
                                displayName = user2.displayName || username;
                                imageUrl = await tryLoadImage(user2.profileImageURL);
                            }
                        }
                    } catch(e) { /* skip */ }
                }

                // Source 4: wsrv.nl proxying the Twitch avatar CDN URL pattern
                // Twitch stores avatars at a predictable CDN path
                if (!imageUrl) {
                    try {
                        var proxyUrl = 'https://wsrv.nl/?url=' +
                            encodeURIComponent('https://static-cdn.jtvnw.net/user-default-pictures-uv/75305d54-c7cc-40d1-bb9c-91fbe85943c7-profile_image-300x300.png');
                        // Try fetching via corsproxy to get the real avatar URL from Twitch page
                        var cpRes = await fetch(
                            'https://corsproxy.io/?' + encodeURIComponent('https://www.twitch.tv/' + username),
                            { signal: (function(){ var ctrl = new AbortController(); setTimeout(function(){ ctrl.abort(); }, 7000); return ctrl.signal; })() }
                        );
                        if (cpRes.ok) {
                            var pageText = await cpRes.text();
                            var avatarMatch = pageText.match(/"profileImageURL":"([^"]+)"/);
                            if (!avatarMatch) avatarMatch = pageText.match(/"profile_image_url":"([^"]+)"/);
                            if (avatarMatch) {
                                var rawUrl = avatarMatch[1].replace(/\\u002F/g, '/');
                                var wsrvUrl = 'https://wsrv.nl/?url=' + encodeURIComponent(rawUrl) + '&w=300&h=300';
                                imageUrl = await tryLoadImage(wsrvUrl, 6000);
                                if (!imageUrl) imageUrl = await tryLoadImage(rawUrl, 4000);
                            }
                        }
                    } catch(e) { /* skip */ }
                }

                if (imageUrl) {
                    streamer.imageUrl = imageUrl;
                    previewImg.src    = imageUrl;
                    previewImg.classList.add('show');
                    if (!nameInput.value || nameInput.value === username) {
                        nameInput.value = displayName;
                    }
                    statusText.textContent = '\u2705 Loaded from Twitch!';
                    statusText.style.color = '#10b981';
                    updatePreview();
                } else {
                    console.log('[Twitch Fetch] All methods failed for:', username);
                    statusText.textContent = '\u26a0\ufe0f Could not auto-load. Upload image below or paste URL.';
                    statusText.style.color = '#f59e0b';
                    // Still try the old fetch method as last resort
                    fetchTwitchImage(username, streamerId);
                }

                setTimeout(function() {
                    if (statusText.parentElement) statusText.remove();
                }, 3000);

            }, 500);
        }
        function loadImageFromUrl(input, streamerId) {
            const url = input.value.trim();
            if (!url) return;
            
            const streamer = streamers.find(s => s.id === streamerId);
            const previewImg = document.getElementById(`${streamerId}-preview`);
            
            // Just set it directly - let the browser handle CORS
            streamer.imageUrl = url;
            previewImg.src = url;
            previewImg.classList.add('show');
            
            previewImg.onerror = function() {
                alert('Failed to load image from URL. Make sure the URL is correct and publicly accessible.');
                previewImg.classList.remove('show');
            };
            
            updatePreview();
        }

        async function fetchTwitchImage(username, streamerId) {
            const streamer = streamers.find(s => s.id === streamerId);
            const previewImg = document.getElementById(`${streamerId}-preview`);
            
            // Create a more colorful fallback avatar
            const colors = [
                { bg: '#9146ff', text: '#ffffff' }, // Twitch purple
                { bg: '#ff6b6b', text: '#ffffff' }, // Red
                { bg: '#4ecdc4', text: '#ffffff' }, // Teal
                { bg: '#f39c12', text: '#ffffff' }, // Orange
                { bg: '#3498db', text: '#ffffff' }, // Blue
                { bg: '#e74c3c', text: '#ffffff' }, // Bright red
                { bg: '#1abc9c', text: '#ffffff' }, // Turquoise
                { bg: '#9b59b6', text: '#ffffff' }, // Purple
            ];
            
            // Pick a color based on username
            const colorIndex = username.charCodeAt(0) % colors.length;
            const color = colors[colorIndex];
            
            const initial = username.charAt(0).toUpperCase();
            const fallback = `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='${encodeURIComponent(color.bg)}'/%3E%3Ctext x='50' y='50' font-family='Arial, sans-serif' font-size='45' font-weight='bold' text-anchor='middle' dy='.35em' fill='${encodeURIComponent(color.text)}'%3E${initial}%3C/text%3E%3C/svg%3E`;
            
            streamer.imageUrl = fallback;
            previewImg.src = fallback;
            previewImg.classList.add('show');
            updatePreview();
        }

        function handleImageUpload(event, streamerId) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const streamer = streamers.find(s => s.id === streamerId);
                    streamer.imageUrl = e.target.result;
                    
                    const previewImg = document.getElementById(`${streamerId}-preview`);
                    previewImg.src = e.target.result;
                    previewImg.classList.add('show');
                    
                    updatePreview();
                };
                reader.readAsDataURL(file);
            }
        }

        function removeStreamer(streamerId) {
            document.getElementById(streamerId).remove();
            const index = streamers.findIndex(s => s.id === streamerId);
            if (index > -1) {
                streamers.splice(index, 1);
            }
            // Update button badge
            var badge = document.getElementById('streamer-count-badge');
            if (badge) badge.textContent = streamers.length >= 50 ? ' (max)' : (streamers.length ? ' (' + streamers.length + '/50)' : '');
            updatePreview();
            refreshFeaturedDropdown();
        }

        // Track manually positioned cards
        let streamerPositions = {}; // key = streamer index, value = {x, y, manual: bool}
        let draggedCard = null;
        let cardOffsetX = 0, cardOffsetY = 0;
        let selectedCard = null;

        function updatePreview() {
            document.getElementById('preview-title').textContent =
                document.getElementById('title').value || 'Your Event Title';

            const dateValue = document.getElementById('date').value;
            if (dateValue) {
                const date = new Date(dateValue + 'T00:00:00');
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                document.getElementById('preview-date').textContent =
                    date.toLocaleDateString('en-US', options);
            }

            // Remove old cards before measuring header
            const flyer = document.getElementById('flyer');
            flyer.querySelectorAll('.streamer-card').forEach(c => c.remove());

            const streamerEntries = document.querySelectorAll('.streamer-entry');
            const validStreamers = [];
            streamerEntries.forEach((entry, index) => {
                const name = entry.querySelector('.streamer-name').value;
                const time = entry.querySelector('.streamer-time').value;
                const endtime = (entry.querySelector('.streamer-endtime') || {}).value || '';
                const streamer = streamers[index];
                if (name || time) validStreamers.push({ name, time, endtime, streamer, index });
            });

            if (validStreamers.length === 0) return;

            const count = validStreamers.length;
            const s = getScale(count);

            // Calculate usable start Y: bottom of whichever of title/date sits lower
            const flyerEl  = document.getElementById('flyer');
            const titleEl2 = document.getElementById('preview-title');
            const dateEl2  = document.getElementById('preview-datetime');
            var topOffset = 200; // safe default
            if (titleEl2 && dateEl2) {
                const titleBottom = (titleEl2.offsetTop || 30) + (titleEl2.offsetHeight || 60);
                const dateBottom  = (dateEl2.offsetTop  || 130) + (dateEl2.offsetHeight || 60);
                topOffset = Math.max(titleBottom, dateBottom) + 24;
            } else if (titleEl2) {
                topOffset = (titleEl2.offsetTop || 30) + (titleEl2.offsetHeight || 60) + 24;
            }
            const flyerH = currentOrientation === 'landscape' ? 600 : 800;
            const flyerW = currentOrientation === 'landscape' ? 800 : 600;
            const usableH = flyerH - topOffset - 20;
            const spacing = usableH / count;

            validStreamers.forEach(({ name, time, endtime, streamer, index }, i) => {
                const card = document.createElement('div');
                card.className = 'streamer-card';
                card.dataset.streamerIndex = index;

                // Format time display: if endtime present, show "START - END", else just "START"
                var formattedTime = 'Time TBD';
                if (time) {
                    formattedTime = formatTime(time);
                    if (endtime) {
                        formattedTime += ' - ' + formatTime(endtime);
                    }
                }
                card.innerHTML = `
                    ${streamer && streamer.imageUrl ?
                        `<img src="${streamer.imageUrl}" class="streamer-avatar" alt="${name}" crossorigin="anonymous" style="width:${s.avatar}px;height:${s.avatar}px;">` :
                        `<div class="streamer-avatar" style="width:${s.avatar}px;height:${s.avatar}px;"></div>`}
                    <div class="streamer-info">
                        <div class="streamer-name" style="font-size:${s.name}em;">${name || 'Streamer'}</div>
                        <div class="streamer-time" style="font-size:${s.time}em;">${formattedTime}</div>
                    </div>
                `;

                // Use saved manual position or default evenly-spaced layout
                if (streamerPositions[index] && streamerPositions[index].manual) {
                    card.style.left = streamerPositions[index].x + 'px';
                    card.style.top  = streamerPositions[index].y + 'px';
                } else {
                    const defaultX = 30;
                    const defaultY = topOffset + Math.round(i * spacing + spacing * 0.15);
                    card.style.left = defaultX + 'px';
                    card.style.top  = defaultY + 'px';
                    streamerPositions[index] = { x: defaultX, y: defaultY, manual: false };
                }

                // Pointer-based drag
                card.addEventListener('pointerdown', function(e) {
                    if (e.button !== 0) return;
                    e.preventDefault();
                    e.stopPropagation();
                    selectCard(card);
                    draggedCard = card;
                    card.classList.add('dragging-card');
                    card.setPointerCapture(e.pointerId);
                    const flyerRect = document.getElementById('flyer').getBoundingClientRect();
                    const cardRect = card.getBoundingClientRect();
                    cardOffsetX = e.clientX - cardRect.left;
                    cardOffsetY = e.clientY - cardRect.top;
                    card.addEventListener('pointermove', onCardDrag);
                    card.addEventListener('pointerup', onCardDrop);
                    card.addEventListener('pointercancel', onCardDrop);
                });

                // Cards go directly on the flyer (not inside flyer-content)
                flyer.appendChild(card);
            });
            
            // Apply avatar border settings to all newly created avatars
            updateAvatarBorders();

            // Re-apply featured streamer styling after cards rebuild
            refreshFeaturedDropdown();
            if (featuredConfig.enabled && featuredConfig.selectedIds && featuredConfig.selectedIds.length) {
                document.querySelectorAll('.streamer-card').forEach(function(card) {
                    var posIdx = parseInt(card.dataset.streamerIndex);
                    var sid = getStreamerIdByIndex(posIdx);
                    applyCardFeaturedStyle(card, sid && featuredConfig.selectedIds.indexOf(sid) !== -1, sid);
                });
            }
            // Rebuild grid overlay if visible
            refreshGridIfVisible();
        }

        function selectCard(card) {
            document.querySelectorAll('.streamer-card').forEach(c => c.classList.remove('selected-card'));
            card.classList.add('selected-card');
            selectedCard = card;
        }

        function onCardDrag(e) {
            e.preventDefault();
            const flyerRect = document.getElementById('flyer').getBoundingClientRect();
            let newX = e.clientX - flyerRect.left - cardOffsetX;
            let newY = e.clientY - flyerRect.top  - cardOffsetY;
            newX = Math.max(0, Math.min(newX, flyerRect.width  - draggedCard.offsetWidth));
            newY = Math.max(0, Math.min(newY, flyerRect.height - draggedCard.offsetHeight));
            var snapped = updateGuides(newX, newY, draggedCard.offsetWidth, draggedCard.offsetHeight);
            newX = snapped.x; newY = snapped.y;
            draggedCard.style.left = newX + 'px';
            draggedCard.style.top  = newY + 'px';
            const idx = parseInt(draggedCard.dataset.streamerIndex);
            streamerPositions[idx] = { x: newX, y: newY, manual: true };
        }

        function onCardDrop(e) {
            if (!draggedCard) return;
            hideAllGuides();
            // Apply snap-to-grid on drop
            if (snapToGridEnabled) {
                var left = parseInt(draggedCard.style.left) || 0;
                var top  = parseInt(draggedCard.style.top) || 0;
                var snappedX = snapValue(left);
                var snappedY = snapValue(top);
                draggedCard.style.left = snappedX + 'px';
                draggedCard.style.top  = snappedY + 'px';
                const idx = parseInt(draggedCard.dataset.streamerIndex);
                streamerPositions[idx] = { x: snappedX, y: snappedY, manual: true };
            }
            refreshGridIfVisible();
            draggedCard.classList.remove('dragging-card');
            draggedCard.removeEventListener('pointermove', onCardDrag);
            draggedCard.removeEventListener('pointerup', onCardDrop);
            draggedCard.removeEventListener('pointercancel', onCardDrop);
            draggedCard = null;
        }

        // ‚îÄ‚îÄ FEATURED STREAMER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // ‚îÄ‚îÄ FEATURED STREAMER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // KEY DESIGN: overrides and selectedIds use the STABLE streamer DOM id (e.g. "streamer-3")
        // NOT positional index ‚Äî adding/removing streamers never corrupts saved overrides.
        var featuredConfig = {
            enabled:false, selectedIds:[], nameColor:'#ffd700', timeColor:'#ffffff',
            nameScale:1.4, avatarScale:1.4, bgStyle:'gold-gradient', bgColor:'#7c3aed',
            bgOpacity:70, label:'‚≠ê FEATURED', labelColor:'#ffd700', borderColor:'#ffd700'
        };
        var featuredOverrides = {}; // key = stable DOM id like "streamer-3"

        // Map positional card data-streamerIndex -> stable streamer entry DOM id
        function getStreamerIdByIndex(idx) {
            var entries = document.querySelectorAll('.streamer-entry');
            return entries[idx] ? entries[idx].id : null;
        }

        function getFeaturedBg(style,color,opacity) {
            var a=opacity/100;
            if(style==='gold-gradient') return 'linear-gradient(135deg,rgba(180,120,0,0.75),rgba(255,215,0,0.55))';
            if(style==='purple-glow')   return 'linear-gradient(135deg,rgba(88,28,135,0.80),rgba(145,70,255,0.60))';
            if(style==='fire')          return 'linear-gradient(135deg,rgba(180,40,0,0.80),rgba(255,120,0,0.60))';
            if(style==='ice')           return 'linear-gradient(135deg,rgba(0,80,160,0.75),rgba(100,200,255,0.55))';
            if(style==='neon-green')    return 'linear-gradient(135deg,rgba(0,100,40,0.80),rgba(0,255,120,0.50))';
            if(style==='rose')          return 'linear-gradient(135deg,rgba(160,0,80,0.80),rgba(255,100,160,0.55))';
            if(style==='custom'){var r=parseInt(color.slice(1,3),16),g=parseInt(color.slice(3,5),16),b=parseInt(color.slice(5,7),16);return 'rgba('+r+','+g+','+b+','+a+')';}
            return 'transparent';
        }
        function getFeaturedGlow(style,custom) {
            var m={'gold-gradient':{color:'#ffd700',shadow:'rgba(255,215,0,0.6)'},'purple-glow':{color:'#9146ff',shadow:'rgba(145,70,255,0.7)'},'fire':{color:'#ff7800',shadow:'rgba(255,120,0,0.7)'},'ice':{color:'#64c8ff',shadow:'rgba(100,200,255,0.7)'},'neon-green':{color:'#00ff78',shadow:'rgba(0,255,120,0.7)'},'rose':{color:'#ff64a0',shadow:'rgba(255,100,160,0.7)'},'custom':{color:custom,shadow:custom+'aa'}};
            return m[style]||{color:'transparent',shadow:'transparent'};
        }
        function getEffectiveConfig(sid) {
            var ov=featuredOverrides[sid]||{};
            return {
                nameColor:  ov.nameColor  ||featuredConfig.nameColor,
                timeColor:  ov.timeColor  ||featuredConfig.timeColor,
                nameScale:  featuredConfig.nameScale,
                avatarScale:featuredConfig.avatarScale,
                bgStyle:    ov.bgStyle    ||featuredConfig.bgStyle,
                bgColor:    ov.bgColor    ||featuredConfig.bgColor,
                bgOpacity:  ov.bgOpacity  !==undefined?ov.bgOpacity:featuredConfig.bgOpacity,
                label:      ov.label      !==undefined?ov.label:featuredConfig.label,
                labelColor: ov.labelColor ||featuredConfig.labelColor,
                borderColor:ov.borderColor||featuredConfig.borderColor
            };
        }

        function refreshFeaturedDropdown() {
            var list=document.getElementById('featuredCheckList');
            if(!list) return;
            var entries=document.querySelectorAll('.streamer-entry');
            if(entries.length===0){list.innerHTML='<div style="color:#888;font-size:12px;padding:4px;">Add streamers above first</div>';return;}
            var scrollTop=list.scrollTop;
            list.innerHTML='';
            entries.forEach(function(entry){
                var i=entry.id; // stable DOM id e.g. "streamer-3"
                var name=(entry.querySelector('.streamer-name')||{}).value||'';
                var user=(entry.querySelector('.streamer-username')||{}).value||'';
                var label=name||user||i;
                var ov=featuredOverrides[i]||{};
                var isChecked=featuredConfig.selectedIds.indexOf(i)!==-1;
                var bgStyleOptions=['gold-gradient','purple-glow','fire','ice','neon-green','rose','custom','none'];
                var bgStyleLabels=['‚ú® Gold','üíú Purple','üî• Fire','‚ùÑÔ∏è Ice','üíö Neon','üå∏ Rose','üé® Custom','None'];
                var bgOpts=bgStyleOptions.map(function(v,j){return '<option value="'+v+'"'+(ov.bgStyle===v?' selected':'')+'>'+bgStyleLabels[j]+'</option>';}).join('');
                var item=document.createElement('div');
                item.id='feat-item-'+i;
                item.style.cssText='border-radius:6px;margin-bottom:4px;overflow:hidden;border:1px solid '+(isChecked?'rgba(255,180,0,0.4)':'rgba(255,255,255,0.05)')+';';
                var hdr=document.createElement('div');
                hdr.style.cssText='display:flex;align-items:center;gap:6px;padding:6px 8px;background:'+(isChecked?'rgba(255,180,0,0.12)':'rgba(0,0,0,0.15)')+';';
                hdr.innerHTML='<input type="checkbox" data-sid="'+i+'" '+(isChecked?'checked':'')+' style="width:14px;height:14px;cursor:pointer;" onchange="onFeaturedCheckChange(\''+i+'\',this.checked)">'+
                    '<span style="flex:1;font-size:12px;color:#ddd;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">'+label+'</span>'+
                    '<button onclick="toggleFeaturedExpand(\''+i+'\')" style="padding:2px 7px;font-size:10px;background:rgba(255,180,0,0.3);color:#ffd700;border:none;border-radius:4px;cursor:pointer;">‚úèÔ∏è</button>';
                item.appendChild(hdr);
                var panel=document.createElement('div');
                panel.id='feat-panel-'+i;
                panel.style.cssText='display:'+(ov._expanded?'block':'none')+';padding:8px;background:rgba(0,0,0,0.2);';
                var safeLabel=(ov.label!==undefined?ov.label:'').replace(/"/g,'&quot;');
                panel.innerHTML=
                    '<div style="font-size:10px;color:#d97706;font-weight:700;margin-bottom:6px;">OVERRIDE: '+label+'</div>'+
                    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:5px;margin-bottom:5px;">'+
                        '<div><label style="font-size:10px;color:#aaa;display:block;">Label Text</label>'+
                            '<input type="text" id="fo-label-'+i+'" value="'+safeLabel+'" placeholder="Use default" '+
                            'oninput="setFeaturedOverride(\''+i+'\',\'label\',this.value)" style="width:100%;box-sizing:border-box;padding:3px 5px;font-size:11px;"></div>'+
                        '<div><label style="font-size:10px;color:#aaa;display:block;">Label Color</label>'+
                            '<input type="color" id="fo-labelColor-'+i+'" value="'+(ov.labelColor||'#ffd700')+'" '+
                            'oninput="setFeaturedOverride(\''+i+'\',\'labelColor\',this.value)" style="width:100%;height:26px;border-radius:4px;border:none;cursor:pointer;"></div>'+
                    '</div>'+
                    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:5px;margin-bottom:5px;">'+
                        '<div><label style="font-size:10px;color:#aaa;display:block;">Name Color</label>'+
                            '<input type="color" id="fo-nameColor-'+i+'" value="'+(ov.nameColor||'#ffd700')+'" '+
                            'oninput="setFeaturedOverride(\''+i+'\',\'nameColor\',this.value)" style="width:100%;height:26px;border-radius:4px;border:none;cursor:pointer;"></div>'+
                        '<div><label style="font-size:10px;color:#aaa;display:block;">Time Color</label>'+
                            '<input type="color" id="fo-timeColor-'+i+'" value="'+(ov.timeColor||'#ffffff')+'" '+
                            'oninput="setFeaturedOverride(\''+i+'\',\'timeColor\',this.value)" style="width:100%;height:26px;border-radius:4px;border:none;cursor:pointer;"></div>'+
                    '</div>'+
                    '<div style="margin-bottom:5px;"><label style="font-size:10px;color:#aaa;display:block;">Background</label>'+
                        '<select id="fo-bgStyle-'+i+'" onchange="setFeaturedOverride(\''+i+'\',\'bgStyle\',this.value)" style="width:100%;font-size:11px;">'+
                        '<option value="">Use default</option>'+bgOpts+'</select></div>'+
                    '<div id="fo-customRow-'+i+'" style="display:'+(ov.bgStyle==='custom'?'grid':'none')+';grid-template-columns:1fr 1fr;gap:5px;margin-bottom:5px;">'+
                        '<div><label style="font-size:10px;color:#aaa;display:block;">BG Color</label>'+
                            '<input type="color" id="fo-bgColor-'+i+'" value="'+(ov.bgColor||'#7c3aed')+'" '+
                            'oninput="setFeaturedOverride(\''+i+'\',\'bgColor\',this.value)" style="width:100%;height:26px;border-radius:4px;border:none;cursor:pointer;"></div>'+
                        '<div><label style="font-size:10px;color:#aaa;display:block;">Opacity <span id="fo-bgOpVal-'+i+'">'+(ov.bgOpacity!==undefined?ov.bgOpacity:70)+'%</span></label>'+
                            '<input type="range" id="fo-bgOpacity-'+i+'" min="10" max="100" value="'+(ov.bgOpacity!==undefined?ov.bgOpacity:70)+'" '+
                            'oninput="document.getElementById(\'fo-bgOpVal-'+i+'\').textContent=this.value+\'%\';setFeaturedOverride(\''+i+'\',\'bgOpacity\',parseInt(this.value))" style="width:100%;"></div>'+
                    '</div>'+
                    '<div style="margin-bottom:5px;"><label style="font-size:10px;color:#aaa;display:block;">Border Color</label>'+
                        '<input type="color" id="fo-borderColor-'+i+'" value="'+(ov.borderColor||'#ffd700')+'" '+
                        'oninput="setFeaturedOverride(\''+i+'\',\'borderColor\',this.value)" style="width:100%;height:26px;border-radius:4px;border:none;cursor:pointer;"></div>'+
                    '<button onclick="clearFeaturedOverride(\''+i+'\')" style="width:100%;font-size:10px;padding:3px;background:rgba(239,68,68,0.3);color:#fca5a5;border:1px solid rgba(239,68,68,0.3);border-radius:4px;cursor:pointer;">‚Ü© Reset to defaults</button>';
                item.appendChild(panel);
                list.appendChild(item);
            });
            list.scrollTop=scrollTop;
        }

        function toggleFeaturedExpand(sid) {
            var panel=document.getElementById('feat-panel-'+sid);
            if(!panel) return;
            var ov=featuredOverrides[sid]||{};
            var opening=panel.style.display==='none';
            panel.style.display=opening?'block':'none';
            ov._expanded=opening;
            featuredOverrides[sid]=ov;
        }
        function setFeaturedOverride(sid,key,val) {
            var ov=featuredOverrides[sid]||{};
            ov[key]=val;
            featuredOverrides[sid]=ov;
            if(key==='bgStyle'){var row=document.getElementById('fo-customRow-'+sid);if(row)row.style.display=val==='custom'?'grid':'none';}
            applyFeaturedStreamer();
        }
        function clearFeaturedOverride(sid) {
            var exp=(featuredOverrides[sid]||{})._expanded;
            featuredOverrides[sid]=exp?{_expanded:true}:{};
            refreshFeaturedDropdown();
            applyFeaturedStreamer();
        }
        function onFeaturedCheckChange(sid,isChecked) {
            if(isChecked){if(featuredConfig.selectedIds.indexOf(sid)===-1)featuredConfig.selectedIds.push(sid);}
            else{featuredConfig.selectedIds=featuredConfig.selectedIds.filter(function(s){return s!==sid;});}
            var item=document.getElementById('feat-item-'+sid);
            if(item){item.style.borderColor=isChecked?'rgba(255,180,0,0.4)':'rgba(255,255,255,0.05)';var h=item.firstChild;if(h)h.style.background=isChecked?'rgba(255,180,0,0.12)':'rgba(0,0,0,0.15)';}
            applyFeaturedStreamer();
        }
        function applyFeaturedStreamer() {
            var enabled=document.getElementById('featuredEnabled').checked;
            featuredConfig.enabled=enabled;
            featuredConfig.nameColor=document.getElementById('featuredNameColor').value;
            featuredConfig.timeColor=document.getElementById('featuredTimeColor').value;
            featuredConfig.nameScale=parseFloat(document.getElementById('featuredNameScale').value);
            featuredConfig.avatarScale=parseFloat(document.getElementById('featuredAvatarScale').value);
            featuredConfig.bgStyle=document.getElementById('featuredBgStyle').value;
            featuredConfig.bgColor=document.getElementById('featuredBgColor').value;
            featuredConfig.bgOpacity=parseInt(document.getElementById('featuredBgOpacity').value);
            featuredConfig.label=document.getElementById('featuredLabel').value;
            featuredConfig.borderColor=document.getElementById('featuredBorderColor').value;
            document.getElementById('featuredCustomBgRow').style.display=featuredConfig.bgStyle==='custom'?'':'none';
            document.querySelectorAll('.streamer-card').forEach(function(card){
                var posIdx=parseInt(card.dataset.streamerIndex);
                var sid=getStreamerIdByIndex(posIdx);
                var isFeatured=enabled&&sid&&featuredConfig.selectedIds.indexOf(sid)!==-1;
                applyCardFeaturedStyle(card,isFeatured,sid);
            });
        }
        function applyCardFeaturedStyle(card,isFeatured,sid) {
            var nameEl=card.querySelector('.streamer-name'),timeEl=card.querySelector('.streamer-time'),
                avatarEl=card.querySelector('.streamer-avatar'),labelEl=card.querySelector('.featured-label');
            if(isFeatured&&sid){
                var cfg=getEffectiveConfig(sid);
                var bg=getFeaturedBg(cfg.bgStyle,cfg.bgColor,cfg.bgOpacity);
                var glow=getFeaturedGlow(cfg.bgStyle,cfg.borderColor);
                var bc=cfg.borderColor||glow.color;
                card.classList.add('featured-card');card.style.background=bg;card.style.borderColor=bc;
                card.style.borderWidth='2px';card.style.borderStyle='solid';
                card.style.boxShadow='0 0 18px '+glow.shadow+', inset 0 0 12px rgba(255,255,255,0.05)';
                if(nameEl){var bn=parseFloat(nameEl.dataset.baseFontSize)||parseFloat(nameEl.style.fontSize)||1.0;if(!nameEl.dataset.baseFontSize)nameEl.dataset.baseFontSize=bn;nameEl.style.fontSize=(bn*cfg.nameScale)+'em';nameEl.style.color=cfg.nameColor;nameEl.style.fontWeight='900';nameEl.style.textShadow='0 0 10px '+cfg.nameColor+'99';}
                if(timeEl){timeEl.style.color=cfg.timeColor;timeEl.style.fontWeight='700';}
                if(avatarEl){var ba=parseInt(avatarEl.dataset.baseAvatarSize)||parseInt(avatarEl.style.width)||60;if(!avatarEl.dataset.baseAvatarSize)avatarEl.dataset.baseAvatarSize=ba;avatarEl.style.width=Math.round(ba*cfg.avatarScale)+'px';avatarEl.style.height=Math.round(ba*cfg.avatarScale)+'px';avatarEl.style.borderColor=bc;avatarEl.style.borderWidth='4px';}
                if(!labelEl){labelEl=document.createElement('div');labelEl.className='featured-label';labelEl.style.cssText='position:absolute;top:-16px;left:8px;font-size:10px;font-weight:800;letter-spacing:1px;padding:2px 8px;border-radius:20px;white-space:nowrap;z-index:6;';card.appendChild(labelEl);}
                labelEl.textContent=cfg.label;labelEl.style.color=cfg.labelColor;labelEl.style.background=bc;labelEl.style.display=cfg.label?'':'none';
            } else {
                card.classList.remove('featured-card');card.style.background='transparent';card.style.borderColor='transparent';card.style.borderWidth='2px';card.style.borderStyle='solid';card.style.boxShadow='';
                if(nameEl){var bn2=parseFloat(nameEl.dataset.baseFontSize)||parseFloat(nameEl.style.fontSize)||1.0;nameEl.style.fontSize=bn2+'em';nameEl.style.color='';nameEl.style.fontWeight='';nameEl.style.textShadow='';}
                if(timeEl){timeEl.style.color='';timeEl.style.fontWeight='';}
                if(avatarEl){var ba2=parseInt(avatarEl.dataset.baseAvatarSize)||parseInt(avatarEl.style.width)||60;avatarEl.style.width=ba2+'px';avatarEl.style.height=ba2+'px';}
                if(labelEl)labelEl.remove();
            }
        }
        // ‚îÄ‚îÄ FEATURED STREAMER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

        // ‚îÄ‚îÄ FEATURED STREAMER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

        function getScale(count) {
            const scales = {
                1:{avatar:90,name:1.8,time:1.4}, 2:{avatar:80,name:1.6,time:1.3},
                3:{avatar:72,name:1.5,time:1.2}, 4:{avatar:66,name:1.4,time:1.1},
                5:{avatar:60,name:1.3,time:1.0}, 6:{avatar:54,name:1.2,time:0.95},
                7:{avatar:50,name:1.1,time:0.88}, 8:{avatar:46,name:1.0,time:0.82},
                9:{avatar:42,name:0.95,time:0.78}, 10:{avatar:38,name:0.88,time:0.74},
                11:{avatar:36,name:0.83,time:0.70}, 12:{avatar:34,name:0.78,time:0.66},
                13:{avatar:32,name:0.74,time:0.62}, 14:{avatar:30,name:0.70,time:0.60},
                15:{avatar:28,name:0.67,time:0.57}, 16:{avatar:26,name:0.64,time:0.54},
                17:{avatar:25,name:0.61,time:0.52}, 18:{avatar:24,name:0.59,time:0.50},
                19:{avatar:23,name:0.57,time:0.48}, 20:{avatar:22,name:0.55,time:0.46},
            };
            return scales[Math.min(count, 20)] || scales[20];
        }

        // Reset card positions when streamers change count significantly
        function resetCardPositions() {
            streamerPositions = {};
            updatePreview();
        }

        function updateAvatarBorders() {
            var enabled = document.getElementById('avatarBorderEnabled').checked;
            var color = document.getElementById('avatarBorderColor').value;
            var width = document.getElementById('avatarBorderWidth').value;
            
            document.querySelectorAll('.streamer-avatar').forEach(function(avatar) {
                if (enabled) {
                    avatar.style.borderColor = color;
                    avatar.style.borderWidth = width + 'px';
                    avatar.style.borderStyle = 'solid';
                } else {
                    avatar.style.borderWidth = '0px';
                    avatar.style.borderStyle = 'none';
                }
            });
        }

        function formatTime(time) {
            const [hours, minutes] = time.split(':');
            const hour = parseInt(hours);
            const ampm = hour >= 12 ? 'PM' : 'AM';
            const displayHour = hour % 12 || 12;
            return `${displayHour}:${minutes} ${ampm}`;
        }

        // Deselect card/image when clicking flyer background
        document.getElementById('flyer').addEventListener('pointerdown', function(e) {
            if (e.target === this || e.target.id === 'flyer-decoration' || e.target.tagName === 'svg' || e.target.tagName === 'g') {
                document.querySelectorAll('.streamer-card').forEach(c => c.classList.remove('selected-card'));
                selectedCard = null;
                deselectAllImages();
            }
        });

        let customImages = [];
        let imageIdCounter = 0;
        let selectedImageId = null;
        let isDragging = false;
        let currentDragImage = null;
        let offsetX = 0;
        let offsetY = 0;

        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const imageId = `image-${imageIdCounter++}`;
                const imageData = {
                    id: imageId,
                    data: e.target.result,
                    x: 250,
                    y: 250,
                    width: 200,
                    height: 200,
                    opacity: 0.5
                };
                
                customImages.push(imageData);
                createImageElement(imageData);
                selectImage(imageId);
                updateImagesList();
                showStatus('‚úÖ Image uploaded! Click and drag to move.', 'success');
            };
            reader.readAsDataURL(file);
            
            event.target.value = '';
        }

        function createImageElement(imageData) {
            const flyer = document.getElementById('flyer');
            const overlay = document.createElement('div');
            overlay.id = imageData.id;
            overlay.className = 'custom-image-overlay';
            overlay.style.backgroundImage = `url(${imageData.data})`;
            overlay.style.left = `${imageData.x}px`;
            overlay.style.top = `${imageData.y}px`;
            overlay.style.width = `${imageData.width}px`;
            overlay.style.height = `${imageData.height}px`;
            overlay.style.opacity = imageData.opacity;
            
            // Store element reference for save/restore
            imageData.el = overlay;
            
            // Use pointer events for reliable drag across all browsers
            overlay.addEventListener('pointerdown', function(e) {
                e.preventDefault();
                e.stopPropagation();
                startDrag(e, imageData.id);
            });

            overlay.addEventListener('click', function(e) {
                selectImage(imageData.id);
            });
            
            flyer.insertBefore(overlay, document.querySelector('.flyer-content'));
        }

        function selectImage(imageId) {
            document.querySelectorAll('.custom-image-overlay').forEach(img => {
                img.classList.remove('selected');
            });
            
            const overlay = document.getElementById(imageId);
            if (overlay) {
                overlay.classList.add('selected');
                selectedImageId = imageId;
                
                const imageData = customImages.find(img => img.id === imageId);
                if (imageData) {
                    document.getElementById('imageSize').value = imageData.width;
                    document.getElementById('imageSizeValue').textContent = `${imageData.width}px`;
                    document.getElementById('imageOpacity').value = Math.round(imageData.opacity * 100);
                    document.getElementById('imageOpacityValue').textContent = `${Math.round(imageData.opacity * 100)}%`;
                    document.getElementById('selectedImageControls').style.display = 'block';
                }
            }
        }

        function startDrag(e, imageId) {
            selectImage(imageId);
            isDragging = true;
            currentDragImage = document.getElementById(imageId);
            currentDragImage.classList.add('dragging');
            currentDragImage.setPointerCapture(e.pointerId);
            
            const rect = currentDragImage.getBoundingClientRect();
            offsetX = e.clientX - rect.left;
            offsetY = e.clientY - rect.top;
            
            currentDragImage.addEventListener('pointermove', dragImage);
            currentDragImage.addEventListener('pointerup', stopDrag);
            currentDragImage.addEventListener('pointercancel', stopDrag);
        }

        function dragImage(e) {
            if (!isDragging || !currentDragImage) return;
            e.preventDefault();
            
            const flyerRect = document.getElementById('flyer').getBoundingClientRect();
            
            let newX = e.clientX - flyerRect.left - offsetX;
            let newY = e.clientY - flyerRect.top - offsetY;
            
            // Keep within flyer bounds
            newX = Math.max(0, Math.min(newX, flyerRect.width - currentDragImage.offsetWidth));
            newY = Math.max(0, Math.min(newY, flyerRect.height - currentDragImage.offsetHeight));

            var snapped = updateGuides(newX, newY, currentDragImage.offsetWidth, currentDragImage.offsetHeight);
            newX = snapped.x; newY = snapped.y;
            
            currentDragImage.style.left = newX + 'px';
            currentDragImage.style.top = newY + 'px';
            
            const imageData = customImages.find(img => img.id === currentDragImage.id);
            if (imageData) {
                imageData.x = newX;
                imageData.y = newY;
            }
        }

        function stopDrag(e) {
            if (!currentDragImage) return;
            hideAllGuides();
            // Apply snap-to-grid on drop
            if (snapToGridEnabled) {
                var left = parseInt(currentDragImage.style.left) || 0;
                var top  = parseInt(currentDragImage.style.top) || 0;
                var snappedX = snapValue(left);
                var snappedY = snapValue(top);
                currentDragImage.style.left = snappedX + 'px';
                currentDragImage.style.top  = snappedY + 'px';
                const imageData = customImages.find(img => img.id === currentDragImage.id);
                if (imageData) {
                    imageData.x = snappedX;
                    imageData.y = snappedY;
                }
            }
            refreshGridIfVisible();
            currentDragImage.classList.remove('dragging');
            currentDragImage.removeEventListener('pointermove', dragImage);
            currentDragImage.removeEventListener('pointerup', stopDrag);
            currentDragImage.removeEventListener('pointercancel', stopDrag);
            isDragging = false;
            currentDragImage = null;
        }

        function updateSelectedImageSize(value) {
            if (!selectedImageId) return;
            
            const overlay = document.getElementById(selectedImageId);
            const imageData = customImages.find(img => img.id === selectedImageId);
            if (!overlay || !imageData) return;
            
            const size = parseInt(value);
            imageData.width = size;
            imageData.height = size;
            overlay.style.width = `${size}px`;
            overlay.style.height = `${size}px`;
            document.getElementById('imageSizeValue').textContent = `${size}px`;
        }

        function updateSelectedImageOpacity(value) {
            if (!selectedImageId) return;
            
            const overlay = document.getElementById(selectedImageId);
            const imageData = customImages.find(img => img.id === selectedImageId);
            if (!overlay || !imageData) return;
            
            const opacity = value / 100;
            imageData.opacity = opacity;
            overlay.style.opacity = opacity;
            document.getElementById('imageOpacityValue').textContent = `${value}%`;
        }

        function deleteSelectedImage() {
            if (!selectedImageId) return;
            removeImage(selectedImageId);
            selectedImageId = null;
            document.getElementById('selectedImageControls').style.display = 'none';
        }

        function removeImage(imageId) {
            const overlay = document.getElementById(imageId);
            if (overlay) overlay.remove();
            
            customImages = customImages.filter(img => img.id !== imageId);
            updateImagesList();
            
            if (imageId === selectedImageId) {
                selectedImageId = null;
                document.getElementById('selectedImageControls').style.display = 'none';
            }
            
            showStatus('üóëÔ∏è Image removed', 'success');
        }

        function deselectAllImages() {
            document.querySelectorAll('.custom-image-overlay').forEach(img => {
                img.classList.remove('selected');
            });
            selectedImageId = null;
            document.getElementById('selectedImageControls').style.display = 'none';
            updateImagesList();
        }

        function removeAllImages() {
            customImages.forEach(img => {
                const overlay = document.getElementById(img.id);
                if (overlay) overlay.remove();
            });
            customImages = [];
            selectedImageId = null;
            document.getElementById('selectedImageControls').style.display = 'none';
            updateImagesList();
            showStatus('üóëÔ∏è All images removed', 'success');
        }

        function updateImagesList() {
            const list = document.getElementById('imagesList');
            if (customImages.length === 0) {
                list.innerHTML = '<small style="color: #999;">No images added yet</small>';
                return;
            }
            
            list.innerHTML = customImages.map((img, index) => `
                <div style="padding: 8px; background: ${img.id === selectedImageId ? 'rgba(145,70,255,0.2)' : 'rgba(255,255,255,0.05)'}; margin-bottom: 5px; border-radius: 5px; font-size: 0.9em; cursor: pointer; border: 1px solid ${img.id === selectedImageId ? '#9146ff' : 'transparent'};" onclick="selectImage('${img.id}')">
                    <span>üì∑ Image ${index + 1}</span>
                    <button onclick="event.stopPropagation(); removeImage('${img.id}')" style="float: right; background: #ef4444; padding: 2px 8px; border: none; border-radius: 3px; color: white; cursor: pointer; font-size: 0.85em;">‚úï</button>
                </div>
            `).join('');
        }

        // ‚îÄ‚îÄ ALIGNMENT GUIDES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        var SNAP = 8; // px threshold to snap/show guide

        // ‚îÄ‚îÄ GRID / SPACING OVERLAY ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        var gridVisible = false;

        function toggleGridOverlay() {
            gridVisible = !gridVisible;
            var btn = document.getElementById('btn-grid');
            if (gridVisible) {
                btn.style.background = '#9146ff';
                btn.style.color = '#fff';
                buildGridOverlay();
            } else {
                btn.style.background = 'transparent';
                btn.style.color = '#9146ff';
                clearGridOverlay();
            }
        }

        function clearGridOverlay() {
            var gridEl = document.getElementById('flyer-grid');
            if (gridEl) { gridEl.innerHTML = ''; gridEl.style.display = 'none'; }
        }

        function buildGridOverlay() {
            var gridEl = document.getElementById('flyer-grid');
            var flyer  = document.getElementById('flyer');
            var flyerW = flyer.offsetWidth  || (currentOrientation==='landscape'?800:600);
            var flyerH = flyer.offsetHeight || (currentOrientation==='landscape'?600:800);
            gridEl.innerHTML = '';
            gridEl.style.display = 'block';

            var STEP = 50, MAJOR = 100, RULER = 20;

            // ‚îÄ‚îÄ Ruler bars ‚îÄ‚îÄ
            var rh = document.createElement('div'); rh.className='grid-ruler-h'; gridEl.appendChild(rh);
            var rv = document.createElement('div'); rv.className='grid-ruler-v'; gridEl.appendChild(rv);

            // Horizontal ruler ticks (X axis)
            for (var x = 0; x <= flyerW; x += STEP) {
                var isMaj = x % MAJOR === 0;
                // tick line on ruler
                var tk = document.createElement('div'); tk.className='grid-ruler-tick';
                tk.style.cssText = 'left:'+(x-0.5)+'px;top:'+(isMaj?8:12)+'px;width:1px;height:'+(isMaj?12:8)+'px;background:rgba(255,255,255,'+(isMaj?'0.7':'0.35')+');';
                rh.appendChild(tk);
                // label
                if (isMaj && x > 0) {
                    var lbl = document.createElement('div'); lbl.className='grid-ruler-tick';
                    lbl.style.cssText='left:'+(x+2)+'px;top:2px;font-size:8px;color:rgba(255,255,255,0.8);';
                    lbl.textContent = x;
                    rh.appendChild(lbl);
                }
                // grid line
                var vl = document.createElement('div'); vl.className='grid-line-v'+(isMaj?' major':'');
                vl.style.left = x+'px'; vl.style.top = RULER+'px';
                gridEl.appendChild(vl);
            }

            // Vertical ruler ticks (Y axis)
            for (var y = 0; y <= flyerH; y += STEP) {
                var isMajY = y % MAJOR === 0;
                var tky = document.createElement('div'); tky.className='grid-ruler-tick';
                tky.style.cssText='top:'+(y-0.5)+'px;left:'+(isMajY?8:12)+'px;height:1px;width:'+(isMajY?12:8)+'px;background:rgba(255,255,255,'+(isMajY?'0.7':'0.35')+');';
                rv.appendChild(tky);
                if (isMajY && y > 0) {
                    var lbly = document.createElement('div'); lbly.className='grid-ruler-tick';
                    lbly.style.cssText='top:'+(y+2)+'px;left:2px;font-size:8px;color:rgba(255,255,255,0.8);writing-mode:horizontal-tb;';
                    lbly.textContent = y;
                    rv.appendChild(lbly);
                }
                var hl = document.createElement('div'); hl.className='grid-line-h'+(isMajY?' major':'');
                hl.style.top = y+'px'; hl.style.left = RULER+'px';
                gridEl.appendChild(hl);
            }

            // ‚îÄ‚îÄ Element bounding boxes + gap measurements ‚îÄ‚îÄ
            renderElementMeasurements(gridEl, flyerW, flyerH);
        }

        function renderElementMeasurements(gridEl, flyerW, flyerH) {
            var flyer = document.getElementById('flyer');
            var rects = [];

            flyer.querySelectorAll('.streamer-card').forEach(function(card) {
                var l=parseInt(card.style.left)||0, t=parseInt(card.style.top)||0;
                rects.push({el:card,left:l,top:t,right:l+card.offsetWidth,bottom:t+card.offsetHeight,w:card.offsetWidth,h:card.offsetHeight,type:'card',label:'Card'});
            });
            flyer.querySelectorAll('.custom-image-overlay').forEach(function(img,i) {
                var l=parseInt(img.style.left)||0, t=parseInt(img.style.top)||0;
                rects.push({el:img,left:l,top:t,right:l+img.offsetWidth,bottom:t+img.offsetHeight,w:img.offsetWidth,h:img.offsetHeight,type:'image',label:'Img'+(i+1)});
            });

            if (rects.length === 0) return;

            // Draw element bounding boxes
            rects.forEach(function(r) {
                var box = document.createElement('div'); box.className='grid-elem-box';
                box.style.left=(r.left-1)+'px'; box.style.top=(r.top-1)+'px';
                box.style.width=r.w+'px'; box.style.height=r.h+'px';
                if (r.type==='image') box.style.borderColor='rgba(180,100,255,0.8)';
                gridEl.appendChild(box);

                // Position + size label
                var lbl=document.createElement('div'); lbl.className='grid-elem-label';
                lbl.style.left=r.left+'px';
                lbl.style.top=Math.max(0,r.top-18)+'px';
                if (r.type==='image') lbl.style.background='rgba(130,60,200,0.9)';
                lbl.textContent=r.label+' '+r.left+','+r.top+' ('+r.w+'√ó'+r.h+')';
                gridEl.appendChild(lbl);

                // Left-edge distance from flyer edge
                if (r.left > 2) {
                    addGapMeasure(gridEl, 0, r.top+r.h/2, r.left, r.top+r.h/2, true, r.left+'px', 'rgba(255,180,0,0.9)');
                }
                // Top-edge distance from flyer top
                if (r.top > 2) {
                    addGapMeasure(gridEl, r.left+r.w/2, 0, r.left+r.w/2, r.top, false, r.top+'px', 'rgba(255,180,0,0.9)');
                }
            });

            // Vertical gaps between elements sorted by top
            var sorted = rects.slice().sort(function(a,b){return a.top-b.top;});
            for (var i=0; i<sorted.length-1; i++) {
                var a=sorted[i], b=sorted[i+1];
                var gap=b.top-a.bottom;
                if (gap < 0) continue;
                var midX=Math.max(30, Math.min((a.left+a.w/2+b.left+b.w/2)/2, flyerW-50));
                addGapMeasure(gridEl, midX, a.bottom, midX, b.top, false, Math.round(gap)+'px', 'rgba(255,80,80,0.92)');
            }

            // Horizontal gaps between elements sorted by left
            var sortedH = rects.slice().sort(function(a,b){return a.left-b.left;});
            for (var j=0; j<sortedH.length-1; j++) {
                var c=sortedH[j], d=sortedH[j+1];
                var hgap=d.left-c.right;
                if (hgap < 4) continue;
                var midY=Math.max(30, Math.min((c.top+c.h/2+d.top+d.h/2)/2, flyerH-20));
                addGapMeasure(gridEl, c.right, midY, d.left, midY, true, Math.round(hgap)+'px', 'rgba(80,200,80,0.92)');
            }
        }

        function addGapMeasure(gridEl, x1, y1, x2, y2, isHoriz, text, color) {
            var len = isHoriz ? Math.abs(x2-x1) : Math.abs(y2-y1);
            if (len < 2) return;
            var minX=Math.min(x1,x2), minY=Math.min(y1,y2);

            // Main line
            var line=document.createElement('div'); line.className='gap-line';
            if (isHoriz) {
                line.style.cssText='left:'+minX+'px;top:'+(y1-0.5)+'px;width:'+len+'px;height:1px;background:'+color+';';
            } else {
                line.style.cssText='left:'+(x1-0.5)+'px;top:'+minY+'px;width:1px;height:'+len+'px;background:'+color+';';
            }
            gridEl.appendChild(line);

            // End ticks
            var tickSize=5;
            [0,1].forEach(function(end) {
                var tick=document.createElement('div'); tick.className='gap-tick';
                if (isHoriz) {
                    var tx=end===0?minX:minX+len-1;
                    tick.style.cssText='left:'+tx+'px;top:'+(y1-tickSize)+'px;width:1px;height:'+(tickSize*2)+'px;background:'+color+';';
                } else {
                    var ty=end===0?minY:minY+len-1;
                    tick.style.cssText='left:'+(x1-tickSize)+'px;top:'+ty+'px;width:'+(tickSize*2)+'px;height:1px;background:'+color+';';
                }
                gridEl.appendChild(tick);
            });

            // Badge at midpoint
            var badge=document.createElement('div'); badge.className='gap-badge';
            badge.style.background=color;
            badge.style.left=(isHoriz?minX+len/2:x1)+'px';
            badge.style.top=(isHoriz?y1:minY+len/2)+'px';
            badge.textContent=text;
            gridEl.appendChild(badge);
        }

        function refreshGridIfVisible() { if(gridVisible) buildGridOverlay(); }
        // ‚îÄ‚îÄ GRID / SPACING OVERLAY ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

        function getGuideContainer() { return document.getElementById('flyer-guides'); }
        function getFlyerSize() {
            var f = document.getElementById('flyer');
            return { w: f.offsetWidth, h: f.offsetHeight };
        }

        // Build guide lines once on first use
        var _guides = null;
        function buildGuides() {
            if (_guides) return _guides;
            var c = getGuideContainer();
            var defs = [
                // center lines (pink)
                { id: 'g-cx', cls: 'v center-v', style: 'top:0;bottom:0;' },
                { id: 'g-cy', cls: 'h center-h', style: 'left:0;right:0;' },
                // thirds vertical
                { id: 'g-v1', cls: 'v',           style: 'top:0;bottom:0;' },
                { id: 'g-v2', cls: 'v',           style: 'top:0;bottom:0;' },
                // thirds horizontal
                { id: 'g-h1', cls: 'h',           style: 'left:0;right:0;' },
                { id: 'g-h2', cls: 'h',           style: 'left:0;right:0;' },
                // edges / margins
                { id: 'g-el', cls: 'v edge',      style: 'top:0;bottom:0;' },
                { id: 'g-er', cls: 'v edge',      style: 'top:0;bottom:0;' },
                { id: 'g-et', cls: 'h edge',      style: 'left:0;right:0;' },
                { id: 'g-eb', cls: 'h edge',      style: 'left:0;right:0;' },
            ];
            _guides = {};
            defs.forEach(function(d) {
                var el = document.createElement('div');
                el.id = d.id;
                el.className = 'align-guide ' + d.cls;
                el.setAttribute('style', el.getAttribute('style') || '');
                c.appendChild(el);
                _guides[d.id] = el;

                // Label
                var lbl = document.createElement('div');
                lbl.id = d.id + '-lbl';
                lbl.className = 'align-guide-label';
                c.appendChild(lbl);
                _guides[d.id + '-lbl'] = lbl;
            });
            return _guides;
        }

        function showGuide(id, pos, label) {
            var g = buildGuides();
            var el = g[id];
            var lbl = g[id + '-lbl'];
            if (!el) return;
            el.classList.add('show');
            var isV = el.classList.contains('v');
            if (isV) {
                el.style.left = pos + 'px';
            } else {
                el.style.top = pos + 'px';
            }
            if (lbl && label) {
                lbl.classList.add('show');
                lbl.textContent = label;
                if (isV) {
                    lbl.style.left = (pos + 3) + 'px';
                    lbl.style.top  = '4px';
                } else {
                    lbl.style.top  = (pos + 2) + 'px';
                    lbl.style.left = '4px';
                }
            }
        }

        function hideGuide(id) {
            var g = buildGuides();
            var el  = g[id];
            var lbl = g[id + '-lbl'];
            if (el)  el.classList.remove('show');
            if (lbl) lbl.classList.remove('show');
        }

        function hideAllGuides() {
            buildGuides();
            Object.keys(_guides).forEach(function(k) {
                _guides[k].classList.remove('show');
            });
        }

        // Main: call this from every drag move handler
        // elRect = { x, y, w, h } in flyer-local coords
        // Returns snapped { x, y }
        function updateGuides(elX, elY, elW, elH) {
            var fs     = getFlyerSize();
            var fw     = fs.w, fh = fs.h;
            var MARGIN = 20;

            // Key positions of the dragged element
            var elCx = elX + elW / 2;
            var elCy = elY + elH / 2;
            var elR  = elX + elW;
            var elB  = elY + elH;

            var snapX = elX, snapY = elY;

            hideAllGuides();
            refreshGridIfVisible();

            // ‚îÄ‚îÄ Vertical guides (x-axis snapping) ‚îÄ‚îÄ

            // Flyer center-x
            var fCx = fw / 2;
            if (Math.abs(elCx - fCx) < SNAP) {
                snapX = fCx - elW / 2;
                showGuide('g-cx', fCx, 'center');
            }
            // Rule-of-thirds verticals
            var t1x = fw / 3, t2x = (fw * 2) / 3;
            if (Math.abs(elCx - t1x) < SNAP || Math.abs(elX - t1x) < SNAP) {
                showGuide('g-v1', t1x, '‚Öì');
            }
            if (Math.abs(elCx - t2x) < SNAP || Math.abs(elR - t2x) < SNAP) {
                showGuide('g-v2', t2x, '‚Öî');
            }
            // Left & right margins
            if (Math.abs(elX - MARGIN) < SNAP) {
                snapX = MARGIN;
                showGuide('g-el', MARGIN, MARGIN + 'px');
            }
            if (Math.abs(elR - (fw - MARGIN)) < SNAP) {
                snapX = fw - MARGIN - elW;
                showGuide('g-er', fw - MARGIN, MARGIN + 'px');
            }

            // ‚îÄ‚îÄ Horizontal guides (y-axis snapping) ‚îÄ‚îÄ

            // Flyer center-y
            var fCy = fh / 2;
            if (Math.abs(elCy - fCy) < SNAP) {
                snapY = fCy - elH / 2;
                showGuide('g-cy', fCy, 'center');
            }
            // Rule-of-thirds horizontals
            var t1y = fh / 3, t2y = (fh * 2) / 3;
            if (Math.abs(elCy - t1y) < SNAP || Math.abs(elY - t1y) < SNAP) {
                showGuide('g-h1', t1y, '‚Öì');
            }
            if (Math.abs(elCy - t2y) < SNAP || Math.abs(elB - t2y) < SNAP) {
                showGuide('g-h2', t2y, '‚Öî');
            }
            // Top & bottom margins
            if (Math.abs(elY - MARGIN) < SNAP) {
                snapY = MARGIN;
                showGuide('g-et', MARGIN, MARGIN + 'px');
            }
            if (Math.abs(elB - (fh - MARGIN)) < SNAP) {
                snapY = fh - MARGIN - elH;
                showGuide('g-eb', fh - MARGIN, MARGIN + 'px');
            }

            return { x: snapX, y: snapY };
        }

        // ‚îÄ‚îÄ ALIGNMENT GUIDES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

        // ‚îÄ‚îÄ BACKGROUND IMAGE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        var bgEl = null;
        var bgDragging = false, bgOffX = 0, bgOffY = 0;
        var bgData = { x: 0, y: 0, size: 100, opacity: 100, fit: 'cover' };

        function handleBgUpload(event) {
            var file = event.target.files[0];
            if (!file) return;
            var reader = new FileReader();
            reader.onload = function(e) {
                var container = document.getElementById('flyer-backgrounds');
                container.style.pointerEvents = 'auto';
                while (container.firstChild) container.removeChild(container.firstChild);
                bgEl = document.createElement('div');
                bgEl.className = 'bg-overlay';
                bgEl.style.backgroundImage = 'url(' + e.target.result + ')';
                bgEl.style.width  = '100%';
                bgEl.style.height = '100%';
                bgEl.style.left   = '0px';
                bgEl.style.top    = '0px';
                bgEl.style.backgroundSize = 'cover';
                bgEl.style.opacity = '1';
                bgData = { x: 0, y: 0, size: 100, opacity: 100, fit: 'cover', src: e.target.result };
                bgEl.addEventListener('pointerdown', onBgPointerDown);
                bgEl.addEventListener('click', function(ev) { ev.stopPropagation(); selectBg(); });
                container.appendChild(bgEl);
                selectBg();
            };
            reader.readAsDataURL(file);
        }

        function selectBg() {
            document.querySelectorAll('.bg-overlay').forEach(function(b){ b.classList.remove('selected-bg'); });
            if (bgEl) {
                bgEl.classList.add('selected-bg');
                document.getElementById('bgControls').style.display = 'block';
                document.getElementById('bgSize').value    = bgData.size;
                document.getElementById('bgSizeVal').textContent    = bgData.size + '%';
                document.getElementById('bgOpacity').value = bgData.opacity;
                document.getElementById('bgOpacityVal').textContent = bgData.opacity + '%';
                document.getElementById('bgFit').value     = bgData.fit;
            }
        }

        function updateBg() {
            if (!bgEl) return;
            bgData.size    = parseInt(document.getElementById('bgSize').value);
            bgData.opacity = parseInt(document.getElementById('bgOpacity').value);
            bgData.fit     = document.getElementById('bgFit').value;
            document.getElementById('bgSizeVal').textContent    = bgData.size + '%';
            document.getElementById('bgOpacityVal').textContent = bgData.opacity + '%';
            bgEl.style.width   = bgData.size + '%';
            bgEl.style.height  = bgData.size + '%';
            bgEl.style.opacity = (bgData.opacity / 100).toString();
            bgEl.style.backgroundSize = bgData.fit;
        }

        function onBgPointerDown(e) {
            e.preventDefault(); e.stopPropagation();
            selectBg();
            var flyer = document.getElementById('flyer');
            var flyerRect = flyer.getBoundingClientRect();
            var elRect    = bgEl.getBoundingClientRect();
            bgOffX = e.clientX - elRect.left;
            bgOffY = e.clientY - elRect.top;
            bgDragging = true;
            bgEl.classList.add('dragging-bg');
            bgEl.setPointerCapture(e.pointerId);
            bgEl.addEventListener('pointermove', onBgPointerMove);
            bgEl.addEventListener('pointerup',   onBgPointerUp);
            bgEl.addEventListener('pointercancel', onBgPointerUp);
        }

        function onBgPointerMove(e) {
            if (!bgDragging) return;
            var flyer = document.getElementById('flyer');
            var flyerRect = flyer.getBoundingClientRect();
            var newX = e.clientX - flyerRect.left - bgOffX;
            var newY = e.clientY - flyerRect.top  - bgOffY;
            bgEl.style.left = newX + 'px';
            bgEl.style.top  = newY + 'px';
            bgData.x = newX; bgData.y = newY;
            updateGuides(newX, newY, bgEl.offsetWidth, bgEl.offsetHeight);
        }

        function onBgPointerUp(e) {
            bgDragging = false;
            hideAllGuides();
            refreshGridIfVisible();
            bgEl.classList.remove('dragging-bg');
            bgEl.removeEventListener('pointermove', onBgPointerMove);
            bgEl.removeEventListener('pointerup',   onBgPointerUp);
            bgEl.removeEventListener('pointercancel', onBgPointerUp);
        }

        function removeBg() {
            var container = document.getElementById('flyer-backgrounds');
            while (container.firstChild) container.removeChild(container.firstChild);
            container.style.pointerEvents = 'none';
            bgEl = null;
            document.getElementById('bgControls').style.display = 'none';
            document.getElementById('bgUpload').value = '';
        }

        // ‚îÄ‚îÄ DRAGGABLE TITLE & DATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        var titlePos    = { x: 30, y: 30  };
        var datePos     = { x: 30, y: 130 };
        var titleSizePx = 48;
        var dateSizePx  = 24;
        var draggingEl  = null, elOffX = 0, elOffY = 0;

        function initTitleDateDrag() {
            var titleEl = document.getElementById('preview-title');
            var dateEl  = document.getElementById('preview-datetime');
            if (titleEl) titleEl.addEventListener('pointerdown', onElPointerDown);
            if (dateEl)  dateEl.addEventListener('pointerdown', onElPointerDown);
            applyTitleDatePositions();
        }

        function applyTitleDatePositions() {
            var titleEl = document.getElementById('preview-title');
            var dateEl  = document.getElementById('preview-datetime');
            if (titleEl) {
                titleEl.style.left  = titlePos.x + 'px';
                titleEl.style.top   = titlePos.y + 'px';
                titleEl.style.right = 'auto';
                titleEl.style.fontSize = titleSizePx + 'px';
            }
            if (dateEl) {
                dateEl.style.left  = datePos.x + 'px';
                dateEl.style.top   = datePos.y + 'px';
                dateEl.style.right = 'auto';
                dateEl.style.width = 'auto';
            }
        }

        function selectElement(type) {
            var el = type === 'title'
                ? document.getElementById('preview-title')
                : document.getElementById('preview-datetime');
            if (!el) return;
            document.querySelectorAll('.selected-element').forEach(function(e){ e.classList.remove('selected-element'); });
            el.classList.add('selected-element');
        }

        function onElPointerDown(e) {
            e.preventDefault(); e.stopPropagation();
            var el = e.currentTarget;
            document.querySelectorAll('.selected-element').forEach(function(x){ x.classList.remove('selected-element'); });
            el.classList.add('selected-element');
            var flyer     = document.getElementById('flyer');
            var flyerRect = flyer.getBoundingClientRect();
            var elRect    = el.getBoundingClientRect();
            elOffX = e.clientX - elRect.left;
            elOffY = e.clientY - elRect.top;
            draggingEl = el;
            el.classList.add('dragging-element');
            el.setPointerCapture(e.pointerId);
            el.addEventListener('pointermove', onElPointerMove);
            el.addEventListener('pointerup',   onElPointerUp);
            el.addEventListener('pointercancel', onElPointerUp);
        }

        function onElPointerMove(e) {
            if (!draggingEl) return;
            var flyer     = document.getElementById('flyer');
            var flyerRect = flyer.getBoundingClientRect();
            var newX = e.clientX - flyerRect.left - elOffX;
            var newY = e.clientY - flyerRect.top  - elOffY;
            newX = Math.max(0, Math.min(newX, flyerRect.width  - draggingEl.offsetWidth));
            newY = Math.max(0, Math.min(newY, flyerRect.height - draggingEl.offsetHeight));
            var snapped = updateGuides(newX, newY, draggingEl.offsetWidth, draggingEl.offsetHeight);
            newX = snapped.x; newY = snapped.y;
            draggingEl.style.left  = newX + 'px';
            draggingEl.style.top   = newY + 'px';
            draggingEl.style.right = 'auto';
            if (draggingEl.id === 'preview-title')    { titlePos.x = newX; titlePos.y = newY; }
            if (draggingEl.id === 'preview-datetime') { datePos.x  = newX; datePos.y  = newY; }
        }

        function onElPointerUp(e) {
            if (!draggingEl) return;
            hideAllGuides();
            // Apply snap-to-grid on drop
            if (snapToGridEnabled) {
                var left = parseInt(draggingEl.style.left) || 0;
                var top  = parseInt(draggingEl.style.top) || 0;
                var snappedX = snapValue(left);
                var snappedY = snapValue(top);
                draggingEl.style.left = snappedX + 'px';
                draggingEl.style.top  = snappedY + 'px';
                // Save position
                if (draggingEl.id === 'preview-title') {
                    titlePos = { x: snappedX, y: snappedY };
                } else if (draggingEl.classList.contains('flyer-datetime')) {
                    datePos = { x: snappedX, y: snappedY };
                }
            }
            refreshGridIfVisible();
            draggingEl.classList.remove('dragging-element');
            draggingEl.removeEventListener('pointermove', onElPointerMove);
            draggingEl.removeEventListener('pointerup',   onElPointerUp);
            draggingEl.removeEventListener('pointercancel', onElPointerUp);
            draggingEl = null;
        }

        function updateTitleSize(val) {
            titleSizePx = parseInt(val);
            document.getElementById('titleSizeVal').textContent = val + 'px';
            var el = document.getElementById('preview-title');
            if (el) el.style.fontSize = val + 'px';
        }

        function updateDateSize(val) {
            dateSizePx = parseInt(val);
            document.getElementById('dateSizeVal').textContent = val + 'px';
            var el = document.getElementById('preview-date');
            if (el) el.style.fontSize = val + 'px';
        }

        function resetTitleDatePositions() {
            titlePos = { x: 30, y: 30 };
            datePos  = { x: 30, y: Math.round(30 + titleSizePx * 1.4 + 20) };
            applyTitleDatePositions();
        }

        // Tab switcher for title/date panel
        function switchTitleDateTab(tab) {
            var isTitle = tab === 'title';
            document.getElementById('tab-title-panel').style.display = isTitle ? '' : 'none';
            document.getElementById('tab-date-panel').style.display  = isTitle ? 'none' : '';
            document.getElementById('tab-title-btn').style.background = isTitle ? '#9146ff' : 'rgba(145,70,255,0.15)';
            document.getElementById('tab-title-btn').style.color      = isTitle ? '#fff' : '#9146ff';
            document.getElementById('tab-date-btn').style.background  = isTitle ? 'rgba(145,70,255,0.15)' : '#9146ff';
            document.getElementById('tab-date-btn').style.color       = isTitle ? '#9146ff' : '#fff';
        }

        // Load a Google Font by family name and apply it
        var _loadedFonts = {};
        function loadGoogleFont(family) {
            if (!family || _loadedFonts[family]) return;
            _loadedFonts[family] = true;
            var link = document.createElement('link');
            link.rel  = 'stylesheet';
            link.href = 'https://fonts.googleapis.com/css2?family=' +
                encodeURIComponent(family).replace(/%20/g, '+') +
                ':wght@400;700;800;900&display=swap';
            document.head.appendChild(link);
        }

        function hexToRgba(hex, alpha) {
            var r = parseInt(hex.slice(1,3),16);
            var g = parseInt(hex.slice(3,5),16);
            var b = parseInt(hex.slice(5,7),16);
            return 'rgba(' + r + ',' + g + ',' + b + ',' + alpha + ')';
        }

        function applyTitleStyle() {
            var el     = document.getElementById('preview-title');
            if (!el) return;
            var color  = document.getElementById('titleColor').value;
            var font   = document.getElementById('titleFontSelect').value;
            var weight = document.getElementById('titleWeight').value;
            var style  = document.getElementById('titleStyleSel').value;
            var align  = document.getElementById('titleAlign').value;
            var shadowBlur  = document.getElementById('titleShadow').value;
            var shadowColor = document.getElementById('titleShadowColor').value;
            var strokeW     = document.getElementById('titleStrokeWidth').value;
            var strokeColor = document.getElementById('titleStrokeColor').value;
            document.getElementById('titleStrokeVal').textContent = strokeW + 'px';

            el.style.color      = color;
            el.style.fontWeight = weight;
            el.style.fontStyle  = style;
            el.style.textAlign  = align;

            // Text shadow
            if (parseInt(shadowBlur) > 0) {
                el.style.textShadow = '2px 2px ' + shadowBlur + 'px ' + shadowColor;
            } else {
                el.style.textShadow = 'none';
            }

            // Stroke via -webkit-text-stroke
            if (parseInt(strokeW) > 0) {
                el.style.webkitTextStroke = strokeW + 'px ' + strokeColor;
            } else {
                el.style.webkitTextStroke = '0px';
            }

            // Font
            if (font) {
                loadGoogleFont(font);
                el.style.fontFamily = "'" + font + "', sans-serif";
            }
            // else keep theme font ‚Äî don't override
        }

        function applyDateStyle() {
            var dateEl = document.getElementById('preview-date');
            var boxEl  = document.getElementById('preview-datetime');
            if (!dateEl || !boxEl) return;

            var textColor    = document.getElementById('dateTextColor').value;
            var font         = document.getElementById('dateFontSelect').value;
            var bgColor      = document.getElementById('dateBgColor').value;
            var bgOpacity    = parseInt(document.getElementById('dateBgOpacity').value) / 100;
            var borderColor  = document.getElementById('dateBorderColor').value;
            var borderWidth  = document.getElementById('dateBorderWidth').value;
            var borderRadius = document.getElementById('dateBorderRadius').value;
            var align        = document.getElementById('dateAlign').value;

            dateEl.style.color     = textColor;
            dateEl.style.textAlign = align;

            boxEl.style.background   = hexToRgba(bgColor, bgOpacity);
            boxEl.style.border       = borderWidth + 'px solid ' + borderColor;
            boxEl.style.borderRadius = borderRadius + 'px';
            boxEl.style.textAlign    = align;

            if (font) {
                loadGoogleFont(font);
                dateEl.style.fontFamily = "'" + font + "', sans-serif";
            }
        }

        // Init after DOM ready
        document.addEventListener('DOMContentLoaded', function() {
            initTitleDateDrag();
        });

        // ‚îÄ‚îÄ TEXT OVERLAYS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        let textOverlays = [];       // { id, el, text, size, color, font, style }
        let selectedTextId = null;
        let draggingText = null;
        let textDragOffX = 0, textDragOffY = 0;

        function addTextOverlay() {
            const text = document.getElementById('newTextInput').value.trim();
            if (!text) { alert('Please type some text first.'); return; }

            const size   = document.getElementById('newTextSize').value;
            const color  = document.getElementById('newTextColor').value;
            const font   = document.getElementById('newTextFont').value;
            const style  = document.getElementById('newTextStyle').value;

            const flyer = document.getElementById('flyer');
            const id = 'txt-' + Date.now();

            const el = document.createElement('div');
            el.className = 'text-overlay';
            el.id = id;
            el.textContent = text;
            el.style.fontSize   = size + 'px';
            el.style.color      = color;
            el.style.fontFamily = font;
            el.style.fontWeight = style.includes('bold')   ? 'bold'   : 'normal';
            el.style.fontStyle  = style.includes('italic') ? 'italic' : 'normal';

            // Place in center
            const fw = flyer.offsetWidth, fh = flyer.offsetHeight;
            el.style.left = Math.round(fw * 0.1) + 'px';
            el.style.top  = Math.round(fh * 0.45) + 'px';

            // Delete button inside
            const delBtn = document.createElement('span');
            delBtn.className = 'text-delete-btn';
            delBtn.textContent = '√ó';
            delBtn.title = 'Delete';
            delBtn.addEventListener('pointerdown', (e) => {
                e.stopPropagation();
                removeTextOverlay(id);
            });
            el.appendChild(delBtn);

            // Drag
            el.addEventListener('pointerdown', onTextPointerDown);

            // Click to select
            el.addEventListener('click', (e) => {
                e.stopPropagation();
                selectTextOverlay(id);
            });

            flyer.appendChild(el);

            const info = { id, el, text, size, color, font, style };
            textOverlays.push(info);
            selectTextOverlay(id);
            refreshTextList();

            // Clear input
            document.getElementById('newTextInput').value = '';
        }

        function onTextPointerDown(e) {
            if (e.target.classList.contains('text-delete-btn')) return;
            e.preventDefault();
            const el = e.currentTarget;
            const id = el.id;
            selectTextOverlay(id);

            const flyer = document.getElementById('flyer');
            const flyerRect = flyer.getBoundingClientRect();
            const elRect = el.getBoundingClientRect();

            textDragOffX = e.clientX - elRect.left;
            textDragOffY = e.clientY - elRect.top;
            draggingText = el;
            el.classList.add('dragging-text');
            el.setPointerCapture(e.pointerId);

            el.addEventListener('pointermove', onTextPointerMove);
            el.addEventListener('pointerup',   onTextPointerUp);
            el.addEventListener('pointercancel', onTextPointerUp);
        }

        function onTextPointerMove(e) {
            if (!draggingText) return;
            const flyer = document.getElementById('flyer');
            const flyerRect = flyer.getBoundingClientRect();
            let newX = e.clientX - flyerRect.left - textDragOffX;
            let newY = e.clientY - flyerRect.top  - textDragOffY;
            newX = Math.max(0, Math.min(newX, flyerRect.width  - draggingText.offsetWidth));
            newY = Math.max(0, Math.min(newY, flyerRect.height - draggingText.offsetHeight));
            const snapped = updateGuides(newX, newY, draggingText.offsetWidth, draggingText.offsetHeight);
            newX = snapped.x; newY = snapped.y;
            draggingText.style.left = newX + 'px';
            draggingText.style.top  = newY + 'px';
        }

        function onTextPointerUp(e) {
            if (!draggingText) return;
            hideAllGuides();
            // Apply snap-to-grid on drop
            if (snapToGridEnabled) {
                var left = parseInt(draggingText.style.left) || 0;
                var top  = parseInt(draggingText.style.top) || 0;
                var snappedX = snapValue(left);
                var snappedY = snapValue(top);
                draggingText.style.left = snappedX + 'px';
                draggingText.style.top  = snappedY + 'px';
                const textData = textOverlays.find(t => t.id === draggingText.id);
                if (textData) {
                    textData.x = snappedX;
                    textData.y = snappedY;
                }
            }
            refreshGridIfVisible();
            draggingText.classList.remove('dragging-text');
            draggingText.removeEventListener('pointermove', onTextPointerMove);
            draggingText.removeEventListener('pointerup',   onTextPointerUp);
            draggingText.removeEventListener('pointercancel', onTextPointerUp);
            draggingText = null;
        }

        function selectTextOverlay(id) {
            // Deselect all
            document.querySelectorAll('.text-overlay').forEach(el => el.classList.remove('selected-text'));
            selectedTextId = id;
            const info = textOverlays.find(t => t.id === id);
            if (!info) return;
            info.el.classList.add('selected-text');
            // Populate sidebar controls with selected text's values
            document.getElementById('newTextInput').value  = info.text;
            document.getElementById('newTextSize').value   = info.size;
            document.getElementById('newTextSizeVal').textContent = info.size + 'px';
            document.getElementById('newTextColor').value  = info.color;
            document.getElementById('newTextFont').value   = info.font;
            document.getElementById('newTextStyle').value  = info.style;
            refreshTextList();
        }

        function updateSelectedText() {
            if (!selectedTextId) return;
            const info = textOverlays.find(t => t.id === selectedTextId);
            if (!info) return;
            const text  = document.getElementById('newTextInput').value.trim() || info.text;
            const size  = document.getElementById('newTextSize').value;
            const color = document.getElementById('newTextColor').value;
            const font  = document.getElementById('newTextFont').value;
            const style = document.getElementById('newTextStyle').value;
            // Update data
            info.text  = text;
            info.size  = size;
            info.color = color;
            info.font  = font;
            info.style = style;
            // Update DOM (preserve delete button)
            info.el.childNodes.forEach(n => { if (n.nodeType === Node.TEXT_NODE) n.remove(); });
            info.el.insertBefore(document.createTextNode(text), info.el.firstChild);
            info.el.style.fontSize   = size + 'px';
            info.el.style.color      = color;
            info.el.style.fontFamily = font;
            info.el.style.fontWeight = style.includes('bold')   ? 'bold'   : 'normal';
            info.el.style.fontStyle  = style.includes('italic') ? 'italic' : 'normal';
            refreshTextList();
        }

        function removeTextOverlay(id) {
            const idx = textOverlays.findIndex(t => t.id === id);
            if (idx === -1) return;
            textOverlays[idx].el.remove();
            textOverlays.splice(idx, 1);
            if (selectedTextId === id) selectedTextId = null;
            refreshTextList();
        }

        function removeAllTextOverlays() {
            textOverlays.forEach(t => t.el.remove());
            textOverlays = [];
            selectedTextId = null;
            refreshTextList();
        }

        function refreshTextList() {
            const list = document.getElementById('textOverlaysItems');
            const wrap = document.getElementById('textOverlaysList');
            wrap.style.display = textOverlays.length ? 'block' : 'none';
            list.innerHTML = '';
            textOverlays.forEach(info => {
                const row = document.createElement('div');
                row.style.cssText = `display:flex;align-items:center;gap:6px;padding:6px 8px;border-radius:6px;margin-bottom:4px;cursor:pointer;background:${selectedTextId===info.id ? 'rgba(145,70,255,0.2)' : 'rgba(255,255,255,0.05)'};border:1px solid ${selectedTextId===info.id ? '#9146ff' : 'transparent'}`;
                row.innerHTML = `
                    <span style="flex:1;font-size:13px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:${info.color}">${info.text}</span>
                    <button onclick="selectTextOverlay('${info.id}')" style="padding:2px 8px;font-size:11px;background:#9146ff;">Edit</button>
                    <button onclick="removeTextOverlay('${info.id}')" style="padding:2px 8px;font-size:11px;background:#ef4444;">‚úï</button>
                `;
                row.addEventListener('click', () => selectTextOverlay(info.id));
                list.appendChild(row);
            });
        }

        // Live-update selected text when controls change
        ['newTextSize','newTextColor','newTextFont','newTextStyle'].forEach(id => {
            document.getElementById(id)?.addEventListener('input', () => {
                if (selectedTextId) updateSelectedText();
            });
            document.getElementById(id)?.addEventListener('change', () => {
                if (selectedTextId) updateSelectedText();
            });
        });

        // Hide text selection border on download (already handled via existing logic)
        // Deselect text when clicking flyer background
        document.getElementById('flyer')?.addEventListener('click', (e) => {
            if (e.target === document.getElementById('flyer') || e.target.id === 'flyer-decoration' || e.target.tagName === 'svg' || e.target.tagName === 'g') {
                document.querySelectorAll('.text-overlay').forEach(el => el.classList.remove('selected-text'));
                selectedTextId = null;
                refreshTextList();
            }
        });

        // ‚îÄ‚îÄ SAVE / LOAD PROJECT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function saveProject() {
            // Sync live card positions from DOM into streamerPositions before saving
            document.querySelectorAll('.streamer-card').forEach(function(card) {
                var idx = parseInt(card.dataset.streamerIndex);
                streamerPositions[idx] = {
                    x:      parseInt(card.style.left) || 0,
                    y:      parseInt(card.style.top)  || 0,
                    manual: true
                };
            });
            // Sync live title/date positions from DOM
            var titleElSave = document.getElementById('preview-title');
            var dateElSave  = document.getElementById('preview-datetime');
            if (titleElSave) { titlePos.x = parseInt(titleElSave.style.left)||titlePos.x; titlePos.y = parseInt(titleElSave.style.top)||titlePos.y; }
            if (dateElSave)  { datePos.x  = parseInt(dateElSave.style.left) ||datePos.x;  datePos.y  = parseInt(dateElSave.style.top) ||datePos.y; }
            // Sync live text overlay positions from DOM
            textOverlays.forEach(function(t) {
                if (t.el) { t.x = parseInt(t.el.style.left)||0; t.y = parseInt(t.el.style.top)||0; }
            });
            // Sync live custom image data from DOM
            customImages.forEach(function(img) {
                if (img.el) {
                    img.x       = parseInt(img.el.style.left)   || 0;
                    img.y       = parseInt(img.el.style.top)    || 0;
                    img.width   = parseInt(img.el.style.width)  || 200;
                    img.height  = parseInt(img.el.style.height) || 200;
                    img.opacity = parseFloat(img.el.style.opacity) || 0.5;
                    img.data    = img.el.style.backgroundImage.replace(/^url\(["']?/, '').replace(/["']?\)$/, '');
                }
            });

            // Collect streamer form data
            var streamerData = [];
            document.querySelectorAll('.streamer-entry').forEach(function(entry, idx) {
                var username = (entry.querySelector('.streamer-username') || {}).value || '';
                var name     = (entry.querySelector('.streamer-name')     || {}).value || '';
                var time     = (entry.querySelector('.streamer-time')     || {}).value || '';
                var endtime  = (entry.querySelector('.streamer-endtime')  || {}).value || '';
                var imageUrl = (streamers[idx] || {}).imageUrl || '';
                streamerData.push({ username: username, name: name, time: time, endtime: endtime, imageUrl: imageUrl });
            });

            // Collect text overlays
            var textData = textOverlays.map(function(t) {
                return {
                    text:  t.text,
                    size:  t.size,
                    color: t.color,
                    font:  t.font,
                    style: t.style,
                    x:     parseInt(t.el.style.left) || 0,
                    y:     parseInt(t.el.style.top)  || 0
                };
            });

            // Collect custom overlay images
            var imageData = customImages.map(function(img) {
                return {
                    src:     img.data || '',
                    x:       img.x || 0,
                    y:       img.y || 0,
                    width:   img.width  || 200,
                    opacity: img.opacity || 0.5
                };
            });

            var project = {
                version:     2,
                savedAt:     new Date().toISOString(),
                // Core fields
                title:       (document.getElementById('title')   || {}).value || '',
                theme:       (document.getElementById('theme')   || {}).value || '',
                date:        (document.getElementById('date')    || {}).value || '',
                preset:      (document.querySelector('.theme-btn.active') || {}).dataset && document.querySelector('.theme-btn.active').dataset.preset || '',
                orientation: currentOrientation,
                // Streamers
                streamers:   streamerData,
                streamerPositions: streamerPositions,
                // Overlays
                textOverlays:  textData,
                customImages:  imageData,
                // Background
                bgData:        bgData,
                bgSrc:         bgEl ? bgEl.style.backgroundImage.replace(/^url\(["']?/, '').replace(/["']?\)$/, '') : null,
                // Title styling
                titlePos:       titlePos,
                titleSizePx:    titleSizePx,
                titleColor:     (document.getElementById('titleColor')       || {}).value || '#ffffff',
                titleFont:      (document.getElementById('titleFontSelect')  || {}).value || '',
                titleWeight:    (document.getElementById('titleWeight')       || {}).value || '700',
                titleStyleVal:  (document.getElementById('titleStyleSel')     || {}).value || 'normal',
                titleAlign:     (document.getElementById('titleAlign')        || {}).value || 'center',
                titleShadowBlur:(document.getElementById('titleShadow')       || {}).value || '8',
                titleShadowClr: (document.getElementById('titleShadowColor')  || {}).value || '#000000',
                titleStrokeW:   (document.getElementById('titleStrokeWidth')  || {}).value || '0',
                titleStrokeClr: (document.getElementById('titleStrokeColor')  || {}).value || '#000000',
                // Date styling
                datePos:        datePos,
                dateSizePx:     dateSizePx,
                dateTextColor:  (document.getElementById('dateTextColor')     || {}).value || '#ffffff',
                dateFont:       (document.getElementById('dateFontSelect')    || {}).value || '',
                dateBgColor:    (document.getElementById('dateBgColor')       || {}).value || '#9146ff',
                dateBgOpacity:  (document.getElementById('dateBgOpacity')     || {}).value || '30',
                dateBorderClr:  (document.getElementById('dateBorderColor')   || {}).value || '#9146ff',
                dateBorderW:    (document.getElementById('dateBorderWidth')   || {}).value || '2',
                dateBorderRad:  (document.getElementById('dateBorderRadius')  || {}).value || '12',
                dateAlign:      (document.getElementById('dateAlign')         || {}).value || 'center',
                // Avatar borders
                avatarBorderEnabled: (document.getElementById('avatarBorderEnabled') || {}).checked !== false,
                avatarBorderColor: (document.getElementById('avatarBorderColor') || {}).value || '#9146ff',
                avatarBorderWidth: (document.getElementById('avatarBorderWidth') || {}).value || '3',
                // Featured streamer
                featuredConfig: featuredConfig,
                featuredOverrides: featuredOverrides
            };

            var json = JSON.stringify(project, null, 2);
            var blob = new Blob([json], { type: 'application/json' });
            var a    = document.createElement('a');
            a.href   = URL.createObjectURL(blob);
            var safeName = (project.title || 'flyer').replace(/[^a-z0-9]/gi, '-').toLowerCase().slice(0, 40);
            a.download = safeName + '.flyer';
            a.click();
            URL.revokeObjectURL(a.href);
        }

        function loadProject(event) {
            var file = event.target.files[0];
            if (!file) return;
            var reader = new FileReader();
            reader.onload = function(e) {
                try {
                    var p = JSON.parse(e.target.result);
                    restoreProject(p);
                } catch(err) {
                    alert('Could not read project file. Make sure it\'s a .flyer file saved by this app.');
                }
            };
            reader.readAsText(file);
            event.target.value = ''; // allow re-loading same file
        }

        async function restoreProject(p) {
            // ‚îÄ‚îÄ STEP 1: Core text fields (no DOM side-effects) ‚îÄ‚îÄ
            if (p.title !== undefined) { var t = document.getElementById('title'); if(t) t.value = p.title; }
            if (p.theme !== undefined) { var th = document.getElementById('theme'); if(th) th.value = p.theme; }
            if (p.date  !== undefined) { var dt = document.getElementById('date');  if(dt) dt.value = p.date; }

            // ‚îÄ‚îÄ STEP 2: Orientation (resizes flyer, must be before layout) ‚îÄ‚îÄ
            if (p.orientation) {
                currentOrientation = p.orientation;
                var flyer = document.getElementById('flyer');
                var btnP  = document.getElementById('btn-portrait');
                var btnL  = document.getElementById('btn-landscape');
                if (p.orientation === 'landscape') {
                    if(flyer){ flyer.style.width='800px'; flyer.style.height='600px'; }
                    if(btnL){ btnL.style.background='#9146ff'; btnL.style.color='#fff'; }
                    if(btnP){ btnP.style.background='transparent'; btnP.style.color='#9146ff'; }
                } else {
                    if(flyer){ flyer.style.width='600px'; flyer.style.height='800px'; }
                    if(btnP){ btnP.style.background='#9146ff'; btnP.style.color='#fff'; }
                    if(btnL){ btnL.style.background='transparent'; btnL.style.color='#9146ff'; }
                }
            }

            // ‚îÄ‚îÄ STEP 3: Theme preset (sets colors/fonts on title+date) ‚îÄ‚îÄ
            if (p.preset) {
                var presetBtn = document.querySelector('.theme-btn[data-preset="' + p.preset + '"]');
                if (presetBtn) {
                    document.querySelectorAll('.theme-btn').forEach(function(b){ b.classList.remove('active'); });
                    presetBtn.classList.add('active');
                    applyThemePreset(p.preset);
                    applyDecoration(p.preset);
                }
            }

            // ‚îÄ‚îÄ STEP 4: Restore title vars + apply to DOM ‚îÄ‚îÄ
            titleSizePx = p.titleSizePx || 48;
            titlePos    = p.titlePos    || { x: 30, y: 30 };
            var tSize = document.getElementById('titleSize');
            var tSizeV= document.getElementById('titleSizeVal');
            if(tSize)  tSize.value = titleSizePx;
            if(tSizeV) tSizeV.textContent = titleSizePx + 'px';

            var titleFields = [
                ['titleColor',      p.titleColor      || '#ffffff'],
                ['titleFontSelect', p.titleFont        || ''],
                ['titleWeight',     p.titleWeight      || '700'],
                ['titleStyleSel',   p.titleStyleVal    || 'normal'],
                ['titleAlign',      p.titleAlign       || 'center'],
                ['titleShadow',     p.titleShadowBlur  || '8'],
                ['titleShadowColor',p.titleShadowClr   || '#000000'],
                ['titleStrokeWidth',p.titleStrokeW     || '0'],
                ['titleStrokeColor',p.titleStrokeClr   || '#000000'],
            ];
            titleFields.forEach(function(pair) {
                var el = document.getElementById(pair[0]);
                if (el) el.value = pair[1];
            });
            var tShV = document.getElementById('titleShadowVal');
            var tStV = document.getElementById('titleStrokeVal');
            if(tShV) tShV.textContent = (p.titleShadowBlur || '8') + 'px';
            if(tStV) tStV.textContent = (p.titleStrokeW    || '0') + 'px';

            // ‚îÄ‚îÄ STEP 5: Restore date vars + apply to DOM ‚îÄ‚îÄ
            dateSizePx = p.dateSizePx || 24;
            datePos    = p.datePos    || { x: 30, y: 130 };
            var dSize  = document.getElementById('dateSize');
            var dSizeV = document.getElementById('dateSizeVal');
            if(dSize)  dSize.value = dateSizePx;
            if(dSizeV) dSizeV.textContent = dateSizePx + 'px';

            var dateFields = [
                ['dateTextColor',   p.dateTextColor  || '#ffffff'],
                ['dateFontSelect',  p.dateFont        || ''],
                ['dateBgColor',     p.dateBgColor     || '#9146ff'],
                ['dateBgOpacity',   p.dateBgOpacity   || '30'],
                ['dateBorderColor', p.dateBorderClr   || '#9146ff'],
                ['dateBorderWidth', p.dateBorderW     || '2'],
                ['dateBorderRadius',p.dateBorderRad   || '12'],
                ['dateAlign',       p.dateAlign       || 'center'],
            ];
            dateFields.forEach(function(pair) {
                var el = document.getElementById(pair[0]);
                if (el) el.value = pair[1];
            });
            var dBgOpV = document.getElementById('dateBgOpVal');
            if(dBgOpV) dBgOpV.textContent = (p.dateBgOpacity || '30') + '%';

            // Apply title+date styles (colors, fonts, etc.)
            applyTitleStyle();
            applyDateStyle();

            // Apply positions to DOM elements NOW
            var titleEl  = document.getElementById('preview-title');
            var dateBox  = document.getElementById('preview-datetime');
            var dateText = document.getElementById('preview-date');
            if (titleEl) {
                titleEl.style.left     = titlePos.x + 'px';
                titleEl.style.top      = titlePos.y + 'px';
                titleEl.style.right    = 'auto';
                titleEl.style.fontSize = titleSizePx + 'px';
            }
            if (dateBox) {
                dateBox.style.left  = datePos.x + 'px';
                dateBox.style.top   = datePos.y + 'px';
                dateBox.style.right = 'auto';
                dateBox.style.width = 'auto';
            }
            if (dateText) dateText.style.fontSize = dateSizePx + 'px';

            // ‚îÄ‚îÄ STEP 6: Streamers ‚Äî build forms first, then set positions ‚îÄ‚îÄ
            document.getElementById('streamers-list').innerHTML = '';
            streamers.length = 0;
            streamerCount = 0;
            // Clear any existing cards from flyer
            document.querySelectorAll('.streamer-card').forEach(function(c){ c.remove(); });

            if (p.streamers && p.streamers.length) {
                for (var i = 0; i < p.streamers.length; i++) {
                    var sd = p.streamers[i];
                    addStreamer();
                    var entries = document.querySelectorAll('.streamer-entry');
                    var entry   = entries[entries.length - 1];
                    if (entry) {
                        var uEl = entry.querySelector('.streamer-username');
                        var nEl = entry.querySelector('.streamer-name');
                        var tmEl= entry.querySelector('.streamer-time');
                        var etEl= entry.querySelector('.streamer-endtime');
                        if (uEl) uEl.value = sd.username || '';
                        if (nEl) nEl.value = sd.name     || '';
                        if (tmEl)tmEl.value= sd.time     || '';
                        if (etEl)etEl.value= sd.endtime  || '';
                        var sIdx = streamers.length - 1;
                        if (sd.imageUrl && streamers[sIdx]) {
                            streamers[sIdx].imageUrl = sd.imageUrl;
                            var prevImg = document.getElementById(streamers[sIdx].id + '-preview');
                            if (prevImg) { prevImg.src = sd.imageUrl; prevImg.classList.add('show'); }
                        }
                    }
                }
            }

            // Restore saved positions BEFORE calling updatePreview
            streamerPositions = {};
            if (p.streamerPositions) {
                // Keys may be strings after JSON round-trip ‚Äî convert back
                Object.keys(p.streamerPositions).forEach(function(k) {
                    streamerPositions[parseInt(k)] = p.streamerPositions[k];
                });
                // Mark all restored positions as manual so updatePreview respects them
                Object.keys(streamerPositions).forEach(function(k) {
                    if (streamerPositions[k]) streamerPositions[k].manual = true;
                });
            }

            // ‚îÄ‚îÄ STEP 7: updatePreview places cards using the restored positions ‚îÄ‚îÄ
            updatePreview();

            // ‚îÄ‚îÄ STEP 8: After updatePreview, force card positions again ‚îÄ‚îÄ
            // (updatePreview may have adjusted non-manual ones; re-apply manual overrides)
            await new Promise(function(r){ requestAnimationFrame(r); });
            document.querySelectorAll('.streamer-card').forEach(function(card) {
                var idx = parseInt(card.dataset.streamerIndex);
                var pos = streamerPositions[idx];
                if (pos && pos.manual) {
                    card.style.left = pos.x + 'px';
                    card.style.top  = pos.y + 'px';
                }
            });

            // ‚îÄ‚îÄ STEP 9: Background ‚îÄ‚îÄ
            removeBg(); // clear any existing
            if (p.bgSrc && p.bgData) {
                var container = document.getElementById('flyer-backgrounds');
                container.style.pointerEvents = 'auto';
                bgEl = document.createElement('div');
                bgEl.className = 'bg-overlay';
                bgEl.style.backgroundImage = 'url(' + p.bgSrc + ')';
                bgEl.style.left   = (p.bgData.x || 0) + 'px';
                bgEl.style.top    = (p.bgData.y || 0) + 'px';
                bgEl.style.width  = (p.bgData.size  || 100) + '%';
                bgEl.style.height = (p.bgData.size  || 100) + '%';
                bgEl.style.opacity = ((p.bgData.opacity || 100) / 100).toString();
                bgEl.style.backgroundSize = p.bgData.fit || 'cover';
                bgData = { x: p.bgData.x||0, y: p.bgData.y||0, size: p.bgData.size||100, opacity: p.bgData.opacity||100, fit: p.bgData.fit||'cover', src: p.bgSrc };
                bgEl.addEventListener('pointerdown', onBgPointerDown);
                bgEl.addEventListener('click', function(ev) { ev.stopPropagation(); selectBg(); });
                container.appendChild(bgEl);
                var bgSizeEl    = document.getElementById('bgSize');
                var bgOpEl      = document.getElementById('bgOpacity');
                var bgFitEl     = document.getElementById('bgFit');
                var bgSizeValEl = document.getElementById('bgSizeVal');
                var bgOpValEl   = document.getElementById('bgOpacityVal');
                if(bgSizeEl)    bgSizeEl.value    = bgData.size;
                if(bgOpEl)      bgOpEl.value       = bgData.opacity;
                if(bgFitEl)     bgFitEl.value      = bgData.fit;
                if(bgSizeValEl) bgSizeValEl.textContent = bgData.size + '%';
                if(bgOpValEl)   bgOpValEl.textContent   = bgData.opacity + '%';
                document.getElementById('bgControls').style.display = 'block';
            }

            // ‚îÄ‚îÄ STEP 10: Custom image overlays ‚îÄ‚îÄ
            document.querySelectorAll('.custom-image-overlay').forEach(function(el){ el.remove(); });
            customImages = [];
            if (p.customImages && p.customImages.length) {
                var flyerEl2 = document.getElementById('flyer');
                p.customImages.forEach(function(imgData) {
                    if (!imgData.src) return;
                    var imgId   = 'img-' + Date.now() + '-' + Math.random().toString(36).slice(2,7);
                    var overlay = document.createElement('div');
                    overlay.className = 'custom-image-overlay';
                    overlay.id        = imgId;
                    overlay.style.backgroundImage = 'url(' + imgData.src + ')';
                    overlay.style.left    = (imgData.x     || 0)   + 'px';
                    overlay.style.top     = (imgData.y     || 0)   + 'px';
                    overlay.style.width   = (imgData.width || 200) + 'px';
                    overlay.style.height  = (imgData.width || 200) + 'px';
                    overlay.style.opacity = imgData.opacity != null ? imgData.opacity : 0.5;
                    flyerEl2.appendChild(overlay);
                    var rec = { id: imgId, el: overlay, x: imgData.x||0, y: imgData.y||0, width: imgData.width||200, opacity: imgData.opacity||0.5 };
                    customImages.push(rec);
                    // Re-attach drag handler
                    overlay.addEventListener('pointerdown', function(e) {
                        if (e.button !== 0) return;
                        e.preventDefault(); e.stopPropagation();
                        document.querySelectorAll('.custom-image-overlay').forEach(function(i){ i.classList.remove('selected'); });
                        overlay.classList.add('selected');
                        selectedImageId = imgId;
                        document.getElementById('selectedImageControls').style.display = 'block';
                        document.getElementById('imageSize').value = rec.width;
                        document.getElementById('imageSizeValue').textContent = rec.width + 'px';
                        document.getElementById('imageOpacity').value = Math.round(rec.opacity * 100);
                        document.getElementById('imageOpacityValue').textContent = Math.round(rec.opacity * 100) + '%';
                        isDragging = true;
                        currentDragImage = overlay;
                        var flyerRect = document.getElementById('flyer').getBoundingClientRect();
                        var elRect    = overlay.getBoundingClientRect();
                        offsetX = e.clientX - elRect.left;
                        offsetY = e.clientY - elRect.top;
                        overlay.classList.add('dragging');
                        overlay.setPointerCapture(e.pointerId);
                        overlay.addEventListener('pointermove', dragImage);
                        overlay.addEventListener('pointerup',   stopDrag);
                        overlay.addEventListener('pointercancel', stopDrag);
                    });
                });
            }

            // ‚îÄ‚îÄ STEP 11: Text overlays ‚îÄ‚îÄ
            textOverlays.forEach(function(t){ if(t.el) t.el.remove(); });
            textOverlays = [];
            selectedTextId = null;
            if (p.textOverlays && p.textOverlays.length) {
                p.textOverlays.forEach(function(td) {
                    document.getElementById('newTextInput').value  = td.text  || '';
                    document.getElementById('newTextSize').value   = td.size  || 32;
                    document.getElementById('newTextColor').value  = td.color || '#ffffff';
                    document.getElementById('newTextFont').value   = td.font  || 'inherit';
                    document.getElementById('newTextStyle').value  = td.style || 'normal';
                    document.getElementById('newTextSizeVal').textContent = (td.size || 32) + 'px';
                    addTextOverlay();
                    var tObj = textOverlays[textOverlays.length - 1];
                    if (tObj && tObj.el) {
                        tObj.el.style.left = (td.x || 0) + 'px';
                        tObj.el.style.top  = (td.y || 0) + 'px';
                    }
                });
                document.getElementById('newTextInput').value = '';
            }

            // ‚îÄ‚îÄ STEP 12: Final position enforcement after paint ‚îÄ‚îÄ
            // Re-apply title/date positions one more time after everything is rendered
            await new Promise(function(r){ requestAnimationFrame(function(){ requestAnimationFrame(r); }); });
            if (titleEl) {
                titleEl.style.left     = titlePos.x + 'px';
                titleEl.style.top      = titlePos.y + 'px';
                titleEl.style.right    = 'auto';
                titleEl.style.fontSize = titleSizePx + 'px';
            }
            if (dateBox) {
                dateBox.style.left  = datePos.x + 'px';
                dateBox.style.top   = datePos.y + 'px';
                dateBox.style.right = 'auto';
            }
            // Final card position enforcement
            document.querySelectorAll('.streamer-card').forEach(function(card) {
                var idx2 = parseInt(card.dataset.streamerIndex);
                var pos2 = streamerPositions[idx2];
                if (pos2 && pos2.manual) {
                    card.style.left = pos2.x + 'px';
                    card.style.top  = pos2.y + 'px';
                }
            });

            // ‚îÄ‚îÄ STEP 13: Avatar borders ‚îÄ‚îÄ
            if (p.avatarBorderEnabled !== undefined) {
                var abeEl = document.getElementById('avatarBorderEnabled');
                if (abeEl) abeEl.checked = p.avatarBorderEnabled;
            }
            if (p.avatarBorderColor !== undefined) {
                var abcEl = document.getElementById('avatarBorderColor');
                if (abcEl) abcEl.value = p.avatarBorderColor;
            }
            if (p.avatarBorderWidth !== undefined) {
                var abwEl = document.getElementById('avatarBorderWidth');
                if (abwEl) abwEl.value = p.avatarBorderWidth;
            }
            updateAvatarBorders();

            // ‚îÄ‚îÄ STEP 14: Featured streamer ‚îÄ‚îÄ
            if (p.featuredConfig) {
                featuredConfig = Object.assign(featuredConfig, p.featuredConfig);
                // Migrate old positional formats to selectedIds (stable DOM id-based)
                if (!featuredConfig.selectedIds) {
                    featuredConfig.selectedIds = [];
                    // Old format used indices (positional) - can't perfectly migrate, just clear
                }
                // Restore per-streamer overrides
                if (p.featuredOverrides) {
                    featuredOverrides = p.featuredOverrides;
                }
                var fc = p.featuredConfig;
                var feEl  = document.getElementById('featuredEnabled');
                var fncEl = document.getElementById('featuredNameColor');
                var ftcEl = document.getElementById('featuredTimeColor');
                var fnsEl = document.getElementById('featuredNameScale');
                var fasEl = document.getElementById('featuredAvatarScale');
                var fbsEl = document.getElementById('featuredBgStyle');
                var fbcEl = document.getElementById('featuredBgColor');
                var fboEl = document.getElementById('featuredBgOpacity');
                var flEl  = document.getElementById('featuredLabel');
                var flcEl = document.getElementById('featuredLabelColor');
                var fbrdEl= document.getElementById('featuredBorderColor');
                if (feEl)  feEl.checked  = fc.enabled;
                if (fncEl) fncEl.value   = fc.nameColor   || '#ffd700';
                if (ftcEl) ftcEl.value   = fc.timeColor   || '#ffffff';
                if (fnsEl) { fnsEl.value = fc.nameScale   || 1.4; document.getElementById('featuredNameSizeVal').textContent  = parseFloat(fnsEl.value).toFixed(1)+'√ó'; }
                if (fasEl) { fasEl.value = fc.avatarScale || 1.4; document.getElementById('featuredAvatarSizeVal').textContent = parseFloat(fasEl.value).toFixed(1)+'√ó'; }
                if (fbsEl) fbsEl.value   = fc.bgStyle     || 'gold-gradient';
                if (fbcEl) fbcEl.value   = fc.bgColor     || '#7c3aed';
                if (fboEl) { fboEl.value = fc.bgOpacity   || 70; document.getElementById('featuredBgOpVal').textContent = (fc.bgOpacity||70)+'%'; }
                if (flEl)  flEl.value    = fc.label       || '‚≠ê FEATURED';
                if (flcEl) flcEl.value   = fc.labelColor  || '#ffd700';
                if (fbrdEl)fbrdEl.value  = fc.borderColor || '#ffd700';
                document.getElementById('featuredCustomBgRow').style.display = fc.bgStyle === 'custom' ? '' : 'none';
                // Rebuild checklist with saved indices checked, then apply
                setTimeout(function() { refreshFeaturedDropdown(); applyFeaturedStreamer(); }, 50);
            }

            refreshTextList();
        }
        // ‚îÄ‚îÄ SAVE / LOAD PROJECT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

        async function downloadFlyer() {
            const flyer = document.getElementById('flyer');
            
            // Hide guides and selection borders during capture
            hideAllGuides();
            const guideContainer = document.getElementById('flyer-guides');
            if (guideContainer) guideContainer.style.display = 'none';
            const gridContainer = document.getElementById('flyer-grid');
            if (gridContainer) gridContainer.style.display = 'none';
            // Temporarily hide all selection borders
            const selectedImg = flyer.querySelector('.custom-image-overlay.selected');
            if (selectedImg) selectedImg.classList.remove('selected');
            const selectedCardEl = flyer.querySelector('.streamer-card.selected-card');
            if (selectedCardEl) selectedCardEl.classList.remove('selected-card');
            const selectedTextEl = flyer.querySelector('.text-overlay.selected-text');
            if (selectedTextEl) selectedTextEl.classList.remove('selected-text');
            flyer.querySelectorAll('.text-delete-btn').forEach(b => b.style.display = 'none');
            // Hide title/date/bg selection borders
            flyer.querySelectorAll('.selected-element').forEach(el => el.classList.remove('selected-element'));
            if (bgEl) bgEl.classList.remove('selected-bg');
            
            try {
                const canvas = await html2canvas(flyer, {
                    scale: 2,
                    backgroundColor: null,
                    logging: false,
                    useCORS: true,
                    allowTaint: true
                });
                
                const link = document.createElement('a');
                link.download = 'twitch-flyer.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
            } catch (error) {
                console.error('Error generating flyer:', error);
                alert('Error creating flyer. Please try again.');
            }
            
            // Restore selections
            if (guideContainer) guideContainer.style.display = '';
            if (gridContainer && gridVisible) gridContainer.style.display = 'block';
            if (selectedImg && selectedImageId) selectedImg.classList.add('selected');
            if (selectedCardEl) selectedCardEl.classList.add('selected-card');
            if (selectedTextEl && selectedTextId) selectedTextEl.classList.add('selected-text');
            flyer.querySelectorAll('.text-delete-btn').forEach(b => b.style.display = '');
        }

        // Deselect image when clicking flyer background
        // Add first streamer on load
        initTitleDateDrag();
        addStreamer();

        // ‚îÄ‚îÄ KEYBOARD SHORTCUTS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        document.addEventListener('keydown', function(e) {
            // Delete key
            if (e.key === 'Delete' && selectedCard) {
                var idx = parseInt(selectedCard.dataset.streamerIndex);
                var entries = document.querySelectorAll('.streamer-entry');
                if (entries[idx]) {
                    removeStreamer(entries[idx].id);
                }
            }
            // Arrow keys to nudge selected element
            if (selectedCard && (e.key.startsWith('Arrow'))) {
                e.preventDefault();
                var step = e.shiftKey ? 10 : 1;
                var left = parseInt(selectedCard.style.left) || 0;
                var top  = parseInt(selectedCard.style.top) || 0;
                if (e.key === 'ArrowLeft')  left -= step;
                if (e.key === 'ArrowRight') left += step;
                if (e.key === 'ArrowUp')    top -= step;
                if (e.key === 'ArrowDown')  top += step;
                selectedCard.style.left = left + 'px';
                selectedCard.style.top  = top + 'px';
                var idx = parseInt(selectedCard.dataset.streamerIndex);
                streamerPositions[idx] = {x: left, y: top, manual: true};
                refreshGridIfVisible();
            }
            // Also nudge selected text overlay
            if (selectedTextId && (e.key.startsWith('Arrow'))) {
                e.preventDefault();
                var textData = textOverlays.find(function(t){ return t.id === selectedTextId; });
                if (textData && textData.el) {
                    var step = e.shiftKey ? 10 : 1;
                    var left = parseInt(textData.el.style.left) || 0;
                    var top  = parseInt(textData.el.style.top) || 0;
                    if (e.key === 'ArrowLeft')  left -= step;
                    if (e.key === 'ArrowRight') left += step;
                    if (e.key === 'ArrowUp')    top -= step;
                    if (e.key === 'ArrowDown')  top += step;
                    textData.el.style.left = left + 'px';
                    textData.el.style.top  = top + 'px';
                    textData.x = left;
                    textData.y = top;
                    refreshGridIfVisible();
                }
            }
            // Nudge selected custom image
            if (selectedImageId && (e.key.startsWith('Arrow'))) {
                e.preventDefault();
                var imgData = customImages.find(function(im){ return im.id === selectedImageId; });
                if (imgData && imgData.el) {
                    var step = e.shiftKey ? 10 : 1;
                    var left = parseInt(imgData.el.style.left) || 0;
                    var top  = parseInt(imgData.el.style.top) || 0;
                    if (e.key === 'ArrowLeft')  left -= step;
                    if (e.key === 'ArrowRight') left += step;
                    if (e.key === 'ArrowUp')    top -= step;
                    if (e.key === 'ArrowDown')  top += step;
                    imgData.el.style.left = left + 'px';
                    imgData.el.style.top  = top + 'px';
                    imgData.x = left;
                    imgData.y = top;
                    refreshGridIfVisible();
                }
            }
        });

        // ‚îÄ‚îÄ SNAP TO GRID ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        var snapToGridEnabled = false;
        var SNAP_SIZE = 10;

        function toggleSnapToGrid() {
            snapToGridEnabled = !snapToGridEnabled;
            var btn = document.getElementById('btn-snap');
            if (snapToGridEnabled) {
                btn.style.background = '#9146ff';
                btn.style.color = '#fff';
            } else {
                btn.style.background = 'transparent';
                btn.style.color = '#9146ff';
            }
        }

        function snapValue(val) {
            if (!snapToGridEnabled) return val;
            return Math.round(val / SNAP_SIZE) * SNAP_SIZE;
        }

        // ‚îÄ‚îÄ AUTO-LAYOUT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function showAutoLayoutMenu() {
            var layouts = [
                {name:'Single Column (Left)', fn:layoutSingleColumn},
                {name:'Two Columns', fn:layoutTwoColumns},
                {name:'Grid (3√óN)', fn:layoutGrid},
                {name:'Horizontal Row', fn:layoutHorizontalRow},
                {name:'Circle', fn:layoutCircle}
            ];
            var menu = 'Choose layout:\n\n';
            layouts.forEach(function(l,i){ menu += (i+1) + '. ' + l.name + '\n'; });
            var choice = prompt(menu + '\nEnter 1-5:');
            var idx = parseInt(choice) - 1;
            if (idx >= 0 && idx < layouts.length) {
                layouts[idx].fn();
                updatePreview();
            }
        }

        function layoutSingleColumn() {
            var cards = document.querySelectorAll('.streamer-card');
            var startY = 200, spacing = 80, x = 30;
            cards.forEach(function(card, i) {
                var idx = parseInt(card.dataset.streamerIndex);
                var y = startY + i * spacing;
                streamerPositions[idx] = {x: snapValue(x), y: snapValue(y), manual: true};
            });
        }

        function layoutTwoColumns() {
            var cards = document.querySelectorAll('.streamer-card');
            var startY = 200, spacing = 80, x1 = 30, x2 = 320;
            cards.forEach(function(card, i) {
                var idx = parseInt(card.dataset.streamerIndex);
                var col = i % 2;
                var row = Math.floor(i / 2);
                var x = col === 0 ? x1 : x2;
                var y = startY + row * spacing;
                streamerPositions[idx] = {x: snapValue(x), y: snapValue(y), manual: true};
            });
        }

        function layoutGrid() {
            var cards = document.querySelectorAll('.streamer-card');
            var cols = 3, startX = 20, startY = 200, spacingX = 180, spacingY = 80;
            cards.forEach(function(card, i) {
                var idx = parseInt(card.dataset.streamerIndex);
                var col = i % cols;
                var row = Math.floor(i / cols);
                var x = startX + col * spacingX;
                var y = startY + row * spacingY;
                streamerPositions[idx] = {x: snapValue(x), y: snapValue(y), manual: true};
            });
        }

        function layoutHorizontalRow() {
            var cards = document.querySelectorAll('.streamer-card');
            var startX = 20, y = 300, spacing = 120;
            cards.forEach(function(card, i) {
                var idx = parseInt(card.dataset.streamerIndex);
                var x = startX + i * spacing;
                streamerPositions[idx] = {x: snapValue(x), y: snapValue(y), manual: true};
            });
        }

        function layoutCircle() {
            var cards = document.querySelectorAll('.streamer-card');
            var flyerW = currentOrientation === 'landscape' ? 800 : 600;
            var flyerH = currentOrientation === 'landscape' ? 600 : 800;
            var centerX = flyerW / 2, centerY = flyerH / 2, radius = 200;
            cards.forEach(function(card, i) {
                var idx = parseInt(card.dataset.streamerIndex);
                var angle = (i / cards.length) * 2 * Math.PI - Math.PI/2;
                var x = centerX + radius * Math.cos(angle) - 100;
                var y = centerY + radius * Math.sin(angle) - 30;
                streamerPositions[idx] = {x: snapValue(x), y: snapValue(y), manual: true};
            });
        }

        // ‚îÄ‚îÄ BULK IMPORT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function bulkImportStreamers() {
            var text = document.getElementById('bulkImportText').value.trim();
            if (!text) return alert('Please paste usernames (one per line)');
            var lines = text.split('\n').map(function(l){ return l.trim(); }).filter(Boolean);
            if (lines.length === 0) return alert('No usernames found');
            if (streamers.length + lines.length > 50) {
                return alert('Cannot exceed 50 streamers. You have ' + streamers.length + ' and are trying to add ' + lines.length);
            }
            lines.forEach(function(username) {
                addStreamer();
                var entries = document.querySelectorAll('.streamer-entry');
                var entry = entries[entries.length - 1];
                if (entry) {
                    var uEl = entry.querySelector('.streamer-username');
                    if (uEl) {
                        uEl.value = username;
                        fetchTwitchProfile(uEl, entry.id);
                    }
                }
            });
            document.getElementById('bulkImportText').value = '';
            alert('Added ' + lines.length + ' streamers! Fetching profiles...');
        }

        // ‚îÄ‚îÄ GRADIENT TEXT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function toggleTitleGradient() {
            var enabled = document.getElementById('titleGradient').checked;
            var color2  = document.getElementById('titleColor2');
            color2.disabled = !enabled;
            color2.style.opacity = enabled ? '1' : '0.5';
            applyTitleStyle();
        }

        function toggleDateGradient() {
            var enabled = document.getElementById('dateGradient').checked;
            var color2  = document.getElementById('dateColor2');
            color2.disabled = !enabled;
            color2.style.opacity = enabled ? '1' : '0.5';
            applyDateStyle();
        }

        // Override applyTitleStyle to handle gradients
        var originalApplyTitleStyle = applyTitleStyle;
        applyTitleStyle = function() {
            originalApplyTitleStyle();
            var titleEl = document.getElementById('preview-title');
            if (!titleEl) return;
            var gradientEnabled = document.getElementById('titleGradient') && document.getElementById('titleGradient').checked;
            if (gradientEnabled) {
                var c1 = document.getElementById('titleColor').value;
                var c2 = document.getElementById('titleColor2').value;
                titleEl.style.background = 'linear-gradient(135deg, ' + c1 + ', ' + c2 + ')';
                titleEl.style.webkitBackgroundClip = 'text';
                titleEl.style.webkitTextFillColor = 'transparent';
                titleEl.style.backgroundClip = 'text';
            } else {
                titleEl.style.background = '';
                titleEl.style.webkitBackgroundClip = '';
                titleEl.style.webkitTextFillColor = '';
                titleEl.style.backgroundClip = '';
            }
        };

        var originalApplyDateStyle = applyDateStyle;
        applyDateStyle = function() {
            originalApplyDateStyle();
            var dateEl = document.getElementById('preview-date');
            if (!dateEl) return;
            var gradientEnabled = document.getElementById('dateGradient') && document.getElementById('dateGradient').checked;
            if (gradientEnabled) {
                var c1 = document.getElementById('dateTextColor').value;
                var c2 = document.getElementById('dateColor2').value;
                dateEl.style.background = 'linear-gradient(135deg, ' + c1 + ', ' + c2 + ')';
                dateEl.style.webkitBackgroundClip = 'text';
                dateEl.style.webkitTextFillColor = 'transparent';
                dateEl.style.backgroundClip = 'text';
            } else {
                dateEl.style.background = '';
                dateEl.style.webkitBackgroundClip = '';
                dateEl.style.webkitTextFillColor = '';
                dateEl.style.backgroundClip = '';
            }
        };

        // ‚îÄ‚îÄ TIMEZONE CONVERSION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // Override formatTime to handle timezone conversion
        var originalFormatTime = formatTime;
        formatTime = function(time) {
            if (!time) return 'Time TBD';
            var tz = document.getElementById('timezoneSelect') ? document.getElementById('timezoneSelect').value : '';
            if (!tz) return originalFormatTime(time);
            
            try {
                // Parse time as local time on today's date
                var today = new Date();
                var [hours, minutes] = time.split(':');
                var localDate = new Date(today.getFullYear(), today.getMonth(), today.getDate(), parseInt(hours), parseInt(minutes));
                
                // Convert to target timezone
                var options = { 
                    hour: 'numeric', 
                    minute: '2-digit', 
                    timeZone: tz,
                    hour12: true 
                };
                var formatted = localDate.toLocaleString('en-US', options);
                
                // Add timezone abbreviation
                var tzAbbr = tz === 'UTC' ? 'UTC' : 
                             tz.includes('New_York') ? 'ET' :
                             tz.includes('Chicago') ? 'CT' :
                             tz.includes('Denver') ? 'MT' :
                             tz.includes('Los_Angeles') ? 'PT' :
                             tz.includes('London') ? 'GMT' :
                             tz.includes('Paris') ? 'CET' :
                             tz.includes('Tokyo') ? 'JST' :
                             tz.includes('Sydney') ? 'AEST' : '';
                return formatted + (tzAbbr ? ' ' + tzAbbr : '');
            } catch(e) {
                return originalFormatTime(time);
            }
        };
    </script>
</body>
</html>
